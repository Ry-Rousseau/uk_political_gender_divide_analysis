gap_type == "social_gap" ~ "Social Conservatism Gap",
gap_type == "economic_gap" ~ "Economic Leftism Gap"
)
)
# Create bar chart
library(ggplot2)
ggplot(london_vs_rest, aes(x = age, y = gap_value, fill = location)) +
geom_col(position = "dodge", alpha = 0.8) +
facet_wrap(~gap_type, scales = "free_y") +
labs(
title = "Gender Gaps by Age Group: London vs Rest of UK",
subtitle = "Positive values = men more conservative/left-leaning than women",
x = "Age Group",
y = "Gender Gap (Male - Female)",
fill = "Location"
) +
theme_minimal() +
theme(axis.text.x = element_text(angle = 45, hjust = 1)) +
scale_fill_manual(values = c("London" = "#2E86AB", "Rest of UK" = "#A23B72"))
# Gender gap analysis by region and age group
gender_gap_by_region_age <- uk_data %>%
filter(!is.na(social_conservatism), !is.na(economic_leftism), !is.na(gender), !is.na(region), !is.na(age)) %>%
group_by(region, age, gender) %>%
summarise(
avg_social = mean(social_conservatism, na.rm = TRUE),
avg_economic = mean(economic_leftism, na.rm = TRUE),
n = n(),
.groups = "drop"
) %>%
pivot_wider(names_from = gender, values_from = c(avg_social, avg_economic, n), names_sep = "_") %>%
filter(!is.na(avg_social_male), !is.na(avg_social_female),
!is.na(avg_economic_male), !is.na(avg_economic_female)) %>%
mutate(
social_gap = avg_social_male - avg_social_female,
economic_gap = avg_economic_male - avg_economic_female
) %>%
select(region, age, social_gap, economic_gap, n_male, n_female) %>%
arrange(region, age)
print("Gender gaps by region and age group (male - female):")
print(gender_gap_by_region_age)
# Create London vs Rest of UK comparison for bar chart
london_vs_rest <- gender_gap_by_region_age %>%
mutate(
location = ifelse(region == "London", "London", "Rest of UK")
) %>%
group_by(location, age) %>%
summarise(
social_gap = weighted.mean(social_gap, n_male + n_female, na.rm = TRUE),
economic_gap = weighted.mean(economic_gap, n_male + n_female, na.rm = TRUE),
total_n = sum(n_male + n_female, na.rm = TRUE),
.groups = "drop"
) %>%
pivot_longer(cols = c(social_gap, economic_gap),
names_to = "gap_type",
values_to = "gap_value") %>%
mutate(
gap_type = case_when(
gap_type == "social_gap" ~ "Social Conservatism Gap",
gap_type == "economic_gap" ~ "Economic Leftism Gap"
)
)
# Create line plot to show trends more clearly
library(ggplot2)
ggplot(london_vs_rest, aes(x = age, y = gap_value, color = location, group = location)) +
geom_line(size = 1.2) +
geom_point(size = 3) +
geom_hline(yintercept = 0, linetype = "dashed", alpha = 0.5) +
facet_wrap(~gap_type, scales = "free_y") +
labs(
title = "Gender Ideological Gaps: London vs Rest of UK",
subtitle = "How gender divides vary by age and location",
x = "Age Group",
y = "Gender Gap (Male - Female)",
color = "Location",
caption = "Positive = men more conservative/economically left than women"
) +
theme_minimal() +
theme(
axis.text.x = element_text(angle = 45, hjust = 1),
plot.title = element_text(size = 14, face = "bold"),
strip.text = element_text(size = 12, face = "bold")
) +
scale_color_manual(values = c("London" = "#E74C3C", "Rest of UK" = "#3498DB"))
# Gender gap analysis by region and age group
gender_gap_by_region_age <- uk_data %>%
filter(!is.na(social_conservatism), !is.na(economic_leftism), !is.na(gender), !is.na(region), !is.na(age)) %>%
group_by(region, age, gender) %>%
summarise(
avg_social = mean(social_conservatism, na.rm = TRUE),
avg_economic = mean(economic_leftism, na.rm = TRUE),
n = n(),
.groups = "drop"
) %>%
pivot_wider(names_from = gender, values_from = c(avg_social, avg_economic, n), names_sep = "_") %>%
filter(!is.na(avg_social_male), !is.na(avg_social_female),
!is.na(avg_economic_male), !is.na(avg_economic_female)) %>%
mutate(
social_gap = avg_social_male - avg_social_female,
economic_gap = avg_economic_male - avg_economic_female
) %>%
select(region, age, social_gap, economic_gap, n_male, n_female) %>%
arrange(region, age)
print("Gender gaps by region and age group (male - female):")
print(gender_gap_by_region_age)
# Create London vs Rest of UK comparison
london_vs_rest <- gender_gap_by_region_age %>%
mutate(
location = ifelse(region == "Greater London", "London", "Rest of UK")
) %>%
group_by(location, age) %>%
summarise(
social_gap = weighted.mean(social_gap, n_male + n_female, na.rm = TRUE),
economic_gap = weighted.mean(economic_gap, n_male + n_female, na.rm = TRUE),
total_n = sum(n_male + n_female, na.rm = TRUE),
.groups = "drop"
) %>%
pivot_longer(cols = c(social_gap, economic_gap),
names_to = "gap_type",
values_to = "gap_value") %>%
mutate(
gap_type = case_when(
gap_type == "social_gap" ~ "Social Conservatism Gap",
gap_type == "economic_gap" ~ "Economic Leftism Gap"
)
)
# Create line plot to show trends more clearly
library(ggplot2)
ggplot(london_vs_rest, aes(x = age, y = gap_value, color = location, group = location)) +
geom_line(size = 1.2) +
geom_point(size = 3) +
geom_hline(yintercept = 0, linetype = "dashed", alpha = 0.5) +
facet_wrap(~gap_type, scales = "free_y") +
labs(
title = "Gender Ideological Gaps: London vs Rest of UK",
subtitle = "How gender divides vary by age and location",
x = "Age Group",
y = "Gender Gap (Male - Female)",
color = "Location",
caption = "Positive = men more conservative/economically left than women"
) +
theme_minimal() +
theme(
axis.text.x = element_text(angle = 45, hjust = 1),
plot.title = element_text(size = 14, face = "bold"),
strip.text = element_text(size = 12, face = "bold")
) +
scale_color_manual(values = c("London" = "#E74C3C", "Rest of UK" = "#3498DB"))
# Create survey design object
# Note that we could add stratification to this stage, such as though religion or age. We don't know the stratification scheme.
survey_design_full <- svydesign(
ids = ~1,  # No clustering in this dataset, assumes simple random sampling
weights = ~wt,
data = uk_data
)
# Model social conservatism with full demographic controls
model_social <- svyglm(
social_conservatism ~ gender * age + education + ethnicity + region +
household + socgrad + marital + religion,
design = survey_design_full,
family = gaussian()
)
# Display model summary
summary(model_social)
# Extract key coefficients for interpretation
social_coefs <- summary(model_social)$coefficients
# Model fit statistics
cat("\nModel Fit Statistics:\n")
cat("Degrees of Freedom:", model_social$df.residual, "\n")
cat("Deviance:", round(model_social$deviance, 3), "\n")
##  Check further diagnostics if wanted
#plot(model_social)
##  VIF Multicollinearity
library(car)
car::vif(model_social, type = 'terms')  # Check for multicollinearity
# Number of observations
nobs(model_social)  # Number of observations
unique(uk_data$education)
# Gender gap analysis by education and age group
gender_gap_by_education_age <- uk_data %>%
filter(!is.na(social_conservatism), !is.na(economic_leftism), !is.na(gender), !is.na(education), !is.na(age)) %>%
group_by(education, age, gender) %>%
summarise(
avg_social = mean(social_conservatism, na.rm = TRUE),
avg_economic = mean(economic_leftism, na.rm = TRUE),
n = n(),
.groups = "drop"
) %>%
pivot_wider(names_from = gender, values_from = c(avg_social, avg_economic, n), names_sep = "_") %>%
filter(!is.na(avg_social_male), !is.na(avg_social_female),
!is.na(avg_economic_male), !is.na(avg_economic_female)) %>%
mutate(
social_gap = avg_social_male - avg_social_female,
economic_gap = avg_economic_male - avg_economic_female
) %>%
select(education, age, social_gap, economic_gap, n_male, n_female) %>%
arrange(education, age)
print("Gender gaps by education and age group (male - female):")
print(gender_gap_by_education_age)
# Create education comparison for visualization
education_comparison <- gender_gap_by_education_age %>%
pivot_longer(cols = c(social_gap, economic_gap),
names_to = "gap_type",
values_to = "gap_value") %>%
mutate(
gap_type = case_when(
gap_type == "social_gap" ~ "Social Conservatism Gap",
gap_type == "economic_gap" ~ "Economic Leftism Gap"
)
)
# Create line plot for education gaps
ggplot(education_comparison, aes(x = age, y = gap_value, color = education, group = education)) +
geom_line(size = 1.2) +
geom_point(size = 3) +
geom_hline(yintercept = 0, linetype = "dashed", alpha = 0.5) +
facet_wrap(~gap_type, scales = "free_y") +
labs(
title = "Gender Ideological Gaps by Education Level",
subtitle = "How gender divides vary by age and education",
x = "Age Group",
y = "Gender Gap (Male - Female)",
color = "Education",
caption = "Positive = men more conservative/economically left than women"
) +
theme_minimal() +
theme(
axis.text.x = element_text(angle = 45, hjust = 1),
plot.title = element_text(size = 14, face = "bold"),
strip.text = element_text(size = 12, face = "bold")
) +
scale_color_manual(values = c("Higher education" = "#27AE60", "Lower education" = "#F39C12"))
# Gender gap analysis by education and age group
gender_gap_by_education_age <- uk_data %>%
filter(!is.na(social_conservatism), !is.na(economic_leftism), !is.na(gender), !is.na(education), !is.na(age)) %>%
group_by(education, age, gender) %>%
summarise(
avg_social = mean(social_conservatism, na.rm = TRUE),
avg_economic = mean(economic_leftism, na.rm = TRUE),
n = n(),
.groups = "drop"
) %>%
pivot_wider(names_from = gender, values_from = c(avg_social, avg_economic, n), names_sep = "_") %>%
filter(!is.na(avg_social_male), !is.na(avg_social_female),
!is.na(avg_economic_male), !is.na(avg_economic_female)) %>%
mutate(
social_gap = avg_social_male - avg_social_female,
economic_gap = avg_economic_male - avg_economic_female
) %>%
select(education, age, social_gap, economic_gap, n_male, n_female) %>%
arrange(education, age)
print("Gender gaps by education and age group (male - female):")
print(gender_gap_by_education_age)
# Check education levels
cat("Available education levels:\n")
print(unique(gender_gap_by_education_age$education))
# Create education comparison for visualization
education_comparison <- gender_gap_by_education_age %>%
pivot_longer(cols = c(social_gap, economic_gap),
names_to = "gap_type",
values_to = "gap_value") %>%
mutate(
gap_type = case_when(
gap_type == "social_gap" ~ "Social Conservatism Gap",
gap_type == "economic_gap" ~ "Economic Leftism Gap"
)
)
# Create line plot for education gaps
ggplot(education_comparison, aes(x = age, y = gap_value, color = education, group = education)) +
geom_line(size = 1.2) +
geom_point(size = 3) +
geom_hline(yintercept = 0, linetype = "dashed", alpha = 0.5) +
facet_wrap(~gap_type, scales = "free_y") +
labs(
title = "Gender Ideological Gaps by Education Level",
subtitle = "How gender divides vary by age and education",
x = "Age Group",
y = "Gender Gap (Male - Female)",
color = "Education",
caption = "Positive = men more conservative/economically left than women"
) +
theme_minimal() +
theme(
axis.text.x = element_text(angle = 45, hjust = 1),
plot.title = element_text(size = 14, face = "bold"),
strip.text = element_text(size = 12, face = "bold")
) +
scale_color_brewer(type = "qual", palette = "Set1")
# Gender gap analysis by education and age group (using weighted means)
gender_gap_by_education_age <- uk_data %>%
filter(!is.na(social_conservatism), !is.na(economic_leftism), !is.na(gender), !is.na(education), !is.na(age), !is.na(wt)) %>%
group_by(education, age, gender) %>%
summarise(
avg_social = weighted.mean(social_conservatism, wt, na.rm = TRUE),
avg_economic = weighted.mean(economic_leftism, wt, na.rm = TRUE),
n = n(),
.groups = "drop"
) %>%
pivot_wider(names_from = gender, values_from = c(avg_social, avg_economic, n), names_sep = "_") %>%
filter(!is.na(avg_social_male), !is.na(avg_social_female),
!is.na(avg_economic_male), !is.na(avg_economic_female)) %>%
mutate(
social_gap = avg_social_male - avg_social_female,
economic_gap = avg_economic_male - avg_economic_female
) %>%
select(education, age, social_gap, economic_gap, n_male, n_female) %>%
arrange(education, age)
print("Gender gaps by education and age group (male - female):")
print(gender_gap_by_education_age)
# Check education levels
cat("Available education levels:\n")
print(unique(gender_gap_by_education_age$education))
# Create education comparison for visualization
education_comparison <- gender_gap_by_education_age %>%
pivot_longer(cols = c(social_gap, economic_gap),
names_to = "gap_type",
values_to = "gap_value") %>%
mutate(
gap_type = case_when(
gap_type == "social_gap" ~ "Social Conservatism Gap",
gap_type == "economic_gap" ~ "Economic Leftism Gap"
)
)
# Create line plot for education gaps
ggplot(education_comparison, aes(x = age, y = gap_value, color = education, group = education)) +
geom_line(size = 1.2) +
geom_point(size = 3) +
geom_hline(yintercept = 0, linetype = "dashed", alpha = 0.5) +
facet_wrap(~gap_type, scales = "free_y") +
labs(
title = "Gender Ideological Gaps by Education Level",
subtitle = "How gender divides vary by age and education",
x = "Age Group",
y = "Gender Gap (Male - Female)",
color = "Education",
caption = "Positive = men more conservative/economically left than women"
) +
theme_minimal() +
theme(
axis.text.x = element_text(angle = 45, hjust = 1),
plot.title = element_text(size = 14, face = "bold"),
strip.text = element_text(size = 12, face = "bold")
) +
scale_color_brewer(type = "qual", palette = "Set1")
unique(uk_data$socgrad)
# Gender gap analysis by social grade and age group (using weighted means)
gender_gap_by_socgrad_age <- uk_data %>%
filter(!is.na(social_conservatism), !is.na(economic_leftism), !is.na(gender), !is.na(socgrad), !is.na(age), !is.na(wt)) %>%
group_by(socgrad, age, gender) %>%
summarise(
avg_social = weighted.mean(social_conservatism, wt, na.rm = TRUE),
avg_economic = weighted.mean(economic_leftism, wt, na.rm = TRUE),
n = n(),
.groups = "drop"
) %>%
pivot_wider(names_from = gender, values_from = c(avg_social, avg_economic, n), names_sep = "_") %>%
filter(!is.na(avg_social_male), !is.na(avg_social_female),
!is.na(avg_economic_male), !is.na(avg_economic_female)) %>%
mutate(
social_gap = avg_social_male - avg_social_female,
economic_gap = avg_economic_male - avg_economic_female
) %>%
select(socgrad, age, social_gap, economic_gap, n_male, n_female) %>%
arrange(socgrad, age)
print("Gender gaps by social grade and age group (male - female):")
print(gender_gap_by_socgrad_age)
# Check social grade levels
cat("Available social grade levels:\n")
print(unique(gender_gap_by_socgrad_age$socgrad))
# Create social grade comparison for visualization
socgrad_comparison <- gender_gap_by_socgrad_age %>%
pivot_longer(cols = c(social_gap, economic_gap),
names_to = "gap_type",
values_to = "gap_value") %>%
mutate(
gap_type = case_when(
gap_type == "social_gap" ~ "Social Conservatism Gap",
gap_type == "economic_gap" ~ "Economic Leftism Gap"
)
)
# Create line plot for social grade gaps
ggplot(socgrad_comparison, aes(x = age, y = gap_value, color = socgrad, group = socgrad)) +
geom_line(size = 1.2) +
geom_point(size = 3) +
geom_hline(yintercept = 0, linetype = "dashed", alpha = 0.5) +
facet_wrap(~gap_type, scales = "free_y") +
labs(
title = "Gender Ideological Gaps by Social Grade",
subtitle = "How gender divides vary by age and social class (AB=highest, DE=lowest)",
x = "Age Group",
y = "Gender Gap (Male - Female)",
color = "Social Grade",
caption = "Positive = men more conservative/economically left than women"
) +
theme_minimal() +
theme(
axis.text.x = element_text(angle = 45, hjust = 1),
plot.title = element_text(size = 14, face = "bold"),
strip.text = element_text(size = 12, face = "bold")
) +
scale_color_manual(values = c("AB" = "#8E44AD", "C1" = "#3498DB", "C2" = "#E67E22", "DE" = "#E74C3C"))
# Gender gap analysis by ethnicity and age group (using weighted means)
gender_gap_by_ethnicity_age <- uk_data %>%
filter(!is.na(social_conservatism), !is.na(economic_leftism), !is.na(gender), !is.na(ethnicity), !is.na(age), !is.na(wt)) %>%
group_by(ethnicity, age, gender) %>%
summarise(
avg_social = weighted.mean(social_conservatism, wt, na.rm = TRUE),
avg_economic = weighted.mean(economic_leftism, wt, na.rm = TRUE),
n = n(),
.groups = "drop"
) %>%
pivot_wider(names_from = gender, values_from = c(avg_social, avg_economic, n), names_sep = "_") %>%
filter(!is.na(avg_social_male), !is.na(avg_social_female),
!is.na(avg_economic_male), !is.na(avg_economic_female)) %>%
mutate(
social_gap = avg_social_male - avg_social_female,
economic_gap = avg_economic_male - avg_economic_female
) %>%
select(ethnicity, age, social_gap, economic_gap, n_male, n_female) %>%
arrange(ethnicity, age)
print("Gender gaps by ethnicity and age group (male - female):")
print(gender_gap_by_ethnicity_age)
# Check ethnicity levels
cat("Available ethnicity levels:\n")
print(unique(gender_gap_by_ethnicity_age$ethnicity))
# Create ethnicity comparison for visualization
ethnicity_comparison <- gender_gap_by_ethnicity_age %>%
pivot_longer(cols = c(social_gap, economic_gap),
names_to = "gap_type",
values_to = "gap_value") %>%
mutate(
gap_type = case_when(
gap_type == "social_gap" ~ "Social Conservatism Gap",
gap_type == "economic_gap" ~ "Economic Leftism Gap"
)
)
# Create line plot for ethnicity gaps
ggplot(ethnicity_comparison, aes(x = age, y = gap_value, color = ethnicity, group = ethnicity)) +
geom_line(size = 1.2) +
geom_point(size = 3) +
geom_hline(yintercept = 0, linetype = "dashed", alpha = 0.5) +
facet_wrap(~gap_type, scales = "free_y") +
labs(
title = "Gender Ideological Gaps by Ethnicity",
subtitle = "How gender divides vary by age and ethnic background",
x = "Age Group",
y = "Gender Gap (Male - Female)",
color = "Ethnicity",
caption = "Positive = men more conservative/economically left than women"
) +
theme_minimal() +
theme(
axis.text.x = element_text(angle = 45, hjust = 1),
plot.title = element_text(size = 14, face = "bold"),
strip.text = element_text(size = 12, face = "bold")
) +
scale_color_manual(values = c("white" = "#2C3E50", "asian" = "#E74C3C", "black" = "#F39C12", "mixed" = "#9B59B6", "other" = "#1ABC9C"))
# Gender gap analysis by religion and age group (using weighted means)
gender_gap_by_religion_age <- uk_data %>%
filter(!is.na(social_conservatism), !is.na(economic_leftism), !is.na(gender), !is.na(religion), !is.na(age), !is.na(wt)) %>%
group_by(religion, age, gender) %>%
summarise(
avg_social = weighted.mean(social_conservatism, wt, na.rm = TRUE),
avg_economic = weighted.mean(economic_leftism, wt, na.rm = TRUE),
n = n(),
.groups = "drop"
) %>%
pivot_wider(names_from = gender, values_from = c(avg_social, avg_economic, n), names_sep = "_") %>%
filter(!is.na(avg_social_male), !is.na(avg_social_female),
!is.na(avg_economic_male), !is.na(avg_economic_female)) %>%
mutate(
social_gap = avg_social_male - avg_social_female,
economic_gap = avg_economic_male - avg_economic_female
) %>%
select(religion, age, social_gap, economic_gap, n_male, n_female) %>%
arrange(religion, age)
print("Gender gaps by religion and age group (male - female):")
print(gender_gap_by_religion_age)
# Check religion levels
cat("Available religion levels:\n")
print(unique(gender_gap_by_religion_age$religion))
# Create religion comparison for visualization
religion_comparison <- gender_gap_by_religion_age %>%
pivot_longer(cols = c(social_gap, economic_gap),
names_to = "gap_type",
values_to = "gap_value") %>%
mutate(
gap_type = case_when(
gap_type == "social_gap" ~ "Social Conservatism Gap",
gap_type == "economic_gap" ~ "Economic Leftism Gap"
)
)
# Create line plot for religion gaps
ggplot(religion_comparison, aes(x = age, y = gap_value, color = religion, group = religion)) +
geom_line(size = 1.2) +
geom_point(size = 3) +
geom_hline(yintercept = 0, linetype = "dashed", alpha = 0.5) +
facet_wrap(~gap_type, scales = "free_y") +
labs(
title = "Gender Ideological Gaps by Religion",
subtitle = "How gender divides vary by age and religious affiliation",
x = "Age Group",
y = "Gender Gap (Male - Female)",
color = "Religion",
caption = "Positive = men more conservative/economically left than women"
) +
theme_minimal() +
theme(
axis.text.x = element_text(angle = 45, hjust = 1),
plot.title = element_text(size = 14, face = "bold"),
strip.text = element_text(size = 12, face = "bold")
) +
scale_color_manual(values = c("christian" = "#8E44AD", "none" = "#34495E", "muslim" = "#E74C3C", "hindu" = "#F39C12", "other" = "#27AE60", "no_answer" = "#95A5A6"))
source('scripts/setup_full.R')

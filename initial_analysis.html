<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.6.42">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>UK Political Gender Divide Survey Analysis</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="initial_analysis_files/libs/clipboard/clipboard.min.js"></script>
<script src="initial_analysis_files/libs/quarto-html/quarto.js"></script>
<script src="initial_analysis_files/libs/quarto-html/popper.min.js"></script>
<script src="initial_analysis_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="initial_analysis_files/libs/quarto-html/anchor.min.js"></script>
<link href="initial_analysis_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="initial_analysis_files/libs/quarto-html/quarto-syntax-highlighting-2f5df379a58b258e96c21c0638c20c03.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="initial_analysis_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="initial_analysis_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="initial_analysis_files/libs/bootstrap/bootstrap-1bc8a17f135ab3d594c857e9f48e611b.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">


</head>

<body class="fullcontent">

<div id="quarto-content" class="page-columns page-rows-contents page-layout-article">

<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">UK Political Gender Divide Survey Analysis</h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<section id="research-questions" class="level4">
<h4 class="anchored" data-anchor-id="research-questions">Research questions:</h4>
<p>what evidence of this ideological gender divide exists in the UK and is it different across generations?</p>
<p>young peopleʼs attitudes and if we can challenge the idea theyʼre a monolith</p>
<p>how do the above translate into public-facing guidance for the FTSE CEO?</p>
<p>what is the divide? do economic or social views drive the divide that we’re experiencing? can this be drilled down into specific areas of either?</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">source</span>(<span class="st">'scripts/setup.R'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Loading UK Election Study data...
Data loaded successfully!
Dataset dimensions: 32621 rows x 27 columns

Data overview:
Rows: 32,621
Columns: 27
$ respondent_id &lt;chr&gt; "fd0000516392", "fd0000644501", "fd0001323582", "fd00014…
$ wt            &lt;dbl&gt; 1.0414001, 1.0650522, 1.0794774, 1.1965344, 1.9464518, 0…
$ age           &lt;chr&gt; "25_TO_34", "18_TO_24", "25_TO_34", "55_TO_64", "25_TO_3…
$ gender        &lt;chr&gt; "male", "male", "male", "male", "female", "female", "mal…
$ education     &lt;chr&gt; "low", "low", "low", "low", "high", "high", "high", "low…
$ ethnicity     &lt;chr&gt; "white", "white", "white", "white", "other", "white", "w…
$ region        &lt;chr&gt; "East of England", "South West England", "South West Eng…
$ cons_code     &lt;chr&gt; "E14001359", "E14001495", "E14001429", "E14001500", "E14…
$ cons_name     &lt;chr&gt; "Bedfordshire Mid", "Devon South West", "Poole", "Southa…
$ household     &lt;chr&gt; "owns_with_mortgage_or_shared", "owns_with_mortgage_or_s…
$ religion      &lt;chr&gt; "none", "none", "none", "none", "none", "none", "christi…
$ socgrad       &lt;chr&gt; "C2", "AB", "C2", "AB", "DE", "AB", "AB", "DE", "C1", "D…
$ marital       &lt;chr&gt; "relationship_notliving", "single", "relationship_living…
$ pv_2019       &lt;chr&gt; "dnv", "ldm", "con", "brx", "dnv", "dnv", "snp", "lab", …
$ pv_2024       &lt;chr&gt; "rfm", "rfm", "lab", "con", "lab", "lab", "lab", "grn", …
$ eu_ref        &lt;chr&gt; "leave", "dnv", "leave", "leave", "dnv", "remain", "rema…
$ exact_age     &lt;dbl&gt; 26, 22, 26, 61, 30, 30, 41, 44, 66, 73, 21, 80, 65, 77, …
$ econ_redist   &lt;chr&gt; "Neither agree nor disagree", "Strongly agree", "Disagre…
$ econ_bigbiz   &lt;chr&gt; "Neither agree nor disagree", "Strongly agree", "Agree",…
$ econ_unfair   &lt;chr&gt; "Agree", "Strongly agree", "Agree", "Agree", "Disagree",…
$ econ_onelaw   &lt;chr&gt; "Agree", "Agree", "Agree", "Strongly agree", "Agree", "S…
$ econ_exploit  &lt;chr&gt; "Strongly agree", "Strongly agree", "Agree", "Agree", "A…
$ soc_respect   &lt;chr&gt; "Agree", "Strongly agree", "Neither agree nor disagree",…
$ soc_deathpen  &lt;chr&gt; "Strongly agree", "Strongly agree", "Neither agree nor d…
$ soc_schools   &lt;chr&gt; "Neither agree nor disagree", "Strongly agree", "Agree",…
$ soc_censor    &lt;chr&gt; "Strongly disagree", "Strongly agree", "Disagree", "Disa…
$ soc_punish    &lt;chr&gt; "Agree", "Strongly agree", "Agree", "Agree", "Strongly a…</code></pre>
</div>
</div>
</section>
<section id="analysis-plan" class="level4">
<h4 class="anchored" data-anchor-id="analysis-plan">Analysis plan</h4>
<ol type="1">
<li><p>Verify data integrity, create composite social/economic scales</p></li>
<li><p>Generate average scorings based on age-group, calculate differences by individual to age-group scores - how do individual differ from their age cohort?</p></li>
<li><p>Quantify the size of gender differences in liberal/authoritarian attitudes across age groups:</p></li>
</ol>
<ul>
<li>did the 2024 vote exhibit the gender gap? (age/vote distribution by party vote 2024)</li>
<li>is the gap wider amongst younger generations vs.&nbsp;other? (gap size by age band)</li>
<li>specific issue gaps?</li>
</ul>
<ol start="4" type="1">
<li>Modelling stage - how does age, gender, other demographics predict ideology?</li>
</ol>
<ul>
<li>how can we predict party vote, conservatism, economic leftism using the demographic information that we have (weighted regression)?</li>
</ul>
<ol start="5" type="1">
<li><p>Segmented modelling - how do young people experience different effects to those of all voters?</p></li>
<li><p>Visualization creation, draw out most relevant insights from the above stages</p></li>
<li><p>Extended segment analysis</p></li>
</ol>
<ul>
<li>What specific ideological markers are significant for corporate positioning strategy? What specific dimension is driving the growing gender divide for the future?</li>
<li>is this happening mostly in urban areas? can we merge in additional data via use of constituency codes?</li>
</ul>
<ol start="8" type="1">
<li>Based on above results, incorporate into a unified tracking function in new document</li>
</ol>
<ul>
<li>Test this function using survey waves from randomly selected batches from the main data, label for multiple months as proof of concept working.</li>
</ul>
</section>
<section id="how-do-we-measure-political-ideology" class="level3">
<h3 class="anchored" data-anchor-id="how-do-we-measure-political-ideology">How do we measure political ideology?</h3>
<ol type="1">
<li><p>social preferences - conservatism variable</p></li>
<li><p>economic preferences - economic leftism variable</p></li>
<li><p>2024 party vote - between reform, labour, greens, conservatives, etc.</p></li>
<li><p>Tailored topic viewpoints - big business, traditional values, death penalty etc.</p></li>
</ol>
<!-- First stage analysis (basically, where do things stand now?, what is the state of the gender gap across generations from the information that we have now?): -->
<!-- -   Quantify the size of gender differences in liberal/authoritarian attitudes across age groups -->
<!-- -   Show if the gap is wider among younger generations (18-34) vs other -->
<!-- -   Key metric: Gap size in composite social attitudes scale by age band -->
<!-- -   weighted regression model - effect of age, gender, age:gender interaction, education, ethnicity, region, household, religion, social_grade classification, marital status on conservatism + economic leftism + combined right-wing score -->
<!-- 3) Specific guidance - how can messaging and PR change for the company? -->
<!-- -   Challenge the "young monolith" assumption by showing attitude distributions within 18-34 demographic -->
<!-- -   Segment young men vs young women across both economic and social dimensions -->
<!-- -   Identify distinct clusters for targeted messaging -->
<!-- 4) Tracking Dashboard Framework -->
<!-- -   Automated functions to monitor changes over time -->
<!-- -   Key indicators: gender gap trends, generational shifts, attitude polarization metrics -->
<!-- -   Proof of concept using monthly splits from current data -->
<section id="verify-data-qualityintegrity" class="level4">
<h4 class="anchored" data-anchor-id="verify-data-qualityintegrity">1) Verify data quality/integrity</h4>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(VIM)</span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a><span class="co">#VIM::aggr(uk_data, plot = FALSE)</span></span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a><span class="co">#unique(uk_data$eu_ref)</span></span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a><span class="co"># we treat don't know as missing data</span></span>
<span id="cb3-8"><a href="#cb3-8" aria-hidden="true" tabindex="-1"></a><span class="co"># sapply(uk_data[,c(3:6, 11:27)], unique)</span></span>
<span id="cb3-9"><a href="#cb3-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-10"><a href="#cb3-10" aria-hidden="true" tabindex="-1"></a><span class="co"># apply unique to all data</span></span>
<span id="cb3-11"><a href="#cb3-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-12"><a href="#cb3-12" aria-hidden="true" tabindex="-1"></a><span class="co"># encode NA's appropriately</span></span>
<span id="cb3-13"><a href="#cb3-13" aria-hidden="true" tabindex="-1"></a>uk_data <span class="ot">&lt;-</span> uk_data <span class="sc">%&gt;%</span></span>
<span id="cb3-14"><a href="#cb3-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="fu">across</span>(<span class="fu">everything</span>(), <span class="sc">~</span><span class="fu">case_when</span>(</span>
<span id="cb3-15"><a href="#cb3-15" aria-hidden="true" tabindex="-1"></a>    .x <span class="sc">==</span> <span class="st">"Don't know"</span> <span class="sc">~</span> <span class="cn">NA</span>,</span>
<span id="cb3-16"><a href="#cb3-16" aria-hidden="true" tabindex="-1"></a>    .x <span class="sc">==</span> <span class="st">"dk"</span> <span class="sc">~</span> <span class="cn">NA</span>,</span>
<span id="cb3-17"><a href="#cb3-17" aria-hidden="true" tabindex="-1"></a>    .x <span class="sc">==</span> <span class="st">"no_answer"</span> <span class="sc">~</span> <span class="cn">NA</span>,           <span class="co"># religion column</span></span>
<span id="cb3-18"><a href="#cb3-18" aria-hidden="true" tabindex="-1"></a>    .x <span class="sc">==</span> <span class="st">"prefer_not_to_say"</span> <span class="sc">~</span> <span class="cn">NA</span>,   <span class="co"># marital column</span></span>
<span id="cb3-19"><a href="#cb3-19" aria-hidden="true" tabindex="-1"></a>    <span class="cn">TRUE</span> <span class="sc">~</span> .x</span>
<span id="cb3-20"><a href="#cb3-20" aria-hidden="true" tabindex="-1"></a>  )))</span>
<span id="cb3-21"><a href="#cb3-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-22"><a href="#cb3-22" aria-hidden="true" tabindex="-1"></a>VIM<span class="sc">::</span><span class="fu">aggr</span>(uk_data, <span class="at">plot =</span> <span class="cn">FALSE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
 Missings in variables:
     Variable Count
     religion   488
      marital   148
       eu_ref   658
    exact_age    25
  econ_redist   772
  econ_bigbiz   538
  econ_unfair   535
  econ_onelaw   408
 econ_exploit   556
  soc_respect   613
 soc_deathpen   845
  soc_schools   391
   soc_censor   775
   soc_punish   528</code></pre>
</div>
</div>
<p>Generally very few NAs in the data. Roughly equal rates across survey questions.</p>
</section>
<section id="create-composite-economicsocial-ideology-scales" class="level4">
<h4 class="anchored" data-anchor-id="create-composite-economicsocial-ideology-scales">2) Create Composite Economic/Social Ideology Scales</h4>
<p>In future, consider encoding to 0 to 1 scale for ease of interpretation.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Function to recode attitude responses to -1 to 1 scale</span></span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>recode_attitude <span class="ot">&lt;-</span> <span class="cf">function</span>(x) {</span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">case_when</span>(</span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a>    x <span class="sc">==</span> <span class="st">"Strongly agree"</span> <span class="sc">~</span> <span class="dv">1</span>,</span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a>    x <span class="sc">==</span> <span class="st">"Agree"</span> <span class="sc">~</span> <span class="fl">0.5</span>,</span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a>    x <span class="sc">==</span> <span class="st">"Neither agree nor disagree"</span> <span class="sc">~</span> <span class="dv">0</span>,</span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a>    x <span class="sc">==</span> <span class="st">"Disagree"</span> <span class="sc">~</span> <span class="sc">-</span><span class="fl">0.5</span>,</span>
<span id="cb5-8"><a href="#cb5-8" aria-hidden="true" tabindex="-1"></a>    x <span class="sc">==</span> <span class="st">"Strongly disagree"</span> <span class="sc">~</span> <span class="sc">-</span><span class="dv">1</span>,</span>
<span id="cb5-9"><a href="#cb5-9" aria-hidden="true" tabindex="-1"></a>    <span class="cn">TRUE</span> <span class="sc">~</span> <span class="cn">NA_real_</span></span>
<span id="cb5-10"><a href="#cb5-10" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb5-11"><a href="#cb5-11" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb5-12"><a href="#cb5-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-13"><a href="#cb5-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Convert attitude variables to numeric and create scales</span></span>
<span id="cb5-14"><a href="#cb5-14" aria-hidden="true" tabindex="-1"></a>uk_data_test <span class="ot">&lt;-</span> uk_data <span class="sc">%&gt;%</span></span>
<span id="cb5-15"><a href="#cb5-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb5-16"><a href="#cb5-16" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Convert social attitude variables to numeric (-2 to 2 scale)</span></span>
<span id="cb5-17"><a href="#cb5-17" aria-hidden="true" tabindex="-1"></a>    <span class="at">soc_respect =</span> <span class="fu">recode_attitude</span>(soc_respect),</span>
<span id="cb5-18"><a href="#cb5-18" aria-hidden="true" tabindex="-1"></a>    <span class="at">soc_deathpen =</span> <span class="fu">recode_attitude</span>(soc_deathpen),</span>
<span id="cb5-19"><a href="#cb5-19" aria-hidden="true" tabindex="-1"></a>    <span class="at">soc_schools =</span> <span class="fu">recode_attitude</span>(soc_schools),</span>
<span id="cb5-20"><a href="#cb5-20" aria-hidden="true" tabindex="-1"></a>    <span class="at">soc_censor =</span> <span class="fu">recode_attitude</span>(soc_censor),</span>
<span id="cb5-21"><a href="#cb5-21" aria-hidden="true" tabindex="-1"></a>    <span class="at">soc_punish =</span> <span class="fu">recode_attitude</span>(soc_punish),</span>
<span id="cb5-22"><a href="#cb5-22" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Convert economic attitude variables to numeric (-2 to 2 scale)</span></span>
<span id="cb5-23"><a href="#cb5-23" aria-hidden="true" tabindex="-1"></a>    <span class="at">econ_redist =</span> <span class="fu">recode_attitude</span>(econ_redist),</span>
<span id="cb5-24"><a href="#cb5-24" aria-hidden="true" tabindex="-1"></a>    <span class="at">econ_bigbiz =</span> <span class="fu">recode_attitude</span>(econ_bigbiz),</span>
<span id="cb5-25"><a href="#cb5-25" aria-hidden="true" tabindex="-1"></a>    <span class="at">econ_unfair =</span> <span class="fu">recode_attitude</span>(econ_unfair),</span>
<span id="cb5-26"><a href="#cb5-26" aria-hidden="true" tabindex="-1"></a>    <span class="at">econ_onelaw =</span> <span class="fu">recode_attitude</span>(econ_onelaw),</span>
<span id="cb5-27"><a href="#cb5-27" aria-hidden="true" tabindex="-1"></a>    <span class="at">econ_exploit =</span> <span class="fu">recode_attitude</span>(econ_exploit)) <span class="sc">%&gt;%</span> </span>
<span id="cb5-28"><a href="#cb5-28" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rowwise</span>() <span class="sc">%&gt;%</span></span>
<span id="cb5-29"><a href="#cb5-29" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb5-30"><a href="#cb5-30" aria-hidden="true" tabindex="-1"></a>    <span class="at">social_conservatism =</span> <span class="fu">mean</span>(<span class="fu">c_across</span>(<span class="fu">c</span>(soc_respect, soc_deathpen, soc_schools, soc_censor, soc_punish)), <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb5-31"><a href="#cb5-31" aria-hidden="true" tabindex="-1"></a>    <span class="at">economic_leftism =</span> <span class="fu">mean</span>(<span class="fu">c_across</span>(<span class="fu">c</span>(econ_redist, econ_bigbiz, econ_unfair, econ_onelaw, econ_exploit)), <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb5-32"><a href="#cb5-32" aria-hidden="true" tabindex="-1"></a>    <span class="at">social_na_count =</span> <span class="fu">sum</span>(<span class="fu">is.na</span>(<span class="fu">c_across</span>(<span class="fu">c</span>(soc_respect, soc_deathpen, soc_schools, soc_censor, soc_punish)))),</span>
<span id="cb5-33"><a href="#cb5-33" aria-hidden="true" tabindex="-1"></a>    <span class="at">economic_na_count =</span> <span class="fu">sum</span>(<span class="fu">is.na</span>(<span class="fu">c_across</span>(<span class="fu">c</span>(econ_redist, econ_bigbiz, econ_unfair, econ_onelaw, econ_exploit))))</span>
<span id="cb5-34"><a href="#cb5-34" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb5-35"><a href="#cb5-35" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>()</span>
<span id="cb5-36"><a href="#cb5-36" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-37"><a href="#cb5-37" aria-hidden="true" tabindex="-1"></a>uk_data <span class="ot">&lt;-</span> uk_data_test</span>
<span id="cb5-38"><a href="#cb5-38" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-39"><a href="#cb5-39" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(uk_data_test<span class="sc">$</span>social_conservatism)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   Min. 1st Qu.  Median    Mean 3rd Qu.    Max.    NA's 
-1.0000  0.1000  0.4000  0.3187  0.6000  1.0000     118 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a>uk_data_test <span class="sc">%&gt;%</span> </span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="fu">is.na</span>(social_conservatism)) <span class="sc">%&gt;%</span> </span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 118 × 31
   respondent_id    wt age      gender education ethnicity region      cons_code
   &lt;chr&gt;         &lt;dbl&gt; &lt;chr&gt;    &lt;chr&gt;  &lt;chr&gt;     &lt;chr&gt;     &lt;chr&gt;       &lt;chr&gt;    
 1 fd0288697394  0.885 25_TO_34 female low       asian     North West… E14001416
 2 fd0408935511  1.06  35_TO_44 female low       white     Scotland    S14000101
 3 fd0700150710  0.778 18_TO_24 male   low       black     South East… E14001599
 4 fd0704501787  0.916 45_TO_54 female low       white     East Midla… E14001266
 5 fd0889318795  0.958 45_TO_54 male   high      white     Greater Lo… E14001085
 6 fd1111550039  0.962 55_TO_64 female low       white     West Midla… E14001473
 7 fd1161681917  0.716 35_TO_44 female high      white     South West… E14001356
 8 fd1276995392  0.887 35_TO_44 female low       white     West Midla… E14001523
 9 fd1329112856  0.876 35_TO_44 female low       white     Yorkshire … E14001452
10 fd1536151046  0.776 55_TO_64 female high      white     Yorkshire … E14001506
# ℹ 108 more rows
# ℹ 23 more variables: cons_name &lt;chr&gt;, household &lt;chr&gt;, religion &lt;chr&gt;,
#   socgrad &lt;chr&gt;, marital &lt;chr&gt;, pv_2019 &lt;chr&gt;, pv_2024 &lt;chr&gt;, eu_ref &lt;chr&gt;,
#   exact_age &lt;dbl&gt;, econ_redist &lt;dbl&gt;, econ_bigbiz &lt;dbl&gt;, econ_unfair &lt;dbl&gt;,
#   econ_onelaw &lt;dbl&gt;, econ_exploit &lt;dbl&gt;, soc_respect &lt;dbl&gt;,
#   soc_deathpen &lt;dbl&gt;, soc_schools &lt;dbl&gt;, soc_censor &lt;dbl&gt;, soc_punish &lt;dbl&gt;,
#   social_conservatism &lt;dbl&gt;, economic_leftism &lt;dbl&gt;, social_na_count &lt;int&gt;, …</code></pre>
</div>
</div>
<p>above scale creation could be optimized for efficiency down the line. Rowwise operations decrease efficiency, could be eliminated.</p>
<p>Interpreting the scales: - agreement with the social questions implies high social conservatism - agreement with the economic questions implise high economic leftism</p>
<p>We expect a traditionally ’ri</p>
</section>
<section id="quantify-size-of-gender-differences-across-age-groups" class="level4">
<h4 class="anchored" data-anchor-id="quantify-size-of-gender-differences-across-age-groups">3) Quantify size of gender differences across age groups</h4>
<section id="vote-shares-in-2024-election-by-gender-and-age-bands" class="level5">
<h5 class="anchored" data-anchor-id="vote-shares-in-2024-election-by-gender-and-age-bands">Vote shares in 2024 election by Gender and Age Bands</h5>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="co"># create a visualization that shows, for each gender in each age band, their vote split in the 2024 election</span></span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a><span class="co"># First, let's examine the vote choices available</span></span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Available 2024 vote choices:</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Available 2024 vote choices:</code></pre>
</div>
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">unique</span>(uk_data<span class="sc">$</span>pv_2024))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "rfm" "lab" "con" "grn" "wnv" "ldm" "snp" "oth" "pcy"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate weighted vote shares by gender and age group</span></span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a>vote_shares <span class="ot">&lt;-</span> uk_data <span class="sc">%&gt;%</span></span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(pv_2024) <span class="sc">&amp;</span> <span class="sc">!</span><span class="fu">is.na</span>(gender) <span class="sc">&amp;</span> <span class="sc">!</span><span class="fu">is.na</span>(age)) <span class="sc">%&gt;%</span></span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(age, gender, pv_2024) <span class="sc">%&gt;%</span></span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(</span>
<span id="cb13-6"><a href="#cb13-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">weighted_count =</span> <span class="fu">sum</span>(wt, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb13-7"><a href="#cb13-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">.groups =</span> <span class="st">"keep"</span></span>
<span id="cb13-8"><a href="#cb13-8" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb13-9"><a href="#cb13-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(age, gender) <span class="sc">%&gt;%</span></span>
<span id="cb13-10"><a href="#cb13-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb13-11"><a href="#cb13-11" aria-hidden="true" tabindex="-1"></a>    <span class="at">total_weighted =</span> <span class="fu">sum</span>(weighted_count),</span>
<span id="cb13-12"><a href="#cb13-12" aria-hidden="true" tabindex="-1"></a>    <span class="at">vote_share =</span> weighted_count <span class="sc">/</span> total_weighted <span class="sc">*</span> <span class="dv">100</span></span>
<span id="cb13-13"><a href="#cb13-13" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb13-14"><a href="#cb13-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>()</span>
<span id="cb13-15"><a href="#cb13-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-16"><a href="#cb13-16" aria-hidden="true" tabindex="-1"></a><span class="co"># Display the data</span></span>
<span id="cb13-17"><a href="#cb13-17" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="st">"Vote shares by age, gender, and party:"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Vote shares by age, gender, and party:"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(vote_shares)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 125 × 6
   age      gender pv_2024 weighted_count total_weighted vote_share
   &lt;chr&gt;    &lt;chr&gt;  &lt;chr&gt;            &lt;dbl&gt;          &lt;dbl&gt;      &lt;dbl&gt;
 1 18_TO_24 female con             145.            1992.      7.29 
 2 18_TO_24 female grn             253.            1992.     12.7  
 3 18_TO_24 female lab            1021.            1992.     51.3  
 4 18_TO_24 female ldm              96.8           1992.      4.86 
 5 18_TO_24 female oth              22.6           1992.      1.14 
 6 18_TO_24 female pcy               6.07          1992.      0.305
 7 18_TO_24 female rfm             180.            1992.      9.01 
 8 18_TO_24 female snp              36.6           1992.      1.84 
 9 18_TO_24 female wnv             231.            1992.     11.6  
10 18_TO_24 male   con             172.            1433.     12.0  
# ℹ 115 more rows</code></pre>
</div>
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="co"># visualization - side-by-side comparison for key parties</span></span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a>major_parties <span class="ot">&lt;-</span> vote_shares <span class="sc">%&gt;%</span></span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(pv_2024 <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"con"</span>, <span class="st">"lab"</span>, <span class="st">"ldm"</span>, <span class="st">"rfm"</span>, <span class="st">"grn"</span>))</span>
<span id="cb17-4"><a href="#cb17-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-5"><a href="#cb17-5" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(major_parties, <span class="fu">aes</span>(<span class="at">x =</span> age, <span class="at">y =</span> vote_share, <span class="at">fill =</span> gender)) <span class="sc">+</span></span>
<span id="cb17-6"><a href="#cb17-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_col</span>(<span class="at">position =</span> <span class="st">"dodge"</span>) <span class="sc">+</span></span>
<span id="cb17-7"><a href="#cb17-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>pv_2024, <span class="at">scales =</span> <span class="st">"free_y"</span>) <span class="sc">+</span></span>
<span id="cb17-8"><a href="#cb17-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb17-9"><a href="#cb17-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Gender Differences in 2024 Vote Choice by Age Group"</span>,</span>
<span id="cb17-10"><a href="#cb17-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">subtitle =</span> <span class="st">"Side-by-side comparison for major parties"</span>,</span>
<span id="cb17-11"><a href="#cb17-11" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"Age Group"</span>,</span>
<span id="cb17-12"><a href="#cb17-12" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">"Vote Share (%)"</span>,</span>
<span id="cb17-13"><a href="#cb17-13" aria-hidden="true" tabindex="-1"></a>    <span class="at">fill =</span> <span class="st">"Gender"</span></span>
<span id="cb17-14"><a href="#cb17-14" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb17-15"><a href="#cb17-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb17-16"><a href="#cb17-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(</span>
<span id="cb17-17"><a href="#cb17-17" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">45</span>, <span class="at">hjust =</span> <span class="dv">1</span>),</span>
<span id="cb17-18"><a href="#cb17-18" aria-hidden="true" tabindex="-1"></a>    <span class="at">strip.text =</span> <span class="fu">element_text</span>(<span class="at">face =</span> <span class="st">"bold"</span>)</span>
<span id="cb17-19"><a href="#cb17-19" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb17-20"><a href="#cb17-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"male"</span> <span class="ot">=</span> <span class="st">"lightblue"</span>, <span class="st">"female"</span> <span class="ot">=</span> <span class="st">"pink"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="initial_analysis_files/figure-html/unnamed-chunk-4-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:80.0%"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="average-social-conservatism-by-genderage-bands" class="level5">
<h5 class="anchored" data-anchor-id="average-social-conservatism-by-genderage-bands">Average social conservatism by gender/age bands</h5>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Load survey package for proper weighted calculations</span></span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(survey)</span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-4"><a href="#cb18-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Create survey design object</span></span>
<span id="cb18-5"><a href="#cb18-5" aria-hidden="true" tabindex="-1"></a>survey_design <span class="ot">&lt;-</span> <span class="fu">svydesign</span>(</span>
<span id="cb18-6"><a href="#cb18-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">ids =</span> <span class="sc">~</span><span class="dv">1</span>,  <span class="co"># no clustering</span></span>
<span id="cb18-7"><a href="#cb18-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">weights =</span> <span class="sc">~</span>wt,</span>
<span id="cb18-8"><a href="#cb18-8" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> uk_data <span class="sc">%&gt;%</span> <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(social_conservatism) <span class="sc">&amp;</span> <span class="sc">!</span><span class="fu">is.na</span>(gender) <span class="sc">&amp;</span> <span class="sc">!</span><span class="fu">is.na</span>(age))</span>
<span id="cb18-9"><a href="#cb18-9" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb18-10"><a href="#cb18-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-11"><a href="#cb18-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate survey-weighted means by age and gender</span></span>
<span id="cb18-12"><a href="#cb18-12" aria-hidden="true" tabindex="-1"></a>social_conservatism_means <span class="ot">&lt;-</span> <span class="fu">svyby</span>(</span>
<span id="cb18-13"><a href="#cb18-13" aria-hidden="true" tabindex="-1"></a>  <span class="sc">~</span>social_conservatism,</span>
<span id="cb18-14"><a href="#cb18-14" aria-hidden="true" tabindex="-1"></a>  <span class="sc">~</span>age <span class="sc">+</span> gender,</span>
<span id="cb18-15"><a href="#cb18-15" aria-hidden="true" tabindex="-1"></a>  <span class="at">design =</span> survey_design,</span>
<span id="cb18-16"><a href="#cb18-16" aria-hidden="true" tabindex="-1"></a>  <span class="at">FUN =</span> svymean,</span>
<span id="cb18-17"><a href="#cb18-17" aria-hidden="true" tabindex="-1"></a>  <span class="at">na.rm =</span> <span class="cn">TRUE</span></span>
<span id="cb18-18"><a href="#cb18-18" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb18-19"><a href="#cb18-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-20"><a href="#cb18-20" aria-hidden="true" tabindex="-1"></a><span class="co"># Convert to data frame and clean up</span></span>
<span id="cb18-21"><a href="#cb18-21" aria-hidden="true" tabindex="-1"></a>social_conservatism_means <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(social_conservatism_means) <span class="sc">%&gt;%</span></span>
<span id="cb18-22"><a href="#cb18-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">mean_social_conservatism =</span> social_conservatism)</span>
<span id="cb18-23"><a href="#cb18-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-24"><a href="#cb18-24" aria-hidden="true" tabindex="-1"></a><span class="co"># Display the results</span></span>
<span id="cb18-25"><a href="#cb18-25" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="st">"Survey-weighted means by age and gender:"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Survey-weighted means by age and gender:"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(social_conservatism_means)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                     age gender mean_social_conservatism          se
18_TO_24.female 18_TO_24 female                0.1460869 0.008286800
25_TO_34.female 25_TO_34 female                0.2607681 0.006890166
35_TO_44.female 35_TO_44 female                0.3067387 0.006918410
45_TO_54.female 45_TO_54 female                0.3494708 0.006760156
55_TO_64.female 55_TO_64 female                0.3949497 0.007455386
65_TO_74.female 65_TO_74 female                0.4284155 0.008263432
75_PLUS.female   75_PLUS female                0.4510734 0.013586050
18_TO_24.male   18_TO_24   male                0.2055819 0.010742247
25_TO_34.male   25_TO_34   male                0.3004190 0.008206120
35_TO_44.male   35_TO_44   male                0.3332870 0.008202318
45_TO_54.male   45_TO_54   male                0.3128641 0.008557283
55_TO_64.male   55_TO_64   male                0.3370399 0.009408996
65_TO_74.male   65_TO_74   male                0.3997589 0.009484841
75_PLUS.male     75_PLUS   male                0.4445209 0.014750208</code></pre>
</div>
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Create barplot</span></span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(social_conservatism_means, <span class="fu">aes</span>(<span class="at">x =</span> age, <span class="at">y =</span> mean_social_conservatism, <span class="at">fill =</span> gender)) <span class="sc">+</span></span>
<span id="cb22-3"><a href="#cb22-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_col</span>(<span class="at">position =</span> <span class="st">"dodge"</span>) <span class="sc">+</span></span>
<span id="cb22-4"><a href="#cb22-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_errorbar</span>(<span class="fu">aes</span>(<span class="at">ymin =</span> mean_social_conservatism <span class="sc">-</span> se,</span>
<span id="cb22-5"><a href="#cb22-5" aria-hidden="true" tabindex="-1"></a>                    <span class="at">ymax =</span> mean_social_conservatism <span class="sc">+</span> se),</span>
<span id="cb22-6"><a href="#cb22-6" aria-hidden="true" tabindex="-1"></a>                <span class="at">position =</span> <span class="fu">position_dodge</span>(<span class="at">width =</span> <span class="fl">0.9</span>), <span class="at">width =</span> <span class="fl">0.25</span>, <span class="at">alpha =</span> <span class="fl">0.7</span>) <span class="sc">+</span></span>
<span id="cb22-7"><a href="#cb22-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb22-8"><a href="#cb22-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Average Social Conservatism Scores by Age Group and Gender"</span>,</span>
<span id="cb22-9"><a href="#cb22-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">subtitle =</span> <span class="st">"Survey-weighted means with standard errors. Higher scores = more conservative"</span>,</span>
<span id="cb22-10"><a href="#cb22-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"Age Group"</span>,</span>
<span id="cb22-11"><a href="#cb22-11" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">"Mean Social Conservatism Score"</span>,</span>
<span id="cb22-12"><a href="#cb22-12" aria-hidden="true" tabindex="-1"></a>    <span class="at">fill =</span> <span class="st">"Gender"</span></span>
<span id="cb22-13"><a href="#cb22-13" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb22-14"><a href="#cb22-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb22-15"><a href="#cb22-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">45</span>, <span class="at">hjust =</span> <span class="dv">1</span>)) <span class="sc">+</span></span>
<span id="cb22-16"><a href="#cb22-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"male"</span> <span class="ot">=</span> <span class="st">"lightblue"</span>, <span class="st">"female"</span> <span class="ot">=</span> <span class="st">"pink"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="initial_analysis_files/figure-html/unnamed-chunk-5-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:80.0%"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="average-economic-leftism-by-genderage-bands" class="level5">
<h5 class="anchored" data-anchor-id="average-economic-leftism-by-genderage-bands">Average economic leftism by gender/age bands</h5>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate survey-weighted means for economic leftism by age and gender</span></span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a>economic_leftism_means <span class="ot">&lt;-</span> <span class="fu">svyby</span>(</span>
<span id="cb23-3"><a href="#cb23-3" aria-hidden="true" tabindex="-1"></a>  <span class="sc">~</span>economic_leftism,</span>
<span id="cb23-4"><a href="#cb23-4" aria-hidden="true" tabindex="-1"></a>  <span class="sc">~</span>age <span class="sc">+</span> gender,</span>
<span id="cb23-5"><a href="#cb23-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">design =</span> survey_design,</span>
<span id="cb23-6"><a href="#cb23-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">FUN =</span> svymean,</span>
<span id="cb23-7"><a href="#cb23-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">na.rm =</span> <span class="cn">TRUE</span></span>
<span id="cb23-8"><a href="#cb23-8" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb23-9"><a href="#cb23-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-10"><a href="#cb23-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Convert to data frame and clean up</span></span>
<span id="cb23-11"><a href="#cb23-11" aria-hidden="true" tabindex="-1"></a>economic_leftism_means <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(economic_leftism_means) <span class="sc">%&gt;%</span></span>
<span id="cb23-12"><a href="#cb23-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">mean_economic_leftism =</span> economic_leftism)</span>
<span id="cb23-13"><a href="#cb23-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-14"><a href="#cb23-14" aria-hidden="true" tabindex="-1"></a><span class="co"># Display the results</span></span>
<span id="cb23-15"><a href="#cb23-15" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="st">"Survey-weighted economic leftism means by age and gender:"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Survey-weighted economic leftism means by age and gender:"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(economic_leftism_means)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                     age gender mean_economic_leftism          se
18_TO_24.female 18_TO_24 female             0.4653603 0.007661601
25_TO_34.female 25_TO_34 female             0.4556771 0.006046594
35_TO_44.female 35_TO_44 female             0.4445916 0.006306771
45_TO_54.female 45_TO_54 female             0.4199695 0.006742521
55_TO_64.female 55_TO_64 female             0.3848760 0.007786974
65_TO_74.female 65_TO_74 female             0.3125429 0.009425094
75_PLUS.female   75_PLUS female             0.2009801 0.015962435
18_TO_24.male   18_TO_24   male             0.3973085 0.010354327
25_TO_34.male   25_TO_34   male             0.4266462 0.007664853
35_TO_44.male   35_TO_44   male             0.4606472 0.007574518
45_TO_54.male   45_TO_54   male             0.4510540 0.008125294
55_TO_64.male   55_TO_64   male             0.4237312 0.009592899
65_TO_74.male   65_TO_74   male             0.3637152 0.010713940
75_PLUS.male     75_PLUS   male             0.1940865 0.017827940</code></pre>
</div>
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Create barplot</span></span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(economic_leftism_means, <span class="fu">aes</span>(<span class="at">x =</span> age, <span class="at">y =</span> mean_economic_leftism, <span class="at">fill =</span> gender)) <span class="sc">+</span></span>
<span id="cb27-3"><a href="#cb27-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_col</span>(<span class="at">position =</span> <span class="st">"dodge"</span>) <span class="sc">+</span></span>
<span id="cb27-4"><a href="#cb27-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_errorbar</span>(<span class="fu">aes</span>(<span class="at">ymin =</span> mean_economic_leftism <span class="sc">-</span> se,</span>
<span id="cb27-5"><a href="#cb27-5" aria-hidden="true" tabindex="-1"></a>                    <span class="at">ymax =</span> mean_economic_leftism <span class="sc">+</span> se),</span>
<span id="cb27-6"><a href="#cb27-6" aria-hidden="true" tabindex="-1"></a>                <span class="at">position =</span> <span class="fu">position_dodge</span>(<span class="at">width =</span> <span class="fl">0.9</span>), <span class="at">width =</span> <span class="fl">0.25</span>, <span class="at">alpha =</span> <span class="fl">0.7</span>) <span class="sc">+</span></span>
<span id="cb27-7"><a href="#cb27-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb27-8"><a href="#cb27-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Average Economic Leftism Scores by Age Group and Gender"</span>,</span>
<span id="cb27-9"><a href="#cb27-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">subtitle =</span> <span class="st">"Survey-weighted means with standard errors. Higher scores = more left-wing"</span>,</span>
<span id="cb27-10"><a href="#cb27-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"Age Group"</span>,</span>
<span id="cb27-11"><a href="#cb27-11" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">"Mean Economic Leftism Score"</span>,</span>
<span id="cb27-12"><a href="#cb27-12" aria-hidden="true" tabindex="-1"></a>    <span class="at">fill =</span> <span class="st">"Gender"</span></span>
<span id="cb27-13"><a href="#cb27-13" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb27-14"><a href="#cb27-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb27-15"><a href="#cb27-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">45</span>, <span class="at">hjust =</span> <span class="dv">1</span>)) <span class="sc">+</span></span>
<span id="cb27-16"><a href="#cb27-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"male"</span> <span class="ot">=</span> <span class="st">"lightblue"</span>, <span class="st">"female"</span> <span class="ot">=</span> <span class="st">"pink"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="initial_analysis_files/figure-html/unnamed-chunk-6-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:80.0%"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="average-social-conservatism-by-exact-age" class="level5">
<h5 class="anchored" data-anchor-id="average-social-conservatism-by-exact-age">Average social conservatism by exact age</h5>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Create survey design object for exact age analysis</span></span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a>survey_design_exact_age <span class="ot">&lt;-</span> <span class="fu">svydesign</span>(</span>
<span id="cb28-3"><a href="#cb28-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">ids =</span> <span class="sc">~</span><span class="dv">1</span>,</span>
<span id="cb28-4"><a href="#cb28-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">weights =</span> <span class="sc">~</span>wt,</span>
<span id="cb28-5"><a href="#cb28-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> uk_data <span class="sc">%&gt;%</span> <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(social_conservatism) <span class="sc">&amp;</span> <span class="sc">!</span><span class="fu">is.na</span>(gender) <span class="sc">&amp;</span> <span class="sc">!</span><span class="fu">is.na</span>(exact_age))</span>
<span id="cb28-6"><a href="#cb28-6" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb28-7"><a href="#cb28-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-8"><a href="#cb28-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate survey-weighted means by exact age and gender</span></span>
<span id="cb28-9"><a href="#cb28-9" aria-hidden="true" tabindex="-1"></a>social_conservatism_by_age <span class="ot">&lt;-</span> <span class="fu">svyby</span>(</span>
<span id="cb28-10"><a href="#cb28-10" aria-hidden="true" tabindex="-1"></a>  <span class="sc">~</span>social_conservatism,</span>
<span id="cb28-11"><a href="#cb28-11" aria-hidden="true" tabindex="-1"></a>  <span class="sc">~</span>exact_age <span class="sc">+</span> gender,</span>
<span id="cb28-12"><a href="#cb28-12" aria-hidden="true" tabindex="-1"></a>  <span class="at">design =</span> survey_design_exact_age,</span>
<span id="cb28-13"><a href="#cb28-13" aria-hidden="true" tabindex="-1"></a>  <span class="at">FUN =</span> svymean,</span>
<span id="cb28-14"><a href="#cb28-14" aria-hidden="true" tabindex="-1"></a>  <span class="at">na.rm =</span> <span class="cn">TRUE</span></span>
<span id="cb28-15"><a href="#cb28-15" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb28-16"><a href="#cb28-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-17"><a href="#cb28-17" aria-hidden="true" tabindex="-1"></a><span class="co"># Convert to data frame and clean up</span></span>
<span id="cb28-18"><a href="#cb28-18" aria-hidden="true" tabindex="-1"></a>social_conservatism_by_age <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(social_conservatism_by_age) <span class="sc">%&gt;%</span></span>
<span id="cb28-19"><a href="#cb28-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">mean_social_conservatism =</span> social_conservatism)</span>
<span id="cb28-20"><a href="#cb28-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-21"><a href="#cb28-21" aria-hidden="true" tabindex="-1"></a><span class="co"># Create line plot with confidence intervals</span></span>
<span id="cb28-22"><a href="#cb28-22" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(social_conservatism_by_age, <span class="fu">aes</span>(<span class="at">x =</span> exact_age, <span class="at">y =</span> mean_social_conservatism, <span class="at">color =</span> gender)) <span class="sc">+</span></span>
<span id="cb28-23"><a href="#cb28-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">size =</span> <span class="fl">1.2</span>) <span class="sc">+</span></span>
<span id="cb28-24"><a href="#cb28-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_ribbon</span>(<span class="fu">aes</span>(<span class="at">ymin =</span> mean_social_conservatism <span class="sc">-</span> <span class="fl">1.96</span><span class="sc">*</span>se,</span>
<span id="cb28-25"><a href="#cb28-25" aria-hidden="true" tabindex="-1"></a>                  <span class="at">ymax =</span> mean_social_conservatism <span class="sc">+</span> <span class="fl">1.96</span><span class="sc">*</span>se,</span>
<span id="cb28-26"><a href="#cb28-26" aria-hidden="true" tabindex="-1"></a>                  <span class="at">fill =</span> gender),</span>
<span id="cb28-27"><a href="#cb28-27" aria-hidden="true" tabindex="-1"></a>              <span class="at">alpha =</span> <span class="fl">0.3</span>, <span class="at">linetype =</span> <span class="dv">0</span>) <span class="sc">+</span></span>
<span id="cb28-28"><a href="#cb28-28" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb28-29"><a href="#cb28-29" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Average Social Conservatism by Exact Age and Gender"</span>,</span>
<span id="cb28-30"><a href="#cb28-30" aria-hidden="true" tabindex="-1"></a>    <span class="at">subtitle =</span> <span class="st">"Survey-weighted means with 95% confidence intervals. Higher scores = more conservative"</span>,</span>
<span id="cb28-31"><a href="#cb28-31" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"Age (Years)"</span>,</span>
<span id="cb28-32"><a href="#cb28-32" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">"Mean Social Conservatism Score"</span>,</span>
<span id="cb28-33"><a href="#cb28-33" aria-hidden="true" tabindex="-1"></a>    <span class="at">color =</span> <span class="st">"Gender"</span>,</span>
<span id="cb28-34"><a href="#cb28-34" aria-hidden="true" tabindex="-1"></a>    <span class="at">fill =</span> <span class="st">"Gender"</span></span>
<span id="cb28-35"><a href="#cb28-35" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb28-36"><a href="#cb28-36" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb28-37"><a href="#cb28-37" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"male"</span> <span class="ot">=</span> <span class="st">"steelblue"</span>, <span class="st">"female"</span> <span class="ot">=</span> <span class="st">"coral"</span>)) <span class="sc">+</span></span>
<span id="cb28-38"><a href="#cb28-38" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"male"</span> <span class="ot">=</span> <span class="st">"steelblue"</span>, <span class="st">"female"</span> <span class="ot">=</span> <span class="st">"coral"</span>)) <span class="sc">+</span></span>
<span id="cb28-39"><a href="#cb28-39" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"bottom"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="initial_analysis_files/figure-html/unnamed-chunk-7-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:80.0%"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="average-economic-leftism-by-exact-age" class="level5">
<h5 class="anchored" data-anchor-id="average-economic-leftism-by-exact-age">Average economic leftism by exact age</h5>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate survey-weighted means for economic leftism by exact age and gender</span></span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a>economic_leftism_by_age <span class="ot">&lt;-</span> <span class="fu">svyby</span>(</span>
<span id="cb29-3"><a href="#cb29-3" aria-hidden="true" tabindex="-1"></a>  <span class="sc">~</span>economic_leftism,</span>
<span id="cb29-4"><a href="#cb29-4" aria-hidden="true" tabindex="-1"></a>  <span class="sc">~</span>exact_age <span class="sc">+</span> gender,</span>
<span id="cb29-5"><a href="#cb29-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">design =</span> survey_design_exact_age,</span>
<span id="cb29-6"><a href="#cb29-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">FUN =</span> svymean,</span>
<span id="cb29-7"><a href="#cb29-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">na.rm =</span> <span class="cn">TRUE</span></span>
<span id="cb29-8"><a href="#cb29-8" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb29-9"><a href="#cb29-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-10"><a href="#cb29-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Convert to data frame and clean up</span></span>
<span id="cb29-11"><a href="#cb29-11" aria-hidden="true" tabindex="-1"></a>economic_leftism_by_age <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(economic_leftism_by_age) <span class="sc">%&gt;%</span></span>
<span id="cb29-12"><a href="#cb29-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">mean_economic_leftism =</span> economic_leftism)</span>
<span id="cb29-13"><a href="#cb29-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-14"><a href="#cb29-14" aria-hidden="true" tabindex="-1"></a><span class="co"># Create line plot with confidence intervals</span></span>
<span id="cb29-15"><a href="#cb29-15" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(economic_leftism_by_age, <span class="fu">aes</span>(<span class="at">x =</span> exact_age, <span class="at">y =</span> mean_economic_leftism, <span class="at">color =</span> gender)) <span class="sc">+</span></span>
<span id="cb29-16"><a href="#cb29-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">size =</span> <span class="fl">1.2</span>) <span class="sc">+</span></span>
<span id="cb29-17"><a href="#cb29-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_ribbon</span>(<span class="fu">aes</span>(<span class="at">ymin =</span> mean_economic_leftism <span class="sc">-</span> <span class="fl">1.96</span><span class="sc">*</span>se,</span>
<span id="cb29-18"><a href="#cb29-18" aria-hidden="true" tabindex="-1"></a>                  <span class="at">ymax =</span> mean_economic_leftism <span class="sc">+</span> <span class="fl">1.96</span><span class="sc">*</span>se,</span>
<span id="cb29-19"><a href="#cb29-19" aria-hidden="true" tabindex="-1"></a>                  <span class="at">fill =</span> gender),</span>
<span id="cb29-20"><a href="#cb29-20" aria-hidden="true" tabindex="-1"></a>              <span class="at">alpha =</span> <span class="fl">0.3</span>, <span class="at">linetype =</span> <span class="dv">0</span>) <span class="sc">+</span></span>
<span id="cb29-21"><a href="#cb29-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb29-22"><a href="#cb29-22" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Average Economic Leftism by Exact Age and Gender"</span>,</span>
<span id="cb29-23"><a href="#cb29-23" aria-hidden="true" tabindex="-1"></a>    <span class="at">subtitle =</span> <span class="st">"Survey-weighted means with 95% confidence intervals. Higher scores = more left-wing"</span>,</span>
<span id="cb29-24"><a href="#cb29-24" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"Age (Years)"</span>,</span>
<span id="cb29-25"><a href="#cb29-25" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">"Mean Economic Leftism Score"</span>,</span>
<span id="cb29-26"><a href="#cb29-26" aria-hidden="true" tabindex="-1"></a>    <span class="at">color =</span> <span class="st">"Gender"</span>,</span>
<span id="cb29-27"><a href="#cb29-27" aria-hidden="true" tabindex="-1"></a>    <span class="at">fill =</span> <span class="st">"Gender"</span></span>
<span id="cb29-28"><a href="#cb29-28" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb29-29"><a href="#cb29-29" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb29-30"><a href="#cb29-30" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"male"</span> <span class="ot">=</span> <span class="st">"steelblue"</span>, <span class="st">"female"</span> <span class="ot">=</span> <span class="st">"coral"</span>)) <span class="sc">+</span></span>
<span id="cb29-31"><a href="#cb29-31" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"male"</span> <span class="ot">=</span> <span class="st">"steelblue"</span>, <span class="st">"female"</span> <span class="ot">=</span> <span class="st">"coral"</span>)) <span class="sc">+</span></span>
<span id="cb29-32"><a href="#cb29-32" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"bottom"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="initial_analysis_files/figure-html/unnamed-chunk-8-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:80.0%"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="gender-gap-summary-table" class="level5">
<h5 class="anchored" data-anchor-id="gender-gap-summary-table">Gender Gap Summary Table</h5>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Gender Gap Summary Table using Survey Package</span></span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="st">"=== GENDER GAP SUMMARY TABLE ==="</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "=== GENDER GAP SUMMARY TABLE ==="</code></pre>
</div>
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate survey-weighted means for social conservatism</span></span>
<span id="cb32-2"><a href="#cb32-2" aria-hidden="true" tabindex="-1"></a>social_means_survey <span class="ot">&lt;-</span> <span class="fu">svyby</span>(</span>
<span id="cb32-3"><a href="#cb32-3" aria-hidden="true" tabindex="-1"></a>  <span class="sc">~</span>social_conservatism,</span>
<span id="cb32-4"><a href="#cb32-4" aria-hidden="true" tabindex="-1"></a>  <span class="sc">~</span>age <span class="sc">+</span> gender,</span>
<span id="cb32-5"><a href="#cb32-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">design =</span> survey_design,</span>
<span id="cb32-6"><a href="#cb32-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">FUN =</span> svymean,</span>
<span id="cb32-7"><a href="#cb32-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">na.rm =</span> <span class="cn">TRUE</span></span>
<span id="cb32-8"><a href="#cb32-8" aria-hidden="true" tabindex="-1"></a>) <span class="sc">%&gt;%</span></span>
<span id="cb32-9"><a href="#cb32-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as.data.frame</span>() <span class="sc">%&gt;%</span></span>
<span id="cb32-10"><a href="#cb32-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(age, gender, social_conservatism) <span class="sc">%&gt;%</span></span>
<span id="cb32-11"><a href="#cb32-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_wider</span>(<span class="at">names_from =</span> gender, <span class="at">values_from =</span> social_conservatism, <span class="at">names_prefix =</span> <span class="st">"social_"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb32-12"><a href="#cb32-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">social_gap =</span> social_male <span class="sc">-</span> social_female)</span>
<span id="cb32-13"><a href="#cb32-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-14"><a href="#cb32-14" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate survey-weighted means for economic leftism  </span></span>
<span id="cb32-15"><a href="#cb32-15" aria-hidden="true" tabindex="-1"></a>economic_means_survey <span class="ot">&lt;-</span> <span class="fu">svyby</span>(</span>
<span id="cb32-16"><a href="#cb32-16" aria-hidden="true" tabindex="-1"></a>  <span class="sc">~</span>economic_leftism,</span>
<span id="cb32-17"><a href="#cb32-17" aria-hidden="true" tabindex="-1"></a>  <span class="sc">~</span>age <span class="sc">+</span> gender,</span>
<span id="cb32-18"><a href="#cb32-18" aria-hidden="true" tabindex="-1"></a>  <span class="at">design =</span> survey_design,</span>
<span id="cb32-19"><a href="#cb32-19" aria-hidden="true" tabindex="-1"></a>  <span class="at">FUN =</span> svymean,</span>
<span id="cb32-20"><a href="#cb32-20" aria-hidden="true" tabindex="-1"></a>  <span class="at">na.rm =</span> <span class="cn">TRUE</span></span>
<span id="cb32-21"><a href="#cb32-21" aria-hidden="true" tabindex="-1"></a>) <span class="sc">%&gt;%</span></span>
<span id="cb32-22"><a href="#cb32-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as.data.frame</span>() <span class="sc">%&gt;%</span></span>
<span id="cb32-23"><a href="#cb32-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(age, gender, economic_leftism) <span class="sc">%&gt;%</span></span>
<span id="cb32-24"><a href="#cb32-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_wider</span>(<span class="at">names_from =</span> gender, <span class="at">values_from =</span> economic_leftism, <span class="at">names_prefix =</span> <span class="st">"economic_"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb32-25"><a href="#cb32-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">economic_gap =</span> economic_male <span class="sc">-</span> economic_female)</span>
<span id="cb32-26"><a href="#cb32-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-27"><a href="#cb32-27" aria-hidden="true" tabindex="-1"></a><span class="co"># Statistical significance tests for each age group</span></span>
<span id="cb32-28"><a href="#cb32-28" aria-hidden="true" tabindex="-1"></a>age_groups <span class="ot">&lt;-</span> <span class="fu">unique</span>(uk_data<span class="sc">$</span>age[<span class="sc">!</span><span class="fu">is.na</span>(uk_data<span class="sc">$</span>age)])</span>
<span id="cb32-29"><a href="#cb32-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-30"><a href="#cb32-30" aria-hidden="true" tabindex="-1"></a><span class="co"># Function to perform survey-weighted t-tests</span></span>
<span id="cb32-31"><a href="#cb32-31" aria-hidden="true" tabindex="-1"></a>perform_survey_ttest <span class="ot">&lt;-</span> <span class="cf">function</span>(age_group, variable) {</span>
<span id="cb32-32"><a href="#cb32-32" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Filter data for this age group</span></span>
<span id="cb32-33"><a href="#cb32-33" aria-hidden="true" tabindex="-1"></a>  age_subset <span class="ot">&lt;-</span> uk_data <span class="sc">%&gt;%</span> </span>
<span id="cb32-34"><a href="#cb32-34" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(age <span class="sc">==</span> age_group, <span class="sc">!</span><span class="fu">is.na</span>(<span class="sc">!!</span><span class="fu">sym</span>(variable)), <span class="sc">!</span><span class="fu">is.na</span>(gender))</span>
<span id="cb32-35"><a href="#cb32-35" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb32-36"><a href="#cb32-36" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span>(<span class="fu">nrow</span>(age_subset) <span class="sc">&lt;</span> <span class="dv">10</span>) <span class="fu">return</span>(<span class="fu">list</span>(<span class="at">p_value =</span> <span class="cn">NA</span>, <span class="at">t_stat =</span> <span class="cn">NA</span>))</span>
<span id="cb32-37"><a href="#cb32-37" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb32-38"><a href="#cb32-38" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Create survey design for this subset</span></span>
<span id="cb32-39"><a href="#cb32-39" aria-hidden="true" tabindex="-1"></a>  design_subset <span class="ot">&lt;-</span> <span class="fu">svydesign</span>(</span>
<span id="cb32-40"><a href="#cb32-40" aria-hidden="true" tabindex="-1"></a>    <span class="at">ids =</span> <span class="sc">~</span><span class="dv">1</span>,</span>
<span id="cb32-41"><a href="#cb32-41" aria-hidden="true" tabindex="-1"></a>    <span class="at">weights =</span> <span class="sc">~</span>wt,</span>
<span id="cb32-42"><a href="#cb32-42" aria-hidden="true" tabindex="-1"></a>    <span class="at">data =</span> age_subset</span>
<span id="cb32-43"><a href="#cb32-43" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb32-44"><a href="#cb32-44" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb32-45"><a href="#cb32-45" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Perform t-test comparing male vs female</span></span>
<span id="cb32-46"><a href="#cb32-46" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tryCatch</span>({</span>
<span id="cb32-47"><a href="#cb32-47" aria-hidden="true" tabindex="-1"></a>    test_result <span class="ot">&lt;-</span> <span class="fu">svyttest</span>(<span class="fu">as.formula</span>(<span class="fu">paste</span>(variable, <span class="st">"~ gender"</span>)), design_subset)</span>
<span id="cb32-48"><a href="#cb32-48" aria-hidden="true" tabindex="-1"></a>    <span class="fu">list</span>(<span class="at">p_value =</span> test_result<span class="sc">$</span>p.value, <span class="at">t_stat =</span> test_result<span class="sc">$</span>statistic)</span>
<span id="cb32-49"><a href="#cb32-49" aria-hidden="true" tabindex="-1"></a>  }, <span class="at">error =</span> <span class="cf">function</span>(e) {</span>
<span id="cb32-50"><a href="#cb32-50" aria-hidden="true" tabindex="-1"></a>    <span class="fu">list</span>(<span class="at">p_value =</span> <span class="cn">NA</span>, <span class="at">t_stat =</span> <span class="cn">NA</span>)</span>
<span id="cb32-51"><a href="#cb32-51" aria-hidden="true" tabindex="-1"></a>  })</span>
<span id="cb32-52"><a href="#cb32-52" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb32-53"><a href="#cb32-53" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-54"><a href="#cb32-54" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate significance tests for all age groups</span></span>
<span id="cb32-55"><a href="#cb32-55" aria-hidden="true" tabindex="-1"></a>significance_results <span class="ot">&lt;-</span> <span class="fu">map_dfr</span>(age_groups, <span class="cf">function</span>(age_gr) {</span>
<span id="cb32-56"><a href="#cb32-56" aria-hidden="true" tabindex="-1"></a>  social_test <span class="ot">&lt;-</span> <span class="fu">perform_survey_ttest</span>(age_gr, <span class="st">"social_conservatism"</span>)</span>
<span id="cb32-57"><a href="#cb32-57" aria-hidden="true" tabindex="-1"></a>  economic_test <span class="ot">&lt;-</span> <span class="fu">perform_survey_ttest</span>(age_gr, <span class="st">"economic_leftism"</span>)</span>
<span id="cb32-58"><a href="#cb32-58" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb32-59"><a href="#cb32-59" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tibble</span>(</span>
<span id="cb32-60"><a href="#cb32-60" aria-hidden="true" tabindex="-1"></a>    <span class="at">age =</span> age_gr,</span>
<span id="cb32-61"><a href="#cb32-61" aria-hidden="true" tabindex="-1"></a>    <span class="at">social_p_value =</span> social_test<span class="sc">$</span>p_value,</span>
<span id="cb32-62"><a href="#cb32-62" aria-hidden="true" tabindex="-1"></a>    <span class="at">social_t_stat =</span> social_test<span class="sc">$</span>t_stat,</span>
<span id="cb32-63"><a href="#cb32-63" aria-hidden="true" tabindex="-1"></a>    <span class="at">economic_p_value =</span> economic_test<span class="sc">$</span>p_value,</span>
<span id="cb32-64"><a href="#cb32-64" aria-hidden="true" tabindex="-1"></a>    <span class="at">economic_t_stat =</span> economic_test<span class="sc">$</span>t_stat</span>
<span id="cb32-65"><a href="#cb32-65" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb32-66"><a href="#cb32-66" aria-hidden="true" tabindex="-1"></a>})</span>
<span id="cb32-67"><a href="#cb32-67" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-68"><a href="#cb32-68" aria-hidden="true" tabindex="-1"></a><span class="co"># Combine into final summary table with significance tests</span></span>
<span id="cb32-69"><a href="#cb32-69" aria-hidden="true" tabindex="-1"></a>gender_gap_summary <span class="ot">&lt;-</span> social_means_survey <span class="sc">%&gt;%</span></span>
<span id="cb32-70"><a href="#cb32-70" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(economic_means_survey, <span class="at">by =</span> <span class="st">"age"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb32-71"><a href="#cb32-71" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(significance_results, <span class="at">by =</span> <span class="st">"age"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb32-72"><a href="#cb32-72" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb32-73"><a href="#cb32-73" aria-hidden="true" tabindex="-1"></a>    <span class="at">social_gap =</span> <span class="fu">round</span>(social_gap, <span class="dv">3</span>),</span>
<span id="cb32-74"><a href="#cb32-74" aria-hidden="true" tabindex="-1"></a>    <span class="at">economic_gap =</span> <span class="fu">round</span>(economic_gap, <span class="dv">3</span>),</span>
<span id="cb32-75"><a href="#cb32-75" aria-hidden="true" tabindex="-1"></a>    <span class="at">social_p_value =</span> <span class="fu">round</span>(social_p_value, <span class="dv">4</span>),</span>
<span id="cb32-76"><a href="#cb32-76" aria-hidden="true" tabindex="-1"></a>    <span class="at">economic_p_value =</span> <span class="fu">round</span>(economic_p_value, <span class="dv">4</span>),</span>
<span id="cb32-77"><a href="#cb32-77" aria-hidden="true" tabindex="-1"></a>    <span class="at">social_significant =</span> <span class="fu">case_when</span>(</span>
<span id="cb32-78"><a href="#cb32-78" aria-hidden="true" tabindex="-1"></a>      <span class="fu">is.na</span>(social_p_value) <span class="sc">~</span> <span class="st">"N/A"</span>,</span>
<span id="cb32-79"><a href="#cb32-79" aria-hidden="true" tabindex="-1"></a>      social_p_value <span class="sc">&lt;</span> <span class="fl">0.001</span> <span class="sc">~</span> <span class="st">"***"</span>,</span>
<span id="cb32-80"><a href="#cb32-80" aria-hidden="true" tabindex="-1"></a>      social_p_value <span class="sc">&lt;</span> <span class="fl">0.01</span> <span class="sc">~</span> <span class="st">"**"</span>, </span>
<span id="cb32-81"><a href="#cb32-81" aria-hidden="true" tabindex="-1"></a>      social_p_value <span class="sc">&lt;</span> <span class="fl">0.05</span> <span class="sc">~</span> <span class="st">"*"</span>,</span>
<span id="cb32-82"><a href="#cb32-82" aria-hidden="true" tabindex="-1"></a>      social_p_value <span class="sc">&lt;</span> <span class="fl">0.1</span> <span class="sc">~</span> <span class="st">"."</span>,</span>
<span id="cb32-83"><a href="#cb32-83" aria-hidden="true" tabindex="-1"></a>      <span class="cn">TRUE</span> <span class="sc">~</span> <span class="st">""</span></span>
<span id="cb32-84"><a href="#cb32-84" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb32-85"><a href="#cb32-85" aria-hidden="true" tabindex="-1"></a>    <span class="at">economic_significant =</span> <span class="fu">case_when</span>(</span>
<span id="cb32-86"><a href="#cb32-86" aria-hidden="true" tabindex="-1"></a>      <span class="fu">is.na</span>(economic_p_value) <span class="sc">~</span> <span class="st">"N/A"</span>,</span>
<span id="cb32-87"><a href="#cb32-87" aria-hidden="true" tabindex="-1"></a>      economic_p_value <span class="sc">&lt;</span> <span class="fl">0.001</span> <span class="sc">~</span> <span class="st">"***"</span>,</span>
<span id="cb32-88"><a href="#cb32-88" aria-hidden="true" tabindex="-1"></a>      economic_p_value <span class="sc">&lt;</span> <span class="fl">0.01</span> <span class="sc">~</span> <span class="st">"**"</span>,</span>
<span id="cb32-89"><a href="#cb32-89" aria-hidden="true" tabindex="-1"></a>      economic_p_value <span class="sc">&lt;</span> <span class="fl">0.05</span> <span class="sc">~</span> <span class="st">"*"</span>, </span>
<span id="cb32-90"><a href="#cb32-90" aria-hidden="true" tabindex="-1"></a>      economic_p_value <span class="sc">&lt;</span> <span class="fl">0.1</span> <span class="sc">~</span> <span class="st">"."</span>,</span>
<span id="cb32-91"><a href="#cb32-91" aria-hidden="true" tabindex="-1"></a>      <span class="cn">TRUE</span> <span class="sc">~</span> <span class="st">""</span></span>
<span id="cb32-92"><a href="#cb32-92" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb32-93"><a href="#cb32-93" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb32-94"><a href="#cb32-94" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(age, social_gap, social_p_value, social_significant, </span>
<span id="cb32-95"><a href="#cb32-95" aria-hidden="true" tabindex="-1"></a>         economic_gap, economic_p_value, economic_significant) <span class="sc">%&gt;%</span></span>
<span id="cb32-96"><a href="#cb32-96" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(age)</span>
<span id="cb32-97"><a href="#cb32-97" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-98"><a href="#cb32-98" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(gender_gap_summary)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 7 × 7
  age      social_gap social_p_value social_significant economic_gap
  &lt;chr&gt;         &lt;dbl&gt;          &lt;dbl&gt; &lt;chr&gt;                     &lt;dbl&gt;
1 18_TO_24      0.059         0      "***"                    -0.068
2 25_TO_34      0.04          0.0002 "***"                    -0.029
3 35_TO_44      0.027         0.0134 "*"                       0.016
4 45_TO_54     -0.037         0.0008 "***"                     0.031
5 55_TO_64     -0.058         0      "***"                     0.039
6 65_TO_74     -0.029         0.0228 "*"                       0.051
7 75_PLUS      -0.007         0.744  ""                       -0.007
# ℹ 2 more variables: economic_p_value &lt;dbl&gt;, economic_significant &lt;chr&gt;</code></pre>
</div>
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">Significance codes: *** p&lt;0.001, ** p&lt;0.01, * p&lt;0.05, . p&lt;0.1</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Significance codes: *** p&lt;0.001, ** p&lt;0.01, * p&lt;0.05, . p&lt;0.1</code></pre>
</div>
</div>
<p>In the above, <strong>a positive gap indicates that males score higher than females on that dimension</strong>.</p>
<p>The exists gap amongst younger age groups is statistically significant. It exits for both genders. Young men are more socially conservative than young women. Young men are also more economically right wing than young women. The gap narrows with age.</p>
<p>Now we’ll drill down into more specific issue areas. These can inform PR, targeting and communication strategy for the FTSE company.</p>
</section>
<section id="specific-issue-divergence-by-gender-and-age-groups" class="level5">
<h5 class="anchored" data-anchor-id="specific-issue-divergence-by-gender-and-age-groups">Specific issue divergence by gender and age groups</h5>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Individual Question Gender Gap Analysis - Overall Rankings</span></span>
<span id="cb36-2"><a href="#cb36-2" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="st">"=== INDIVIDUAL QUESTION GENDER GAPS (OVERALL) ==="</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "=== INDIVIDUAL QUESTION GENDER GAPS (OVERALL) ==="</code></pre>
</div>
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Define all individual attitude questions with descriptions</span></span>
<span id="cb38-2"><a href="#cb38-2" aria-hidden="true" tabindex="-1"></a>attitude_questions <span class="ot">&lt;-</span> <span class="fu">list</span>(</span>
<span id="cb38-3"><a href="#cb38-3" aria-hidden="true" tabindex="-1"></a>  <span class="st">"soc_respect"</span> <span class="ot">=</span> <span class="st">"Young people don't have enough respect for traditional British values"</span>,</span>
<span id="cb38-4"><a href="#cb38-4" aria-hidden="true" tabindex="-1"></a>  <span class="st">"soc_deathpen"</span> <span class="ot">=</span> <span class="st">"Death penalty is most appropriate for some crimes"</span>, </span>
<span id="cb38-5"><a href="#cb38-5" aria-hidden="true" tabindex="-1"></a>  <span class="st">"soc_schools"</span> <span class="ot">=</span> <span class="st">"Schools should teach children to obey authority"</span>,</span>
<span id="cb38-6"><a href="#cb38-6" aria-hidden="true" tabindex="-1"></a>  <span class="st">"soc_censor"</span> <span class="ot">=</span> <span class="st">"Censorship necessary to uphold moral standards"</span>,</span>
<span id="cb38-7"><a href="#cb38-7" aria-hidden="true" tabindex="-1"></a>  <span class="st">"soc_punish"</span> <span class="ot">=</span> <span class="st">"Law breakers should get stiffer sentences"</span>,</span>
<span id="cb38-8"><a href="#cb38-8" aria-hidden="true" tabindex="-1"></a>  <span class="st">"econ_redist"</span> <span class="ot">=</span> <span class="st">"Government should redistribute from better off to less well off"</span>,</span>
<span id="cb38-9"><a href="#cb38-9" aria-hidden="true" tabindex="-1"></a>  <span class="st">"econ_bigbiz"</span> <span class="ot">=</span> <span class="st">"Big business take advantage of ordinary people"</span>,</span>
<span id="cb38-10"><a href="#cb38-10" aria-hidden="true" tabindex="-1"></a>  <span class="st">"econ_unfair"</span> <span class="ot">=</span> <span class="st">"Ordinary people do not get fair share of nation's wealth"</span>, </span>
<span id="cb38-11"><a href="#cb38-11" aria-hidden="true" tabindex="-1"></a>  <span class="st">"econ_onelaw"</span> <span class="ot">=</span> <span class="st">"One law for rich, another for poor"</span>,</span>
<span id="cb38-12"><a href="#cb38-12" aria-hidden="true" tabindex="-1"></a>  <span class="st">"econ_exploit"</span> <span class="ot">=</span> <span class="st">"Management will always try to get better of employees"</span></span>
<span id="cb38-13"><a href="#cb38-13" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb38-14"><a href="#cb38-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-15"><a href="#cb38-15" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate overall gender gaps for each individual question with significance tests</span></span>
<span id="cb38-16"><a href="#cb38-16" aria-hidden="true" tabindex="-1"></a>individual_gaps_overall <span class="ot">&lt;-</span> <span class="fu">map_dfr</span>(<span class="fu">names</span>(attitude_questions), <span class="cf">function</span>(var) {</span>
<span id="cb38-17"><a href="#cb38-17" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Filter data for this question</span></span>
<span id="cb38-18"><a href="#cb38-18" aria-hidden="true" tabindex="-1"></a>  question_data <span class="ot">&lt;-</span> uk_data <span class="sc">%&gt;%</span> <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(<span class="sc">!!</span><span class="fu">sym</span>(var)), <span class="sc">!</span><span class="fu">is.na</span>(gender))</span>
<span id="cb38-19"><a href="#cb38-19" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb38-20"><a href="#cb38-20" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Create survey design</span></span>
<span id="cb38-21"><a href="#cb38-21" aria-hidden="true" tabindex="-1"></a>  design_question <span class="ot">&lt;-</span> <span class="fu">svydesign</span>(<span class="at">ids =</span> <span class="sc">~</span><span class="dv">1</span>, <span class="at">weights =</span> <span class="sc">~</span>wt, <span class="at">data =</span> question_data)</span>
<span id="cb38-22"><a href="#cb38-22" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb38-23"><a href="#cb38-23" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Calculate survey-weighted means by gender</span></span>
<span id="cb38-24"><a href="#cb38-24" aria-hidden="true" tabindex="-1"></a>  means_by_gender <span class="ot">&lt;-</span> <span class="fu">svyby</span>(</span>
<span id="cb38-25"><a href="#cb38-25" aria-hidden="true" tabindex="-1"></a>    <span class="fu">as.formula</span>(<span class="fu">paste</span>(<span class="st">"~"</span>, var)),</span>
<span id="cb38-26"><a href="#cb38-26" aria-hidden="true" tabindex="-1"></a>    <span class="sc">~</span>gender,</span>
<span id="cb38-27"><a href="#cb38-27" aria-hidden="true" tabindex="-1"></a>    <span class="at">design =</span> design_question,</span>
<span id="cb38-28"><a href="#cb38-28" aria-hidden="true" tabindex="-1"></a>    <span class="at">FUN =</span> svymean,</span>
<span id="cb38-29"><a href="#cb38-29" aria-hidden="true" tabindex="-1"></a>    <span class="at">na.rm =</span> <span class="cn">TRUE</span></span>
<span id="cb38-30"><a href="#cb38-30" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb38-31"><a href="#cb38-31" aria-hidden="true" tabindex="-1"></a>    <span class="fu">as.data.frame</span>()</span>
<span id="cb38-32"><a href="#cb38-32" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb38-33"><a href="#cb38-33" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Perform survey-weighted t-test</span></span>
<span id="cb38-34"><a href="#cb38-34" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tryCatch</span>({</span>
<span id="cb38-35"><a href="#cb38-35" aria-hidden="true" tabindex="-1"></a>    ttest_result <span class="ot">&lt;-</span> <span class="fu">svyttest</span>(<span class="fu">as.formula</span>(<span class="fu">paste</span>(var, <span class="st">"~ gender"</span>)), design_question)</span>
<span id="cb38-36"><a href="#cb38-36" aria-hidden="true" tabindex="-1"></a>    p_value <span class="ot">&lt;-</span> ttest_result<span class="sc">$</span>p.value</span>
<span id="cb38-37"><a href="#cb38-37" aria-hidden="true" tabindex="-1"></a>    t_stat <span class="ot">&lt;-</span> ttest_result<span class="sc">$</span>statistic</span>
<span id="cb38-38"><a href="#cb38-38" aria-hidden="true" tabindex="-1"></a>  }, <span class="at">error =</span> <span class="cf">function</span>(e) {</span>
<span id="cb38-39"><a href="#cb38-39" aria-hidden="true" tabindex="-1"></a>    p_value <span class="ot">&lt;-</span> <span class="cn">NA</span></span>
<span id="cb38-40"><a href="#cb38-40" aria-hidden="true" tabindex="-1"></a>    t_stat <span class="ot">&lt;-</span> <span class="cn">NA</span></span>
<span id="cb38-41"><a href="#cb38-41" aria-hidden="true" tabindex="-1"></a>  })</span>
<span id="cb38-42"><a href="#cb38-42" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb38-43"><a href="#cb38-43" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Extract male and female means</span></span>
<span id="cb38-44"><a href="#cb38-44" aria-hidden="true" tabindex="-1"></a>  male_mean <span class="ot">&lt;-</span> means_by_gender[means_by_gender<span class="sc">$</span>gender <span class="sc">==</span> <span class="st">"male"</span>, var]</span>
<span id="cb38-45"><a href="#cb38-45" aria-hidden="true" tabindex="-1"></a>  female_mean <span class="ot">&lt;-</span> means_by_gender[means_by_gender<span class="sc">$</span>gender <span class="sc">==</span> <span class="st">"female"</span>, var]</span>
<span id="cb38-46"><a href="#cb38-46" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb38-47"><a href="#cb38-47" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Calculate gap and significance</span></span>
<span id="cb38-48"><a href="#cb38-48" aria-hidden="true" tabindex="-1"></a>  gender_gap <span class="ot">&lt;-</span> male_mean <span class="sc">-</span> female_mean</span>
<span id="cb38-49"><a href="#cb38-49" aria-hidden="true" tabindex="-1"></a>  significance <span class="ot">&lt;-</span> <span class="fu">case_when</span>(</span>
<span id="cb38-50"><a href="#cb38-50" aria-hidden="true" tabindex="-1"></a>    <span class="fu">is.na</span>(p_value) <span class="sc">~</span> <span class="st">"N/A"</span>,</span>
<span id="cb38-51"><a href="#cb38-51" aria-hidden="true" tabindex="-1"></a>    p_value <span class="sc">&lt;</span> <span class="fl">0.001</span> <span class="sc">~</span> <span class="st">"***"</span>,</span>
<span id="cb38-52"><a href="#cb38-52" aria-hidden="true" tabindex="-1"></a>    p_value <span class="sc">&lt;</span> <span class="fl">0.01</span> <span class="sc">~</span> <span class="st">"**"</span>,</span>
<span id="cb38-53"><a href="#cb38-53" aria-hidden="true" tabindex="-1"></a>    p_value <span class="sc">&lt;</span> <span class="fl">0.05</span> <span class="sc">~</span> <span class="st">"*"</span>,</span>
<span id="cb38-54"><a href="#cb38-54" aria-hidden="true" tabindex="-1"></a>    p_value <span class="sc">&lt;</span> <span class="fl">0.1</span> <span class="sc">~</span> <span class="st">"."</span>,</span>
<span id="cb38-55"><a href="#cb38-55" aria-hidden="true" tabindex="-1"></a>    <span class="cn">TRUE</span> <span class="sc">~</span> <span class="st">""</span></span>
<span id="cb38-56"><a href="#cb38-56" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb38-57"><a href="#cb38-57" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb38-58"><a href="#cb38-58" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Create result</span></span>
<span id="cb38-59"><a href="#cb38-59" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tibble</span>(</span>
<span id="cb38-60"><a href="#cb38-60" aria-hidden="true" tabindex="-1"></a>    <span class="at">question =</span> var,</span>
<span id="cb38-61"><a href="#cb38-61" aria-hidden="true" tabindex="-1"></a>    <span class="at">description =</span> attitude_questions[[var]],</span>
<span id="cb38-62"><a href="#cb38-62" aria-hidden="true" tabindex="-1"></a>    <span class="at">male_mean =</span> <span class="fu">round</span>(male_mean, <span class="dv">3</span>),</span>
<span id="cb38-63"><a href="#cb38-63" aria-hidden="true" tabindex="-1"></a>    <span class="at">female_mean =</span> <span class="fu">round</span>(female_mean, <span class="dv">3</span>),</span>
<span id="cb38-64"><a href="#cb38-64" aria-hidden="true" tabindex="-1"></a>    <span class="at">gender_gap =</span> <span class="fu">round</span>(gender_gap, <span class="dv">3</span>),</span>
<span id="cb38-65"><a href="#cb38-65" aria-hidden="true" tabindex="-1"></a>    <span class="at">p_value =</span> <span class="fu">round</span>(p_value, <span class="dv">4</span>),</span>
<span id="cb38-66"><a href="#cb38-66" aria-hidden="true" tabindex="-1"></a>    <span class="at">significance =</span> significance,</span>
<span id="cb38-67"><a href="#cb38-67" aria-hidden="true" tabindex="-1"></a>    <span class="at">gap_magnitude =</span> <span class="fu">abs</span>(gender_gap)</span>
<span id="cb38-68"><a href="#cb38-68" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb38-69"><a href="#cb38-69" aria-hidden="true" tabindex="-1"></a>}) <span class="sc">%&gt;%</span></span>
<span id="cb38-70"><a href="#cb38-70" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(gap_magnitude))</span>
<span id="cb38-71"><a href="#cb38-71" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-72"><a href="#cb38-72" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(individual_gaps_overall)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 10 × 8
   question    description male_mean female_mean gender_gap p_value significance
   &lt;chr&gt;       &lt;chr&gt;           &lt;dbl&gt;       &lt;dbl&gt;      &lt;dbl&gt;   &lt;dbl&gt; &lt;chr&gt;       
 1 soc_censor  Censorship…     0.139       0.266     -0.127  0      ***         
 2 soc_deathp… Death pena…     0.248       0.179      0.069  0      ***         
 3 soc_schools Schools sh…     0.424       0.364      0.06   0      ***         
 4 soc_respect Young peop…     0.41        0.354      0.056  0      ***         
 5 econ_onelaw One law fo…     0.43        0.471     -0.041  0      ***         
 6 econ_explo… Management…     0.396       0.358      0.038  0      ***         
 7 econ_unfair Ordinary p…     0.414       0.45      -0.035  0      ***         
 8 soc_punish  Law breake…     0.47        0.482     -0.013  0.0279 *           
 9 econ_redist Government…     0.284       0.271      0.013  0.0793 .           
10 econ_bigbiz Big busine…     0.456       0.444      0.013  0.0375 *           
# ℹ 1 more variable: gap_magnitude &lt;dbl&gt;</code></pre>
</div>
<div class="sourceCode cell-code" id="cb40"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">Significance codes: *** p&lt;0.001, ** p&lt;0.01, * p&lt;0.05, . p&lt;0.1</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Significance codes: *** p&lt;0.001, ** p&lt;0.01, * p&lt;0.05, . p&lt;0.1</code></pre>
</div>
</div>
<p>If we examine gender gaps across all ages, some notable trends emerge.</p>
<p>Censorship observed as the strongest point of disagreement, with women being 0.127 points higher on the agreement scale on average. Followed by the death penalty, where men are 0.069 points higher on the agreement scale.</p>
<p>Areas of issue agreement skew towards economic issues, such as government redistribution and predatory big business perceptions. Notably, stances on stiffer punishment sentences are fairly similar across genders.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb42"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Age-Stratified Individual Question Analysis</span></span>
<span id="cb42-2"><a href="#cb42-2" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="st">"=== INDIVIDUAL QUESTION GENDER GAPS BY AGE GROUP ==="</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "=== INDIVIDUAL QUESTION GENDER GAPS BY AGE GROUP ==="</code></pre>
</div>
<div class="sourceCode cell-code" id="cb44"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate gender gaps for each question within each age group with significance tests</span></span>
<span id="cb44-2"><a href="#cb44-2" aria-hidden="true" tabindex="-1"></a>individual_gaps_by_age <span class="ot">&lt;-</span> <span class="fu">map_dfr</span>(<span class="fu">names</span>(attitude_questions), <span class="cf">function</span>(var) {</span>
<span id="cb44-3"><a href="#cb44-3" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Get unique age groups</span></span>
<span id="cb44-4"><a href="#cb44-4" aria-hidden="true" tabindex="-1"></a>  age_groups <span class="ot">&lt;-</span> <span class="fu">unique</span>(uk_data<span class="sc">$</span>age[<span class="sc">!</span><span class="fu">is.na</span>(uk_data<span class="sc">$</span>age)])</span>
<span id="cb44-5"><a href="#cb44-5" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb44-6"><a href="#cb44-6" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Calculate for each age group</span></span>
<span id="cb44-7"><a href="#cb44-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">map_dfr</span>(age_groups, <span class="cf">function</span>(age_gr) {</span>
<span id="cb44-8"><a href="#cb44-8" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Filter data for this age group and question</span></span>
<span id="cb44-9"><a href="#cb44-9" aria-hidden="true" tabindex="-1"></a>    age_data <span class="ot">&lt;-</span> uk_data <span class="sc">%&gt;%</span> </span>
<span id="cb44-10"><a href="#cb44-10" aria-hidden="true" tabindex="-1"></a>      <span class="fu">filter</span>(age <span class="sc">==</span> age_gr, <span class="sc">!</span><span class="fu">is.na</span>(<span class="sc">!!</span><span class="fu">sym</span>(var)), <span class="sc">!</span><span class="fu">is.na</span>(gender))</span>
<span id="cb44-11"><a href="#cb44-11" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb44-12"><a href="#cb44-12" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span>(<span class="fu">nrow</span>(age_data) <span class="sc">&lt;</span> <span class="dv">20</span>) {</span>
<span id="cb44-13"><a href="#cb44-13" aria-hidden="true" tabindex="-1"></a>      <span class="fu">return</span>(<span class="fu">tibble</span>(</span>
<span id="cb44-14"><a href="#cb44-14" aria-hidden="true" tabindex="-1"></a>        <span class="at">question =</span> var,</span>
<span id="cb44-15"><a href="#cb44-15" aria-hidden="true" tabindex="-1"></a>        <span class="at">age =</span> age_gr, </span>
<span id="cb44-16"><a href="#cb44-16" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_mean =</span> <span class="cn">NA</span>,</span>
<span id="cb44-17"><a href="#cb44-17" aria-hidden="true" tabindex="-1"></a>        <span class="at">female_mean =</span> <span class="cn">NA</span>,</span>
<span id="cb44-18"><a href="#cb44-18" aria-hidden="true" tabindex="-1"></a>        <span class="at">gender_gap =</span> <span class="cn">NA</span>,</span>
<span id="cb44-19"><a href="#cb44-19" aria-hidden="true" tabindex="-1"></a>        <span class="at">p_value =</span> <span class="cn">NA</span>,</span>
<span id="cb44-20"><a href="#cb44-20" aria-hidden="true" tabindex="-1"></a>        <span class="at">significance =</span> <span class="st">"N/A"</span></span>
<span id="cb44-21"><a href="#cb44-21" aria-hidden="true" tabindex="-1"></a>      ))</span>
<span id="cb44-22"><a href="#cb44-22" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb44-23"><a href="#cb44-23" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb44-24"><a href="#cb44-24" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Create survey design for this subset</span></span>
<span id="cb44-25"><a href="#cb44-25" aria-hidden="true" tabindex="-1"></a>    design_subset <span class="ot">&lt;-</span> <span class="fu">svydesign</span>(<span class="at">ids =</span> <span class="sc">~</span><span class="dv">1</span>, <span class="at">weights =</span> <span class="sc">~</span>wt, <span class="at">data =</span> age_data)</span>
<span id="cb44-26"><a href="#cb44-26" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb44-27"><a href="#cb44-27" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Calculate means by gender</span></span>
<span id="cb44-28"><a href="#cb44-28" aria-hidden="true" tabindex="-1"></a>    means_by_gender <span class="ot">&lt;-</span> <span class="fu">svyby</span>(</span>
<span id="cb44-29"><a href="#cb44-29" aria-hidden="true" tabindex="-1"></a>      <span class="fu">as.formula</span>(<span class="fu">paste</span>(<span class="st">"~"</span>, var)),</span>
<span id="cb44-30"><a href="#cb44-30" aria-hidden="true" tabindex="-1"></a>      <span class="sc">~</span>gender,</span>
<span id="cb44-31"><a href="#cb44-31" aria-hidden="true" tabindex="-1"></a>      <span class="at">design =</span> design_subset,</span>
<span id="cb44-32"><a href="#cb44-32" aria-hidden="true" tabindex="-1"></a>      <span class="at">FUN =</span> svymean,</span>
<span id="cb44-33"><a href="#cb44-33" aria-hidden="true" tabindex="-1"></a>      <span class="at">na.rm =</span> <span class="cn">TRUE</span></span>
<span id="cb44-34"><a href="#cb44-34" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">%&gt;%</span></span>
<span id="cb44-35"><a href="#cb44-35" aria-hidden="true" tabindex="-1"></a>      <span class="fu">as.data.frame</span>()</span>
<span id="cb44-36"><a href="#cb44-36" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb44-37"><a href="#cb44-37" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Perform survey-weighted t-test</span></span>
<span id="cb44-38"><a href="#cb44-38" aria-hidden="true" tabindex="-1"></a>    <span class="fu">tryCatch</span>({</span>
<span id="cb44-39"><a href="#cb44-39" aria-hidden="true" tabindex="-1"></a>      ttest_result <span class="ot">&lt;-</span> <span class="fu">svyttest</span>(<span class="fu">as.formula</span>(<span class="fu">paste</span>(var, <span class="st">"~ gender"</span>)), design_subset)</span>
<span id="cb44-40"><a href="#cb44-40" aria-hidden="true" tabindex="-1"></a>      p_value <span class="ot">&lt;-</span> ttest_result<span class="sc">$</span>p.value</span>
<span id="cb44-41"><a href="#cb44-41" aria-hidden="true" tabindex="-1"></a>    }, <span class="at">error =</span> <span class="cf">function</span>(e) {</span>
<span id="cb44-42"><a href="#cb44-42" aria-hidden="true" tabindex="-1"></a>      p_value <span class="ot">&lt;-</span> <span class="cn">NA</span></span>
<span id="cb44-43"><a href="#cb44-43" aria-hidden="true" tabindex="-1"></a>    })</span>
<span id="cb44-44"><a href="#cb44-44" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb44-45"><a href="#cb44-45" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Extract means and calculate gap</span></span>
<span id="cb44-46"><a href="#cb44-46" aria-hidden="true" tabindex="-1"></a>    male_mean <span class="ot">&lt;-</span> means_by_gender[means_by_gender<span class="sc">$</span>gender <span class="sc">==</span> <span class="st">"male"</span>, var]</span>
<span id="cb44-47"><a href="#cb44-47" aria-hidden="true" tabindex="-1"></a>    female_mean <span class="ot">&lt;-</span> means_by_gender[means_by_gender<span class="sc">$</span>gender <span class="sc">==</span> <span class="st">"female"</span>, var]</span>
<span id="cb44-48"><a href="#cb44-48" aria-hidden="true" tabindex="-1"></a>    gender_gap <span class="ot">&lt;-</span> male_mean <span class="sc">-</span> female_mean</span>
<span id="cb44-49"><a href="#cb44-49" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb44-50"><a href="#cb44-50" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Calculate significance</span></span>
<span id="cb44-51"><a href="#cb44-51" aria-hidden="true" tabindex="-1"></a>    significance <span class="ot">&lt;-</span> <span class="fu">case_when</span>(</span>
<span id="cb44-52"><a href="#cb44-52" aria-hidden="true" tabindex="-1"></a>      <span class="fu">is.na</span>(p_value) <span class="sc">~</span> <span class="st">"N/A"</span>,</span>
<span id="cb44-53"><a href="#cb44-53" aria-hidden="true" tabindex="-1"></a>      p_value <span class="sc">&lt;</span> <span class="fl">0.001</span> <span class="sc">~</span> <span class="st">"***"</span>,</span>
<span id="cb44-54"><a href="#cb44-54" aria-hidden="true" tabindex="-1"></a>      p_value <span class="sc">&lt;</span> <span class="fl">0.01</span> <span class="sc">~</span> <span class="st">"**"</span>,</span>
<span id="cb44-55"><a href="#cb44-55" aria-hidden="true" tabindex="-1"></a>      p_value <span class="sc">&lt;</span> <span class="fl">0.05</span> <span class="sc">~</span> <span class="st">"*"</span>,</span>
<span id="cb44-56"><a href="#cb44-56" aria-hidden="true" tabindex="-1"></a>      p_value <span class="sc">&lt;</span> <span class="fl">0.1</span> <span class="sc">~</span> <span class="st">"."</span>,</span>
<span id="cb44-57"><a href="#cb44-57" aria-hidden="true" tabindex="-1"></a>      <span class="cn">TRUE</span> <span class="sc">~</span> <span class="st">""</span></span>
<span id="cb44-58"><a href="#cb44-58" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb44-59"><a href="#cb44-59" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb44-60"><a href="#cb44-60" aria-hidden="true" tabindex="-1"></a>    <span class="fu">tibble</span>(</span>
<span id="cb44-61"><a href="#cb44-61" aria-hidden="true" tabindex="-1"></a>      <span class="at">question =</span> var,</span>
<span id="cb44-62"><a href="#cb44-62" aria-hidden="true" tabindex="-1"></a>      <span class="at">age =</span> age_gr,</span>
<span id="cb44-63"><a href="#cb44-63" aria-hidden="true" tabindex="-1"></a>      <span class="at">male_mean =</span> <span class="fu">round</span>(male_mean, <span class="dv">3</span>),</span>
<span id="cb44-64"><a href="#cb44-64" aria-hidden="true" tabindex="-1"></a>      <span class="at">female_mean =</span> <span class="fu">round</span>(female_mean, <span class="dv">3</span>), </span>
<span id="cb44-65"><a href="#cb44-65" aria-hidden="true" tabindex="-1"></a>      <span class="at">gender_gap =</span> <span class="fu">round</span>(gender_gap, <span class="dv">3</span>),</span>
<span id="cb44-66"><a href="#cb44-66" aria-hidden="true" tabindex="-1"></a>      <span class="at">p_value =</span> <span class="fu">round</span>(p_value, <span class="dv">4</span>),</span>
<span id="cb44-67"><a href="#cb44-67" aria-hidden="true" tabindex="-1"></a>      <span class="at">significance =</span> significance</span>
<span id="cb44-68"><a href="#cb44-68" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb44-69"><a href="#cb44-69" aria-hidden="true" tabindex="-1"></a>  })</span>
<span id="cb44-70"><a href="#cb44-70" aria-hidden="true" tabindex="-1"></a>})</span>
<span id="cb44-71"><a href="#cb44-71" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-72"><a href="#cb44-72" aria-hidden="true" tabindex="-1"></a><span class="co"># Create wide format tables with significance information</span></span>
<span id="cb44-73"><a href="#cb44-73" aria-hidden="true" tabindex="-1"></a>gaps_wide <span class="ot">&lt;-</span> individual_gaps_by_age <span class="sc">%&gt;%</span></span>
<span id="cb44-74"><a href="#cb44-74" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(</span>
<span id="cb44-75"><a href="#cb44-75" aria-hidden="true" tabindex="-1"></a>    <span class="fu">tibble</span>(<span class="at">question =</span> <span class="fu">names</span>(attitude_questions), </span>
<span id="cb44-76"><a href="#cb44-76" aria-hidden="true" tabindex="-1"></a>           <span class="at">description =</span> <span class="fu">unlist</span>(attitude_questions)), </span>
<span id="cb44-77"><a href="#cb44-77" aria-hidden="true" tabindex="-1"></a>    <span class="at">by =</span> <span class="st">"question"</span></span>
<span id="cb44-78"><a href="#cb44-78" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb44-79"><a href="#cb44-79" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(question, description, age, gender_gap, significance) <span class="sc">%&gt;%</span></span>
<span id="cb44-80"><a href="#cb44-80" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">gap_with_sig =</span> <span class="fu">paste0</span>(<span class="fu">round</span>(gender_gap, <span class="dv">3</span>), significance)) <span class="sc">%&gt;%</span></span>
<span id="cb44-81"><a href="#cb44-81" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span>gender_gap, <span class="sc">-</span>significance) <span class="sc">%&gt;%</span></span>
<span id="cb44-82"><a href="#cb44-82" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_wider</span>(<span class="at">names_from =</span> age, <span class="at">values_from =</span> gap_with_sig, <span class="at">names_prefix =</span> <span class="st">"gap_"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb44-83"><a href="#cb44-83" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(question)</span>
<span id="cb44-84"><a href="#cb44-84" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-85"><a href="#cb44-85" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(gaps_wide)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 10 × 9
   question     description  gap_25_TO_34 gap_18_TO_24 gap_55_TO_64 gap_35_TO_44
   &lt;chr&gt;        &lt;chr&gt;        &lt;chr&gt;        &lt;chr&gt;        &lt;chr&gt;        &lt;chr&gt;       
 1 econ_bigbiz  Big busines… -0.018       -0.069***    0.062***     0.037**     
 2 econ_exploit Management … 0.015        -0.033.      0.081***     0.066***    
 3 econ_onelaw  One law for… -0.103***    -0.117***    -0.006       -0.028.     
 4 econ_redist  Government … 0.026.       -0.026       0.043*       0.037**     
 5 econ_unfair  Ordinary pe… -0.061***    -0.111***    0.011        -0.028*     
 6 soc_censor   Censorship … 0.004        0.016        -0.255***    -0.043**    
 7 soc_deathpen Death penal… 0.065***     0.076**      0.006        0.066***    
 8 soc_punish   Law breaker… -0.009       0.023        -0.046***    -0.029*     
 9 soc_respect  Young peopl… 0.085***     0.14***      -0.01        0.047**     
10 soc_schools  Schools sho… 0.062***     0.05*        0.019        0.092***    
# ℹ 3 more variables: gap_65_TO_74 &lt;chr&gt;, gap_75_PLUS &lt;chr&gt;, gap_45_TO_54 &lt;chr&gt;</code></pre>
</div>
<div class="sourceCode cell-code" id="cb46"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb46-1"><a href="#cb46-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Show detailed results with significance for largest gaps by age group</span></span>
<span id="cb46-2"><a href="#cb46-2" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">=== LARGEST GENDER GAPS BY AGE GROUP (with significance) ==="</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "\n=== LARGEST GENDER GAPS BY AGE GROUP (with significance) ==="</code></pre>
</div>
<div class="sourceCode cell-code" id="cb48"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb48-1"><a href="#cb48-1" aria-hidden="true" tabindex="-1"></a>largest_gaps_by_age <span class="ot">&lt;-</span> individual_gaps_by_age <span class="sc">%&gt;%</span></span>
<span id="cb48-2"><a href="#cb48-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(gender_gap)) <span class="sc">%&gt;%</span></span>
<span id="cb48-3"><a href="#cb48-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(age) <span class="sc">%&gt;%</span></span>
<span id="cb48-4"><a href="#cb48-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">slice_max</span>(<span class="fu">abs</span>(gender_gap), <span class="at">n =</span> <span class="dv">4</span>) <span class="sc">%&gt;%</span></span>
<span id="cb48-5"><a href="#cb48-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(</span>
<span id="cb48-6"><a href="#cb48-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">tibble</span>(<span class="at">question =</span> <span class="fu">names</span>(attitude_questions), </span>
<span id="cb48-7"><a href="#cb48-7" aria-hidden="true" tabindex="-1"></a>           <span class="at">description =</span> <span class="fu">unlist</span>(attitude_questions)), </span>
<span id="cb48-8"><a href="#cb48-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">by =</span> <span class="st">"question"</span></span>
<span id="cb48-9"><a href="#cb48-9" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb48-10"><a href="#cb48-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(age, question, description, gender_gap, p_value, significance) <span class="sc">%&gt;%</span></span>
<span id="cb48-11"><a href="#cb48-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(age, <span class="fu">desc</span>(<span class="fu">abs</span>(gender_gap)))</span>
<span id="cb48-12"><a href="#cb48-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-13"><a href="#cb48-13" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(largest_gaps_by_age)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 28 × 6
# Groups:   age [7]
   age      question     description             gender_gap p_value significance
   &lt;chr&gt;    &lt;chr&gt;        &lt;chr&gt;                        &lt;dbl&gt;   &lt;dbl&gt; &lt;chr&gt;       
 1 18_TO_24 soc_respect  Young people don't hav…      0.14   0      ***         
 2 18_TO_24 econ_onelaw  One law for rich, anot…     -0.117  0      ***         
 3 18_TO_24 econ_unfair  Ordinary people do not…     -0.111  0      ***         
 4 18_TO_24 soc_deathpen Death penalty is most …      0.076  0.0011 **          
 5 25_TO_34 econ_onelaw  One law for rich, anot…     -0.103  0      ***         
 6 25_TO_34 soc_respect  Young people don't hav…      0.085  0      ***         
 7 25_TO_34 soc_deathpen Death penalty is most …      0.065  0.0002 ***         
 8 25_TO_34 soc_schools  Schools should teach c…      0.062  0      ***         
 9 35_TO_44 soc_schools  Schools should teach c…      0.092  0      ***         
10 35_TO_44 soc_deathpen Death penalty is most …      0.066  0.0003 ***         
# ℹ 18 more rows</code></pre>
</div>
<div class="sourceCode cell-code" id="cb50"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb50-1"><a href="#cb50-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Summary of significant gaps by age group</span></span>
<span id="cb50-2"><a href="#cb50-2" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">=== SIGNIFICANT GAPS SUMMARY BY AGE GROUP ==="</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "\n=== SIGNIFICANT GAPS SUMMARY BY AGE GROUP ==="</code></pre>
</div>
<div class="sourceCode cell-code" id="cb52"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb52-1"><a href="#cb52-1" aria-hidden="true" tabindex="-1"></a>significant_gaps_summary <span class="ot">&lt;-</span> individual_gaps_by_age <span class="sc">%&gt;%</span></span>
<span id="cb52-2"><a href="#cb52-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(p_value), p_value <span class="sc">&lt;</span> <span class="fl">0.05</span>) <span class="sc">%&gt;%</span></span>
<span id="cb52-3"><a href="#cb52-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(age) <span class="sc">%&gt;%</span></span>
<span id="cb52-4"><a href="#cb52-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(</span>
<span id="cb52-5"><a href="#cb52-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">n_significant =</span> <span class="fu">n</span>(),</span>
<span id="cb52-6"><a href="#cb52-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">avg_significant_gap =</span> <span class="fu">round</span>(<span class="fu">mean</span>(<span class="fu">abs</span>(gender_gap)), <span class="dv">3</span>),</span>
<span id="cb52-7"><a href="#cb52-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">largest_gap =</span> <span class="fu">round</span>(<span class="fu">max</span>(<span class="fu">abs</span>(gender_gap)), <span class="dv">3</span>),</span>
<span id="cb52-8"><a href="#cb52-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">.groups =</span> <span class="st">"drop"</span></span>
<span id="cb52-9"><a href="#cb52-9" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb52-10"><a href="#cb52-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(n_significant))</span>
<span id="cb52-11"><a href="#cb52-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-12"><a href="#cb52-12" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(significant_gaps_summary)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 7 × 4
  age      n_significant avg_significant_gap largest_gap
  &lt;chr&gt;            &lt;int&gt;               &lt;dbl&gt;       &lt;dbl&gt;
1 35_TO_44             9               0.049       0.092
2 18_TO_24             6               0.094       0.14 
3 45_TO_54             6               0.076       0.206
4 25_TO_34             5               0.075       0.103
5 55_TO_64             5               0.097       0.255
6 65_TO_74             5               0.126       0.277
7 75_PLUS              3               0.145       0.246</code></pre>
</div>
<div class="sourceCode cell-code" id="cb54"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb54-1"><a href="#cb54-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">Significance codes: *** p&lt;0.001, ** p&lt;0.01, * p&lt;0.05, . p&lt;0.1</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Significance codes: *** p&lt;0.001, ** p&lt;0.01, * p&lt;0.05, . p&lt;0.1</code></pre>
</div>
</div>
<p>After segmenting by age and accounting for statistical significance, young people diverge in terms of specific issues.</p>
<p>We also see that the average gap between genders declines with age, with the specific issue gaps shrinking towards middle age, and then increasing in old age.</p>
<p>Add visualizations for specific issue areas down the line. Good to know these differences.</p>
</section>
</section>
<section id="modelling-stage---how-does-age-gender-other-demographics-predict-ideology" class="level4">
<h4 class="anchored" data-anchor-id="modelling-stage---how-does-age-gender-other-demographics-predict-ideology">4) Modelling stage - how does age, gender, other demographics predict ideology?</h4>
<p><strong>Is the gender-age interaction the primary driver of ideological differences, or do other demographics matter more?</strong> Informs whether the CEO should focus messaging strategies on generational gender gaps vs.&nbsp;other demographic segments.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb56"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb56-1"><a href="#cb56-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Create survey design object</span></span>
<span id="cb56-2"><a href="#cb56-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-3"><a href="#cb56-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Note that we could add stratification to this stage, such as though religion or age. We don't know the stratification scheme. </span></span>
<span id="cb56-4"><a href="#cb56-4" aria-hidden="true" tabindex="-1"></a>survey_design_full <span class="ot">&lt;-</span> <span class="fu">svydesign</span>(</span>
<span id="cb56-5"><a href="#cb56-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">ids =</span> <span class="sc">~</span><span class="dv">1</span>,  <span class="co"># No clustering in this dataset, assumes simple random sampling</span></span>
<span id="cb56-6"><a href="#cb56-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">weights =</span> <span class="sc">~</span>wt,</span>
<span id="cb56-7"><a href="#cb56-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> uk_data</span>
<span id="cb56-8"><a href="#cb56-8" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<section id="m1-social-conservatism-predictors" class="level5">
<h5 class="anchored" data-anchor-id="m1-social-conservatism-predictors">M1: Social Conservatism Predictors</h5>
<p>What demographic factors best predict social conservatism? Is the gender-age interaction significant even after controlling for education, region, etc.?</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb57"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb57-1"><a href="#cb57-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Model social conservatism with full demographic controls</span></span>
<span id="cb57-2"><a href="#cb57-2" aria-hidden="true" tabindex="-1"></a>model_social <span class="ot">&lt;-</span> <span class="fu">svyglm</span>(</span>
<span id="cb57-3"><a href="#cb57-3" aria-hidden="true" tabindex="-1"></a>  social_conservatism <span class="sc">~</span> gender <span class="sc">*</span> age <span class="sc">+</span> gender <span class="sc">*</span> education <span class="sc">+</span> age <span class="sc">*</span> education <span class="sc">+</span> </span>
<span id="cb57-4"><a href="#cb57-4" aria-hidden="true" tabindex="-1"></a>                       gender <span class="sc">*</span> region <span class="sc">+</span> ethnicity <span class="sc">+</span> household <span class="sc">+</span> socgrad <span class="sc">+</span> </span>
<span id="cb57-5"><a href="#cb57-5" aria-hidden="true" tabindex="-1"></a>                       marital <span class="sc">+</span> religion,</span>
<span id="cb57-6"><a href="#cb57-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">design =</span> survey_design_full,</span>
<span id="cb57-7"><a href="#cb57-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">family =</span> <span class="fu">gaussian</span>()</span>
<span id="cb57-8"><a href="#cb57-8" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb57-9"><a href="#cb57-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb57-10"><a href="#cb57-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Display model summary</span></span>
<span id="cb57-11"><a href="#cb57-11" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(model_social)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
svyglm(formula = social_conservatism ~ gender * age + gender * 
    education + age * education + gender * region + ethnicity + 
    household + socgrad + marital + religion, design = survey_design_full, 
    family = gaussian())

Survey design:
svydesign(ids = ~1, weights = ~wt, data = uk_data)

Coefficients:
                                           Estimate Std. Error t value Pr(&gt;|t|)
(Intercept)                                0.363293   0.020262  17.930  &lt; 2e-16
gendermale                                 0.052833   0.021486   2.459 0.013937
age25_TO_34                                0.051252   0.014962   3.425 0.000615
age35_TO_44                                0.063534   0.015360   4.136 3.54e-05
age45_TO_54                                0.032741   0.016164   2.026 0.042820
age55_TO_64                                0.003957   0.017715   0.223 0.823250
age65_TO_74                               -0.001059   0.019716  -0.054 0.957156
age75_PLUS                                 0.007708   0.025261   0.305 0.760268
educationlow                              -0.001148   0.014391  -0.080 0.936413
regionEast of England                     -0.021003   0.013994  -1.501 0.133399
regionGreater London                      -0.052226   0.013260  -3.938 8.22e-05
regionNorth East England                  -0.004133   0.016824  -0.246 0.805960
regionNorth West England                  -0.010786   0.013123  -0.822 0.411109
regionScotland                            -0.064857   0.014565  -4.453 8.50e-06
regionSouth East England                  -0.034182   0.012567  -2.720 0.006534
regionSouth West England                  -0.051888   0.013782  -3.765 0.000167
regionWales                               -0.005318   0.016791  -0.317 0.751474
regionWest Midlands                        0.010208   0.013766   0.742 0.458346
regionYorkshire and the Humber            -0.004511   0.013951  -0.323 0.746461
ethnicityblack                             0.014082   0.014099   0.999 0.317896
ethnicitymixed                            -0.122320   0.018319  -6.677 2.47e-11
ethnicityother                            -0.093829   0.025950  -3.616 0.000300
ethnicitywhite                            -0.064763   0.011258  -5.752 8.88e-09
householdowns_with_mortgage_or_shared     -0.021830   0.006365  -3.430 0.000605
householdprivate_rented_or_rent_free      -0.037177   0.007177  -5.180 2.23e-07
householdsocial_rented                     0.028925   0.007575   3.819 0.000134
socgradC1                                  0.006182   0.006257   0.988 0.323137
socgradC2                                  0.078416   0.007139  10.984  &lt; 2e-16
socgradDE                                  0.057307   0.007001   8.185 2.82e-16
maritalrelationship_living                -0.032748   0.007263  -4.509 6.54e-06
maritalrelationship_notliving             -0.069461   0.010846  -6.404 1.53e-10
maritalseparated_divorced                 -0.049178   0.009402  -5.230 1.70e-07
maritalsingle                             -0.082409   0.006504 -12.670  &lt; 2e-16
maritalwidowed                            -0.035478   0.014152  -2.507 0.012186
religionhindu                              0.046268   0.019554   2.366 0.017979
religionmuslim                             0.019190   0.012580   1.525 0.127149
religionnone                              -0.151908   0.005167 -29.398  &lt; 2e-16
religionother                             -0.114530   0.013743  -8.333  &lt; 2e-16
gendermale:age25_TO_34                    -0.020908   0.017168  -1.218 0.223284
gendermale:age35_TO_44                    -0.023675   0.017100  -1.384 0.166215
gendermale:age45_TO_54                    -0.064885   0.017128  -3.788 0.000152
gendermale:age55_TO_64                    -0.082475   0.017743  -4.648 3.36e-06
gendermale:age65_TO_74                    -0.043009   0.018208  -2.362 0.018178
gendermale:age75_PLUS                     -0.030634   0.023383  -1.310 0.190175
gendermale:educationlow                   -0.032676   0.009870  -3.311 0.000932
age25_TO_34:educationlow                   0.083263   0.017308   4.811 1.51e-06
age35_TO_44:educationlow                   0.112852   0.017316   6.517 7.26e-11
age45_TO_54:educationlow                   0.190870   0.017665  10.805  &lt; 2e-16
age55_TO_64:educationlow                   0.244035   0.018879  12.926  &lt; 2e-16
age65_TO_74:educationlow                   0.248227   0.020299  12.229  &lt; 2e-16
age75_PLUS:educationlow                    0.270824   0.026564  10.195  &lt; 2e-16
gendermale:regionEast of England           0.032516   0.021330   1.524 0.127419
gendermale:regionGreater London            0.039145   0.020204   1.937 0.052697
gendermale:regionNorth East England        0.015197   0.026637   0.571 0.568315
gendermale:regionNorth West England       -0.017952   0.020571  -0.873 0.382858
gendermale:regionScotland                 -0.013982   0.023415  -0.597 0.550419
gendermale:regionSouth East England        0.004377   0.019902   0.220 0.825915
gendermale:regionSouth West England        0.028748   0.022254   1.292 0.196427
gendermale:regionWales                     0.009719   0.025842   0.376 0.706848
gendermale:regionWest Midlands            -0.026487   0.021663  -1.223 0.221450
gendermale:regionYorkshire and the Humber  0.013071   0.021871   0.598 0.550087
                                             
(Intercept)                               ***
gendermale                                *  
age25_TO_34                               ***
age35_TO_44                               ***
age45_TO_54                               *  
age55_TO_64                                  
age65_TO_74                                  
age75_PLUS                                   
educationlow                                 
regionEast of England                        
regionGreater London                      ***
regionNorth East England                     
regionNorth West England                     
regionScotland                            ***
regionSouth East England                  ** 
regionSouth West England                  ***
regionWales                                  
regionWest Midlands                          
regionYorkshire and the Humber               
ethnicityblack                               
ethnicitymixed                            ***
ethnicityother                            ***
ethnicitywhite                            ***
householdowns_with_mortgage_or_shared     ***
householdprivate_rented_or_rent_free      ***
householdsocial_rented                    ***
socgradC1                                    
socgradC2                                 ***
socgradDE                                 ***
maritalrelationship_living                ***
maritalrelationship_notliving             ***
maritalseparated_divorced                 ***
maritalsingle                             ***
maritalwidowed                            *  
religionhindu                             *  
religionmuslim                               
religionnone                              ***
religionother                             ***
gendermale:age25_TO_34                       
gendermale:age35_TO_44                       
gendermale:age45_TO_54                    ***
gendermale:age55_TO_64                    ***
gendermale:age65_TO_74                    *  
gendermale:age75_PLUS                        
gendermale:educationlow                   ***
age25_TO_34:educationlow                  ***
age35_TO_44:educationlow                  ***
age45_TO_54:educationlow                  ***
age55_TO_64:educationlow                  ***
age65_TO_74:educationlow                  ***
age75_PLUS:educationlow                   ***
gendermale:regionEast of England             
gendermale:regionGreater London           .  
gendermale:regionNorth East England          
gendermale:regionNorth West England          
gendermale:regionScotland                    
gendermale:regionSouth East England          
gendermale:regionSouth West England          
gendermale:regionWales                       
gendermale:regionWest Midlands               
gendermale:regionYorkshire and the Humber    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

(Dispersion parameter for gaussian family taken to be 0.1463526)

Number of Fisher Scoring iterations: 2</code></pre>
</div>
<div class="sourceCode cell-code" id="cb59"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb59-1"><a href="#cb59-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Extract key coefficients for interpretation</span></span>
<span id="cb59-2"><a href="#cb59-2" aria-hidden="true" tabindex="-1"></a>social_coefs <span class="ot">&lt;-</span> <span class="fu">summary</span>(model_social)<span class="sc">$</span>coefficients</span>
<span id="cb59-3"><a href="#cb59-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-4"><a href="#cb59-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Model fit statistics</span></span>
<span id="cb59-5"><a href="#cb59-5" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">Model Fit Statistics:</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Model Fit Statistics:</code></pre>
</div>
<div class="sourceCode cell-code" id="cb61"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb61-1"><a href="#cb61-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Degrees of Freedom:"</span>, model_social<span class="sc">$</span>df.residual, <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Degrees of Freedom: 31838 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb63"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb63-1"><a href="#cb63-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Deviance:"</span>, <span class="fu">round</span>(model_social<span class="sc">$</span>deviance, <span class="dv">3</span>), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Deviance: 4668.355 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb65"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb65-1"><a href="#cb65-1" aria-hidden="true" tabindex="-1"></a><span class="do">##  Check further diagnostics if wanted</span></span>
<span id="cb65-2"><a href="#cb65-2" aria-hidden="true" tabindex="-1"></a><span class="co">#plot(model_social)</span></span>
<span id="cb65-3"><a href="#cb65-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-4"><a href="#cb65-4" aria-hidden="true" tabindex="-1"></a><span class="do">##  VIF Multicollinearity</span></span>
<span id="cb65-5"><a href="#cb65-5" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(car)</span>
<span id="cb65-6"><a href="#cb65-6" aria-hidden="true" tabindex="-1"></a>car<span class="sc">::</span><span class="fu">vif</span>(model_social, <span class="at">type =</span> <span class="st">'terms'</span>)  <span class="co"># Check for multicollinearity</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                        GVIF Df GVIF^(1/(2*Df))
gender             24.098372  1        4.909009
age              5501.013243  6        2.049763
education          10.361472  1        3.218924
region            217.318511 10        1.308744
ethnicity           2.713818  4        1.132916
household           1.835931  3        1.106563
socgrad             1.542353  3        1.074890
marital             2.026446  5        1.073182
religion            2.551689  4        1.124226
gender:age        200.531314  6        1.555423
gender:education    4.011074  1        2.002767
age:education    4522.769533  6        2.016587
gender:region    1662.356923 10        1.448893</code></pre>
</div>
<div class="sourceCode cell-code" id="cb67"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb67-1"><a href="#cb67-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Number of observations</span></span>
<span id="cb67-2"><a href="#cb67-2" aria-hidden="true" tabindex="-1"></a><span class="fu">nobs</span>(model_social)  <span class="co"># Number of observations</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 31899</code></pre>
</div>
</div>
<p>Reference categories:</p>
<p>Above shows similar trends to what we’ve been seeing and hypothesizing.</p>
<p>The main effect shows males are more conservative (+0.040), but the interactions reveal this gender gap narrows with age. In middle age (45-64), the male effect is actually reduced by about 0.067-0.088, suggesting older women catch up in conservatism.</p>
<ul>
<li><p><strong>Gender gap widens with age</strong>: Young women (18-24) and young men show minimal difference, but the gap grows significantly in middle age groups (45-54, 55-64), with men becoming substantially more conservative than women as they age</p></li>
<li><p><strong>Education creates opposite patterns by gender</strong>: The gender gap is smaller among highly educated groups - educated men are less conservative relative to educated women, while among non-degree holders, men are significantly more conservative than women</p></li>
<li><p><strong>London and Scotland stand out</strong>: Both regions show significantly lower social conservatism overall, with London showing a 0.052 point decrease and Scotland showing a 0.065 point decrease compared to the reference region</p></li>
<li><p><strong>Religious affiliation is the strongest predictor</strong>: People with no religious affiliation are dramatically less socially conservative (-0.152 points), representing the largest single effect in the model, while Hindu respondents show higher conservatism</p></li>
<li><p><strong>Social class matters more than individual demographics</strong>: Working class groups (C2, DE) show significantly higher social conservatism, and this effect is larger than most individual demographic characteristics, suggesting economic position shapes social attitudes.</p></li>
</ul>
<p>Note the reference categories in interpreting the above.</p>
</section>
<section id="m2-economic-leftism-predictors" class="level5">
<h5 class="anchored" data-anchor-id="m2-economic-leftism-predictors">M2: Economic Leftism Predictors</h5>
<p>Are the drivers of economic vs social attitudes different? This matters for corporate positioning on economic vs social issues.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb69"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb69-1"><a href="#cb69-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Model economic leftism with same demographic controls</span></span>
<span id="cb69-2"><a href="#cb69-2" aria-hidden="true" tabindex="-1"></a>model_economic <span class="ot">&lt;-</span> <span class="fu">svyglm</span>(</span>
<span id="cb69-3"><a href="#cb69-3" aria-hidden="true" tabindex="-1"></a>  economic_leftism <span class="sc">~</span> gender <span class="sc">*</span> age <span class="sc">+</span> gender <span class="sc">*</span> education <span class="sc">+</span> age <span class="sc">*</span> education <span class="sc">+</span> </span>
<span id="cb69-4"><a href="#cb69-4" aria-hidden="true" tabindex="-1"></a>                       gender <span class="sc">*</span> region <span class="sc">+</span> ethnicity <span class="sc">+</span> household <span class="sc">+</span> socgrad <span class="sc">+</span> </span>
<span id="cb69-5"><a href="#cb69-5" aria-hidden="true" tabindex="-1"></a>                       marital <span class="sc">+</span> religion,</span>
<span id="cb69-6"><a href="#cb69-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">design =</span> survey_design_full,</span>
<span id="cb69-7"><a href="#cb69-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">family =</span> <span class="fu">gaussian</span>()</span>
<span id="cb69-8"><a href="#cb69-8" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb69-9"><a href="#cb69-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-10"><a href="#cb69-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Display model summary</span></span>
<span id="cb69-11"><a href="#cb69-11" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(model_economic)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
svyglm(formula = economic_leftism ~ gender * age + gender * education + 
    age * education + gender * region + ethnicity + household + 
    socgrad + marital + religion, design = survey_design_full, 
    family = gaussian())

Survey design:
svydesign(ids = ~1, weights = ~wt, data = uk_data)

Coefficients:
                                            Estimate Std. Error t value
(Intercept)                                0.2776356  0.0204741  13.560
gendermale                                -0.1021618  0.0227148  -4.498
age25_TO_34                                0.0010940  0.0137142   0.080
age35_TO_44                               -0.0108251  0.0142182  -0.761
age45_TO_54                               -0.0460382  0.0152236  -3.024
age55_TO_64                               -0.0416714  0.0171520  -2.430
age65_TO_74                               -0.1113428  0.0203695  -5.466
age75_PLUS                                -0.2258286  0.0293005  -7.707
educationlow                              -0.0265459  0.0135273  -1.962
regionEast of England                     -0.0089011  0.0144869  -0.614
regionGreater London                       0.0045295  0.0138038   0.328
regionNorth East England                   0.0133574  0.0172805   0.773
regionNorth West England                   0.0353062  0.0135622   2.603
regionScotland                             0.0280422  0.0152186   1.843
regionSouth East England                  -0.0501488  0.0133999  -3.742
regionSouth West England                  -0.0245130  0.0141055  -1.738
regionWales                                0.0494106  0.0172960   2.857
regionWest Midlands                       -0.0075666  0.0144740  -0.523
regionYorkshire and the Humber             0.0310465  0.0148924   2.085
ethnicityblack                            -0.0095599  0.0149580  -0.639
ethnicitymixed                             0.0588153  0.0181686   3.237
ethnicityother                            -0.0067890  0.0272323  -0.249
ethnicitywhite                             0.0292856  0.0113561   2.579
householdowns_with_mortgage_or_shared      0.0521838  0.0068417   7.627
householdprivate_rented_or_rent_free       0.0823187  0.0073883  11.142
householdsocial_rented                     0.1214610  0.0080590  15.072
socgradC1                                  0.0589617  0.0066655   8.846
socgradC2                                  0.0821555  0.0076703  10.711
socgradDE                                  0.1008644  0.0074760  13.492
maritalrelationship_living                 0.0196067  0.0073481   2.668
maritalrelationship_notliving              0.0410309  0.0107319   3.823
maritalseparated_divorced                 -0.0007388  0.0104404  -0.071
maritalsingle                              0.0225543  0.0066484   3.392
maritalwidowed                            -0.0033326  0.0165731  -0.201
religionhindu                              0.0312780  0.0213276   1.467
religionmuslim                             0.0468243  0.0131517   3.560
religionnone                               0.0566375  0.0055128  10.274
religionother                              0.0714437  0.0144499   4.944
gendermale:age25_TO_34                     0.0568854  0.0163773   3.473
gendermale:age35_TO_44                     0.1020481  0.0164126   6.218
gendermale:age45_TO_54                     0.0981834  0.0166755   5.888
gendermale:age55_TO_64                     0.0992767  0.0178450   5.563
gendermale:age65_TO_74                     0.1081468  0.0192862   5.607
gendermale:age75_PLUS                      0.0583078  0.0272682   2.138
gendermale:educationlow                    0.0262021  0.0102231   2.563
age25_TO_34:educationlow                  -0.0096867  0.0161665  -0.599
age35_TO_44:educationlow                   0.0038730  0.0162604   0.238
age45_TO_54:educationlow                   0.0317494  0.0168699   1.882
age55_TO_64:educationlow                   0.0098353  0.0184800   0.532
age65_TO_74:educationlow                   0.0319070  0.0210987   1.512
age75_PLUS:educationlow                    0.0691084  0.0298262   2.317
gendermale:regionEast of England           0.0117838  0.0236733   0.498
gendermale:regionGreater London            0.0022891  0.0223940   0.102
gendermale:regionNorth East England        0.0347774  0.0288019   1.207
gendermale:regionNorth West England        0.0440365  0.0222878   1.976
gendermale:regionScotland                  0.0421295  0.0250419   1.682
gendermale:regionSouth East England        0.0539811  0.0222477   2.426
gendermale:regionSouth West England        0.0433907  0.0244181   1.777
gendermale:regionWales                    -0.0271798  0.0292431  -0.929
gendermale:regionWest Midlands             0.0307933  0.0238186   1.293
gendermale:regionYorkshire and the Humber  0.0016626  0.0241856   0.069
                                          Pr(&gt;|t|)    
(Intercept)                                &lt; 2e-16 ***
gendermale                                6.90e-06 ***
age25_TO_34                               0.936422    
age35_TO_44                               0.446449    
age45_TO_54                               0.002496 ** 
age55_TO_64                               0.015124 *  
age65_TO_74                               4.63e-08 ***
age75_PLUS                                1.32e-14 ***
educationlow                              0.049725 *  
regionEast of England                     0.538940    
regionGreater London                      0.742810    
regionNorth East England                  0.439542    
regionNorth West England                  0.009238 ** 
regionScotland                            0.065393 .  
regionSouth East England                  0.000183 ***
regionSouth West England                  0.082251 .  
regionWales                               0.004283 ** 
regionWest Midlands                       0.601138    
regionYorkshire and the Humber            0.037103 *  
ethnicityblack                            0.522752    
ethnicitymixed                            0.001208 ** 
ethnicityother                            0.803132    
ethnicitywhite                            0.009918 ** 
householdowns_with_mortgage_or_shared     2.46e-14 ***
householdprivate_rented_or_rent_free       &lt; 2e-16 ***
householdsocial_rented                     &lt; 2e-16 ***
socgradC1                                  &lt; 2e-16 ***
socgradC2                                  &lt; 2e-16 ***
socgradDE                                  &lt; 2e-16 ***
maritalrelationship_living                0.007628 ** 
maritalrelationship_notliving             0.000132 ***
maritalseparated_divorced                 0.943588    
maritalsingle                             0.000694 ***
maritalwidowed                            0.840632    
religionhindu                             0.142510    
religionmuslim                            0.000371 ***
religionnone                               &lt; 2e-16 ***
religionother                             7.68e-07 ***
gendermale:age25_TO_34                    0.000515 ***
gendermale:age35_TO_44                    5.11e-10 ***
gendermale:age45_TO_54                    3.95e-09 ***
gendermale:age55_TO_64                    2.67e-08 ***
gendermale:age65_TO_74                    2.07e-08 ***
gendermale:age75_PLUS                     0.032499 *  
gendermale:educationlow                   0.010381 *  
age25_TO_34:educationlow                  0.549056    
age35_TO_44:educationlow                  0.811737    
age45_TO_54:educationlow                  0.059843 .  
age55_TO_64:educationlow                  0.594581    
age65_TO_74:educationlow                  0.130474    
age75_PLUS:educationlow                   0.020508 *  
gendermale:regionEast of England          0.618651    
gendermale:regionGreater London           0.918583    
gendermale:regionNorth East England       0.227262    
gendermale:regionNorth West England       0.048184 *  
gendermale:regionScotland                 0.092509 .  
gendermale:regionSouth East England       0.015256 *  
gendermale:regionSouth West England       0.075579 .  
gendermale:regionWales                    0.352667    
gendermale:regionWest Midlands            0.196080    
gendermale:regionYorkshire and the Humber 0.945195    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

(Dispersion parameter for gaussian family taken to be 0.1567217)

Number of Fisher Scoring iterations: 2</code></pre>
</div>
<div class="sourceCode cell-code" id="cb71"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb71-1"><a href="#cb71-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Extract key coefficients for interpretation</span></span>
<span id="cb71-2"><a href="#cb71-2" aria-hidden="true" tabindex="-1"></a>economic_coefs <span class="ot">&lt;-</span> <span class="fu">summary</span>(model_economic)<span class="sc">$</span>coefficients</span>
<span id="cb71-3"><a href="#cb71-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb71-4"><a href="#cb71-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Model fit statistics</span></span>
<span id="cb71-5"><a href="#cb71-5" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">Model Fit Statistics:</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Model Fit Statistics:</code></pre>
</div>
<div class="sourceCode cell-code" id="cb73"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb73-1"><a href="#cb73-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Degrees of Freedom:"</span>, model_economic<span class="sc">$</span>df.residual, <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Degrees of Freedom: 31808 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb75"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb75-1"><a href="#cb75-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Deviance:"</span>, <span class="fu">round</span>(model_economic<span class="sc">$</span>deviance, <span class="dv">3</span>), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Deviance: 4994.406 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb77"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb77-1"><a href="#cb77-1" aria-hidden="true" tabindex="-1"></a><span class="do">##  Check further diagnostics if wanted</span></span>
<span id="cb77-2"><a href="#cb77-2" aria-hidden="true" tabindex="-1"></a><span class="co">#plot(model_economic)</span></span>
<span id="cb77-3"><a href="#cb77-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb77-4"><a href="#cb77-4" aria-hidden="true" tabindex="-1"></a><span class="do">##  VIF Multicollinearity</span></span>
<span id="cb77-5"><a href="#cb77-5" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(car)</span>
<span id="cb77-6"><a href="#cb77-6" aria-hidden="true" tabindex="-1"></a>car<span class="sc">::</span><span class="fu">vif</span>(model_economic, <span class="at">type =</span> <span class="st">'terms'</span>)  <span class="co"># Check for multicollinearity</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                        GVIF Df GVIF^(1/(2*Df))
gender             26.223786  1        5.120916
age              3818.565040  6        1.988345
education           9.296648  1        3.049040
region            141.555372 10        1.280992
ethnicity           2.480851  4        1.120276
household           1.806534  3        1.103590
socgrad             1.552379  3        1.076051
marital             2.153207  5        1.079714
religion            2.522337  4        1.122601
gender:age        164.046618  6        1.529610
gender:education    3.907472  1        1.976733
age:education    2578.509349  6        1.924335
gender:region    1434.034621 10        1.438229</code></pre>
</div>
<div class="sourceCode cell-code" id="cb79"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb79-1"><a href="#cb79-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Number of observations</span></span>
<span id="cb79-2"><a href="#cb79-2" aria-hidden="true" tabindex="-1"></a><span class="fu">nobs</span>(model_economic)  <span class="co"># Number of observations</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 31869</code></pre>
</div>
</div>
<p>similar trends as seen from our prior visuals and analysis.</p>
<p>Interpreting the economic leftism model:</p>
<ul>
<li><p><strong>Strong gender divide that increases with age</strong>: Young women (18-24) are more economically left-wing than men, and this gap dramatically widens with age - by 65-74, men are about 0.11 points more left-wing than the baseline, creating a substantial gender gap favoring women’s left-wing positions</p></li>
<li><p><strong>Education reverses the gender pattern</strong>: Among highly educated people, women are more left-wing than men, but among those without degrees, men actually become slightly more economically left-wing than women (interaction effect of +0.026)</p></li>
<li><p><strong>Regional variations in gender gaps</strong>: The economic gender divide is most pronounced in South East England and North West England, where men show significantly higher left-wing tendencies relative to women compared to other regions</p></li>
<li><p><strong>Housing tenure is the strongest economic predictor</strong>: Social renters show the highest economic leftism (+0.121), followed by private renters (+0.082), suggesting housing insecurity drives left-wing economic attitudes more than traditional demographic factors</p></li>
<li><p><strong>Class and economic leftism align strongly</strong>: Working class groups (C2, DE) are significantly more economically left-wing, with DE showing the largest effect (+0.101), indicating clear class-based economic attitudes that transcend gender and age divisions</p></li>
</ul>
<p>Overall, housing is a more important driver in economic leftism than social conservatism.</p>
<p>Some classic political archetypes/clustering in the data, as expected.</p>
</section>
<section id="m3-vote-choice-prediction" class="level5">
<h5 class="anchored" data-anchor-id="m3-vote-choice-prediction">M3: Vote Choice Prediction</h5>
<p>Do ideological attitudes predict vote better than demographics alone? This tests whether corporate positioning should focus on values vs identity.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb81"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb81-1"><a href="#cb81-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Conservative vote model</span></span>
<span id="cb81-2"><a href="#cb81-2" aria-hidden="true" tabindex="-1"></a>model_vote_con <span class="ot">&lt;-</span> <span class="fu">svyglm</span>(</span>
<span id="cb81-3"><a href="#cb81-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">I</span>(pv_2024 <span class="sc">==</span> <span class="st">"con"</span>) <span class="sc">~</span> gender <span class="sc">*</span> age <span class="sc">+</span> gender <span class="sc">*</span> education <span class="sc">+</span> age <span class="sc">*</span> education <span class="sc">+</span> </span>
<span id="cb81-4"><a href="#cb81-4" aria-hidden="true" tabindex="-1"></a>                       gender <span class="sc">*</span> region <span class="sc">+</span> ethnicity <span class="sc">+</span> household <span class="sc">+</span> socgrad <span class="sc">+</span> </span>
<span id="cb81-5"><a href="#cb81-5" aria-hidden="true" tabindex="-1"></a>                       marital <span class="sc">+</span> religion,</span>
<span id="cb81-6"><a href="#cb81-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">design =</span> survey_design_full,</span>
<span id="cb81-7"><a href="#cb81-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">family =</span> <span class="fu">binomial</span>(<span class="at">link =</span> <span class="st">"logit"</span>)</span>
<span id="cb81-8"><a href="#cb81-8" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb81-9"><a href="#cb81-9" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(model_vote_con)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
svyglm(formula = I(pv_2024 == "con") ~ gender * age + gender * 
    education + age * education + gender * region + ethnicity + 
    household + socgrad + marital + religion, design = survey_design_full, 
    family = binomial(link = "logit"))

Survey design:
svydesign(ids = ~1, weights = ~wt, data = uk_data)

Coefficients:
                                           Estimate Std. Error t value Pr(&gt;|t|)
(Intercept)                               -1.397405   0.163411  -8.551  &lt; 2e-16
gendermale                                 0.467362   0.167787   2.785 0.005348
age25_TO_34                                0.350748   0.125069   2.804 0.005044
age35_TO_44                                0.588636   0.125162   4.703 2.57e-06
age45_TO_54                                0.528658   0.128601   4.111 3.95e-05
age55_TO_64                                0.695350   0.135412   5.135 2.84e-07
age65_TO_74                                1.051049   0.140235   7.495 6.80e-14
age75_PLUS                                 1.505458   0.169499   8.882  &lt; 2e-16
educationlow                              -0.179694   0.126450  -1.421 0.155307
regionEast of England                      0.028573   0.104106   0.274 0.783728
regionGreater London                       0.047290   0.098364   0.481 0.630684
regionNorth East England                  -0.092574   0.127375  -0.727 0.467365
regionNorth West England                  -0.234718   0.100917  -2.326 0.020033
regionScotland                            -0.797606   0.126213  -6.320 2.66e-10
regionSouth East England                   0.208977   0.094807   2.204 0.027515
regionSouth West England                  -0.034796   0.105722  -0.329 0.742061
regionWales                               -0.200707   0.126600  -1.585 0.112894
regionWest Midlands                       -0.115376   0.105993  -1.089 0.276369
regionYorkshire and the Humber            -0.065496   0.104726  -0.625 0.531708
ethnicityblack                            -0.018792   0.108321  -0.173 0.862275
ethnicitymixed                            -0.334206   0.152547  -2.191 0.028470
ethnicityother                            -0.032589   0.211042  -0.154 0.877279
ethnicitywhite                            -0.006596   0.087249  -0.076 0.939734
householdowns_with_mortgage_or_shared     -0.229649   0.043024  -5.338 9.48e-08
householdprivate_rented_or_rent_free      -0.391675   0.050354  -7.778 7.56e-15
householdsocial_rented                    -0.540933   0.059779  -9.049  &lt; 2e-16
socgradC1                                 -0.232856   0.043288  -5.379 7.53e-08
socgradC2                                 -0.307242   0.053204  -5.775 7.78e-09
socgradDE                                 -0.506511   0.051785  -9.781  &lt; 2e-16
maritalrelationship_living                -0.175914   0.054922  -3.203 0.001362
maritalrelationship_notliving             -0.189571   0.084499  -2.243 0.024873
maritalseparated_divorced                 -0.149468   0.063542  -2.352 0.018666
maritalsingle                             -0.081750   0.046683  -1.751 0.079927
maritalwidowed                             0.062530   0.090775   0.689 0.490923
religionhindu                              0.627423   0.129033   4.863 1.16e-06
religionmuslim                            -0.557162   0.108246  -5.147 2.66e-07
religionnone                              -0.557237   0.036793 -15.145  &lt; 2e-16
religionother                             -0.183400   0.096454  -1.901 0.057256
gendermale:age25_TO_34                    -0.133857   0.144035  -0.929 0.352722
gendermale:age35_TO_44                    -0.334713   0.142348  -2.351 0.018710
gendermale:age45_TO_54                    -0.310146   0.141807  -2.187 0.028742
gendermale:age55_TO_64                    -0.496445   0.141824  -3.500 0.000465
gendermale:age65_TO_74                    -0.474449   0.142305  -3.334 0.000857
gendermale:age75_PLUS                     -0.612190   0.166746  -3.671 0.000242
gendermale:educationlow                    0.105531   0.068572   1.539 0.123818
age25_TO_34:educationlow                   0.101958   0.144918   0.704 0.481711
age35_TO_44:educationlow                  -0.015923   0.142249  -0.112 0.910877
age45_TO_54:educationlow                   0.263342   0.141958   1.855 0.063596
age55_TO_64:educationlow                   0.356927   0.144202   2.475 0.013322
age65_TO_74:educationlow                   0.482287   0.146549   3.291 0.001000
age75_PLUS:educationlow                    0.354112   0.174051   2.035 0.041906
gendermale:regionEast of England           0.021967   0.151287   0.145 0.884552
gendermale:regionGreater London            0.008116   0.141238   0.057 0.954174
gendermale:regionNorth East England       -0.362286   0.196872  -1.840 0.065746
gendermale:regionNorth West England       -0.085077   0.149507  -0.569 0.569328
gendermale:regionScotland                  0.099867   0.182432   0.547 0.584094
gendermale:regionSouth East England       -0.281721   0.141660  -1.989 0.046741
gendermale:regionSouth West England       -0.215212   0.159821  -1.347 0.178126
gendermale:regionWales                    -0.013079   0.187168  -0.070 0.944289
gendermale:regionWest Midlands             0.165308   0.154156   1.072 0.283575
gendermale:regionYorkshire and the Humber -0.244543   0.158754  -1.540 0.123475
                                             
(Intercept)                               ***
gendermale                                ** 
age25_TO_34                               ** 
age35_TO_44                               ***
age45_TO_54                               ***
age55_TO_64                               ***
age65_TO_74                               ***
age75_PLUS                                ***
educationlow                                 
regionEast of England                        
regionGreater London                         
regionNorth East England                     
regionNorth West England                  *  
regionScotland                            ***
regionSouth East England                  *  
regionSouth West England                     
regionWales                                  
regionWest Midlands                          
regionYorkshire and the Humber               
ethnicityblack                               
ethnicitymixed                            *  
ethnicityother                               
ethnicitywhite                               
householdowns_with_mortgage_or_shared     ***
householdprivate_rented_or_rent_free      ***
householdsocial_rented                    ***
socgradC1                                 ***
socgradC2                                 ***
socgradDE                                 ***
maritalrelationship_living                ** 
maritalrelationship_notliving             *  
maritalseparated_divorced                 *  
maritalsingle                             .  
maritalwidowed                               
religionhindu                             ***
religionmuslim                            ***
religionnone                              ***
religionother                             .  
gendermale:age25_TO_34                       
gendermale:age35_TO_44                    *  
gendermale:age45_TO_54                    *  
gendermale:age55_TO_64                    ***
gendermale:age65_TO_74                    ***
gendermale:age75_PLUS                     ***
gendermale:educationlow                      
age25_TO_34:educationlow                     
age35_TO_44:educationlow                     
age45_TO_54:educationlow                  .  
age55_TO_64:educationlow                  *  
age65_TO_74:educationlow                  ***
age75_PLUS:educationlow                   *  
gendermale:regionEast of England             
gendermale:regionGreater London              
gendermale:regionNorth East England       .  
gendermale:regionNorth West England          
gendermale:regionScotland                    
gendermale:regionSouth East England       *  
gendermale:regionSouth West England          
gendermale:regionWales                       
gendermale:regionWest Midlands               
gendermale:regionYorkshire and the Humber    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

(Dispersion parameter for binomial family taken to be 1.001977)

Number of Fisher Scoring iterations: 5</code></pre>
</div>
<div class="sourceCode cell-code" id="cb83"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb83-1"><a href="#cb83-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Labour vote model</span></span>
<span id="cb83-2"><a href="#cb83-2" aria-hidden="true" tabindex="-1"></a>model_vote_lab <span class="ot">&lt;-</span> <span class="fu">svyglm</span>(</span>
<span id="cb83-3"><a href="#cb83-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">I</span>(pv_2024 <span class="sc">==</span> <span class="st">"lab"</span>) <span class="sc">~</span> gender <span class="sc">*</span> age <span class="sc">+</span> gender <span class="sc">*</span> education <span class="sc">+</span> age <span class="sc">*</span> education <span class="sc">+</span> </span>
<span id="cb83-4"><a href="#cb83-4" aria-hidden="true" tabindex="-1"></a>                       gender <span class="sc">*</span> region <span class="sc">+</span> ethnicity <span class="sc">+</span> household <span class="sc">+</span> socgrad <span class="sc">+</span> </span>
<span id="cb83-5"><a href="#cb83-5" aria-hidden="true" tabindex="-1"></a>                       marital <span class="sc">+</span> religion,</span>
<span id="cb83-6"><a href="#cb83-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">design =</span> survey_design_full,</span>
<span id="cb83-7"><a href="#cb83-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">family =</span> <span class="fu">binomial</span>(<span class="at">link =</span> <span class="st">"logit"</span>)</span>
<span id="cb83-8"><a href="#cb83-8" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb83-9"><a href="#cb83-9" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(model_vote_lab)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
svyglm(formula = I(pv_2024 == "lab") ~ gender * age + gender * 
    education + age * education + gender * region + ethnicity + 
    household + socgrad + marital + religion, design = survey_design_full, 
    family = binomial(link = "logit"))

Survey design:
svydesign(ids = ~1, weights = ~wt, data = uk_data)

Coefficients:
                                           Estimate Std. Error t value Pr(&gt;|t|)
(Intercept)                               -0.048651   0.111219  -0.437 0.661795
gendermale                                -0.251371   0.117085  -2.147 0.031808
age25_TO_34                               -0.076641   0.078927  -0.971 0.331538
age35_TO_44                               -0.301282   0.081170  -3.712 0.000206
age45_TO_54                               -0.367798   0.084811  -4.337 1.45e-05
age55_TO_64                               -0.380637   0.092136  -4.131 3.62e-05
age65_TO_74                               -0.746049   0.106029  -7.036 2.01e-12
age75_PLUS                                -1.196960   0.163867  -7.304 2.85e-13
educationlow                              -0.347744   0.076343  -4.555 5.26e-06
regionEast of England                     -0.136100   0.078226  -1.740 0.081898
regionGreater London                       0.037203   0.073139   0.509 0.610989
regionNorth East England                   0.383828   0.091246   4.207 2.60e-05
regionNorth West England                   0.428949   0.072241   5.938 2.92e-09
regionScotland                            -0.175509   0.085586  -2.051 0.040307
regionSouth East England                  -0.340100   0.071990  -4.724 2.32e-06
regionSouth West England                  -0.345505   0.077978  -4.431 9.42e-06
regionWales                                0.105080   0.091133   1.153 0.248901
regionWest Midlands                       -0.049649   0.077349  -0.642 0.520955
regionYorkshire and the Humber             0.111520   0.077898   1.432 0.152262
ethnicityblack                             0.566923   0.080335   7.057 1.74e-12
ethnicitymixed                             0.334627   0.099307   3.370 0.000754
ethnicityother                            -0.004396   0.149532  -0.029 0.976546
ethnicitywhite                            -0.091039   0.062178  -1.464 0.143158
householdowns_with_mortgage_or_shared      0.225195   0.035088   6.418 1.40e-10
householdprivate_rented_or_rent_free       0.223089   0.038096   5.856 4.79e-09
householdsocial_rented                     0.360684   0.042145   8.558  &lt; 2e-16
socgradC1                                  0.053845   0.033257   1.619 0.105445
socgradC2                                 -0.065850   0.039479  -1.668 0.095329
socgradDE                                 -0.039196   0.038410  -1.020 0.307514
maritalrelationship_living                 0.116120   0.038479   3.018 0.002548
maritalrelationship_notliving              0.084103   0.055291   1.521 0.128242
maritalseparated_divorced                  0.055294   0.051223   1.079 0.280386
maritalsingle                              0.060695   0.034399   1.764 0.077668
maritalwidowed                            -0.006707   0.088401  -0.076 0.939520
religionhindu                              0.009623   0.111599   0.086 0.931285
religionmuslim                             0.217230   0.072942   2.978 0.002902
religionnone                               0.138977   0.027858   4.989 6.11e-07
religionother                              0.048032   0.074345   0.646 0.518237
gendermale:age25_TO_34                     0.322568   0.091218   3.536 0.000406
gendermale:age35_TO_44                     0.374958   0.090769   4.131 3.62e-05
gendermale:age45_TO_54                     0.239462   0.091490   2.617 0.008866
gendermale:age55_TO_64                     0.166051   0.094590   1.755 0.079185
gendermale:age65_TO_74                     0.194901   0.102877   1.895 0.058167
gendermale:age75_PLUS                      0.235448   0.153287   1.536 0.124549
gendermale:educationlow                    0.085553   0.051564   1.659 0.097098
age25_TO_34:educationlow                  -0.036363   0.091187  -0.399 0.690064
age35_TO_44:educationlow                   0.120406   0.091065   1.322 0.186112
age45_TO_54:educationlow                   0.114217   0.092556   1.234 0.217197
age55_TO_64:educationlow                   0.003799   0.097533   0.039 0.968927
age65_TO_74:educationlow                   0.151186   0.109103   1.386 0.165842
age75_PLUS:educationlow                    0.202541   0.164118   1.234 0.217168
gendermale:regionEast of England          -0.124987   0.118627  -1.054 0.292071
gendermale:regionGreater London           -0.110033   0.110341  -0.997 0.318675
gendermale:regionNorth East England       -0.134889   0.145526  -0.927 0.353981
gendermale:regionNorth West England       -0.169671   0.112356  -1.510 0.131024
gendermale:regionScotland                 -0.228244   0.133289  -1.712 0.086833
gendermale:regionSouth East England        0.113088   0.111875   1.011 0.312103
gendermale:regionSouth West England       -0.044879   0.123694  -0.363 0.716740
gendermale:regionWales                    -0.320884   0.140648  -2.281 0.022527
gendermale:regionWest Midlands             0.120805   0.119053   1.015 0.310247
gendermale:regionYorkshire and the Humber -0.061456   0.122365  -0.502 0.615504
                                             
(Intercept)                                  
gendermale                                *  
age25_TO_34                                  
age35_TO_44                               ***
age45_TO_54                               ***
age55_TO_64                               ***
age65_TO_74                               ***
age75_PLUS                                ***
educationlow                              ***
regionEast of England                     .  
regionGreater London                         
regionNorth East England                  ***
regionNorth West England                  ***
regionScotland                            *  
regionSouth East England                  ***
regionSouth West England                  ***
regionWales                                  
regionWest Midlands                          
regionYorkshire and the Humber               
ethnicityblack                            ***
ethnicitymixed                            ***
ethnicityother                               
ethnicitywhite                               
householdowns_with_mortgage_or_shared     ***
householdprivate_rented_or_rent_free      ***
householdsocial_rented                    ***
socgradC1                                    
socgradC2                                 .  
socgradDE                                    
maritalrelationship_living                ** 
maritalrelationship_notliving                
maritalseparated_divorced                    
maritalsingle                             .  
maritalwidowed                               
religionhindu                                
religionmuslim                            ** 
religionnone                              ***
religionother                                
gendermale:age25_TO_34                    ***
gendermale:age35_TO_44                    ***
gendermale:age45_TO_54                    ** 
gendermale:age55_TO_64                    .  
gendermale:age65_TO_74                    .  
gendermale:age75_PLUS                        
gendermale:educationlow                   .  
age25_TO_34:educationlow                     
age35_TO_44:educationlow                     
age45_TO_54:educationlow                     
age55_TO_64:educationlow                     
age65_TO_74:educationlow                     
age75_PLUS:educationlow                      
gendermale:regionEast of England             
gendermale:regionGreater London              
gendermale:regionNorth East England          
gendermale:regionNorth West England          
gendermale:regionScotland                 .  
gendermale:regionSouth East England          
gendermale:regionSouth West England          
gendermale:regionWales                    *  
gendermale:regionWest Midlands               
gendermale:regionYorkshire and the Humber    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

(Dispersion parameter for binomial family taken to be 1.000544)

Number of Fisher Scoring iterations: 5</code></pre>
</div>
<div class="sourceCode cell-code" id="cb85"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb85-1"><a href="#cb85-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Reform vote model</span></span>
<span id="cb85-2"><a href="#cb85-2" aria-hidden="true" tabindex="-1"></a>model_vote_rfm <span class="ot">&lt;-</span> <span class="fu">svyglm</span>(</span>
<span id="cb85-3"><a href="#cb85-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">I</span>(pv_2024 <span class="sc">==</span> <span class="st">"rfm"</span>) <span class="sc">~</span> gender <span class="sc">*</span> age <span class="sc">+</span> gender <span class="sc">*</span> education <span class="sc">+</span> age <span class="sc">*</span> education <span class="sc">+</span> </span>
<span id="cb85-4"><a href="#cb85-4" aria-hidden="true" tabindex="-1"></a>                       gender <span class="sc">*</span> region <span class="sc">+</span> ethnicity <span class="sc">+</span> household <span class="sc">+</span> socgrad <span class="sc">+</span> </span>
<span id="cb85-5"><a href="#cb85-5" aria-hidden="true" tabindex="-1"></a>                       marital <span class="sc">+</span> religion,</span>
<span id="cb85-6"><a href="#cb85-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">design =</span> survey_design_full,</span>
<span id="cb85-7"><a href="#cb85-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">family =</span> <span class="fu">binomial</span>(<span class="at">link =</span> <span class="st">"logit"</span>)</span>
<span id="cb85-8"><a href="#cb85-8" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb85-9"><a href="#cb85-9" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(model_vote_rfm)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
svyglm(formula = I(pv_2024 == "rfm") ~ gender * age + gender * 
    education + age * education + gender * region + ethnicity + 
    household + socgrad + marital + religion, design = survey_design_full, 
    family = binomial(link = "logit"))

Survey design:
svydesign(ids = ~1, weights = ~wt, data = uk_data)

Coefficients:
                                           Estimate Std. Error t value Pr(&gt;|t|)
(Intercept)                               -2.423857   0.190306 -12.737  &lt; 2e-16
gendermale                                 0.371117   0.170362   2.178 0.029383
age25_TO_34                               -0.391386   0.145045  -2.698 0.006972
age35_TO_44                               -0.319124   0.146946  -2.172 0.029884
age45_TO_54                               -0.113922   0.147230  -0.774 0.439072
age55_TO_64                                0.167568   0.147706   1.134 0.256605
age65_TO_74                                0.114691   0.161447   0.710 0.477463
age75_PLUS                                 0.132399   0.210224   0.630 0.528831
educationlow                               0.184112   0.127709   1.442 0.149412
regionEast of England                     -0.165929   0.111193  -1.492 0.135642
regionGreater London                      -0.287225   0.114476  -2.509 0.012111
regionNorth East England                  -0.182926   0.133105  -1.374 0.169358
regionNorth West England                  -0.267520   0.105617  -2.533 0.011316
regionScotland                            -1.282097   0.152833  -8.389  &lt; 2e-16
regionSouth East England                  -0.164973   0.102846  -1.604 0.108708
regionSouth West England                  -0.230783   0.113182  -2.039 0.041454
regionWales                               -0.395743   0.135891  -2.912 0.003591
regionWest Midlands                        0.037926   0.108497   0.350 0.726669
regionYorkshire and the Humber            -0.180896   0.110419  -1.638 0.101376
ethnicityblack                            -0.754110   0.185834  -4.058 4.96e-05
ethnicitymixed                            -0.228900   0.198201  -1.155 0.248144
ethnicityother                            -0.364803   0.350308  -1.041 0.297708
ethnicitywhite                             0.491944   0.121266   4.057 4.99e-05
householdowns_with_mortgage_or_shared     -0.007791   0.049402  -0.158 0.874681
householdprivate_rented_or_rent_free      -0.158251   0.057202  -2.767 0.005669
householdsocial_rented                    -0.057748   0.059425  -0.972 0.331171
socgradC1                                  0.143129   0.050960   2.809 0.004978
socgradC2                                  0.532900   0.054996   9.690  &lt; 2e-16
socgradDE                                  0.159141   0.056760   2.804 0.005055
maritalrelationship_living                 0.088906   0.054809   1.622 0.104793
maritalrelationship_notliving              0.009988   0.082702   0.121 0.903873
maritalseparated_divorced                  0.010189   0.070069   0.145 0.884382
maritalsingle                             -0.131872   0.051702  -2.551 0.010758
maritalwidowed                            -0.157972   0.115909  -1.363 0.172923
religionhindu                             -0.683548   0.250391  -2.730 0.006338
religionmuslim                            -0.745124   0.155430  -4.794 1.64e-06
religionnone                              -0.138396   0.039555  -3.499 0.000468
religionother                             -0.274919   0.111053  -2.476 0.013308
gendermale:age25_TO_34                    -0.090715   0.147454  -0.615 0.538420
gendermale:age35_TO_44                    -0.153420   0.141421  -1.085 0.277996
gendermale:age45_TO_54                    -0.198740   0.138605  -1.434 0.151622
gendermale:age55_TO_64                    -0.141764   0.137078  -1.034 0.301058
gendermale:age65_TO_74                    -0.235387   0.143532  -1.640 0.101023
gendermale:age75_PLUS                     -0.220470   0.186286  -1.184 0.236619
gendermale:educationlow                   -0.103799   0.079446  -1.307 0.191382
age25_TO_34:educationlow                   0.293278   0.154266   1.901 0.057295
age35_TO_44:educationlow                   0.502154   0.151182   3.322 0.000896
age45_TO_54:educationlow                   0.399819   0.150559   2.656 0.007922
age55_TO_64:educationlow                   0.205192   0.150425   1.364 0.172551
age65_TO_74:educationlow                   0.265387   0.161593   1.642 0.100535
age75_PLUS:educationlow                    0.114363   0.209037   0.547 0.584315
gendermale:regionEast of England           0.401888   0.159570   2.519 0.011788
gendermale:regionGreater London            0.027963   0.166742   0.168 0.866819
gendermale:regionNorth East England        0.397657   0.192362   2.067 0.038720
gendermale:regionNorth West England        0.071306   0.157419   0.453 0.650573
gendermale:regionScotland                  0.358933   0.213602   1.680 0.092892
gendermale:regionSouth East England        0.144871   0.152152   0.952 0.341030
gendermale:regionSouth West England        0.349379   0.164555   2.123 0.033747
gendermale:regionWales                     0.227354   0.200652   1.133 0.257191
gendermale:regionWest Midlands            -0.228683   0.165993  -1.378 0.168315
gendermale:regionYorkshire and the Humber  0.179647   0.162922   1.103 0.270183
                                             
(Intercept)                               ***
gendermale                                *  
age25_TO_34                               ** 
age35_TO_44                               *  
age45_TO_54                                  
age55_TO_64                                  
age65_TO_74                                  
age75_PLUS                                   
educationlow                                 
regionEast of England                        
regionGreater London                      *  
regionNorth East England                     
regionNorth West England                  *  
regionScotland                            ***
regionSouth East England                     
regionSouth West England                  *  
regionWales                               ** 
regionWest Midlands                          
regionYorkshire and the Humber               
ethnicityblack                            ***
ethnicitymixed                               
ethnicityother                               
ethnicitywhite                            ***
householdowns_with_mortgage_or_shared        
householdprivate_rented_or_rent_free      ** 
householdsocial_rented                       
socgradC1                                 ** 
socgradC2                                 ***
socgradDE                                 ** 
maritalrelationship_living                   
maritalrelationship_notliving                
maritalseparated_divorced                    
maritalsingle                             *  
maritalwidowed                               
religionhindu                             ** 
religionmuslim                            ***
religionnone                              ***
religionother                             *  
gendermale:age25_TO_34                       
gendermale:age35_TO_44                       
gendermale:age45_TO_54                       
gendermale:age55_TO_64                       
gendermale:age65_TO_74                       
gendermale:age75_PLUS                        
gendermale:educationlow                      
age25_TO_34:educationlow                  .  
age35_TO_44:educationlow                  ***
age45_TO_54:educationlow                  ** 
age55_TO_64:educationlow                     
age65_TO_74:educationlow                     
age75_PLUS:educationlow                      
gendermale:regionEast of England          *  
gendermale:regionGreater London              
gendermale:regionNorth East England       *  
gendermale:regionNorth West England          
gendermale:regionScotland                 .  
gendermale:regionSouth East England          
gendermale:regionSouth West England       *  
gendermale:regionWales                       
gendermale:regionWest Midlands               
gendermale:regionYorkshire and the Humber    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

(Dispersion parameter for binomial family taken to be 1.011642)

Number of Fisher Scoring iterations: 6</code></pre>
</div>
<div class="sourceCode cell-code" id="cb87"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb87-1"><a href="#cb87-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Green vote model</span></span>
<span id="cb87-2"><a href="#cb87-2" aria-hidden="true" tabindex="-1"></a>model_vote_grn <span class="ot">&lt;-</span> <span class="fu">svyglm</span>(</span>
<span id="cb87-3"><a href="#cb87-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">I</span>(pv_2024 <span class="sc">==</span> <span class="st">"grn"</span>) <span class="sc">~</span> gender <span class="sc">*</span> age <span class="sc">+</span> gender <span class="sc">*</span> education <span class="sc">+</span> age <span class="sc">*</span> education <span class="sc">+</span> </span>
<span id="cb87-4"><a href="#cb87-4" aria-hidden="true" tabindex="-1"></a>                       gender <span class="sc">*</span> region <span class="sc">+</span> ethnicity <span class="sc">+</span> household <span class="sc">+</span> socgrad <span class="sc">+</span> </span>
<span id="cb87-5"><a href="#cb87-5" aria-hidden="true" tabindex="-1"></a>                       marital <span class="sc">+</span> religion,</span>
<span id="cb87-6"><a href="#cb87-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">design =</span> survey_design_full,</span>
<span id="cb87-7"><a href="#cb87-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">family =</span> <span class="fu">binomial</span>(<span class="at">link =</span> <span class="st">"logit"</span>)</span>
<span id="cb87-8"><a href="#cb87-8" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb87-9"><a href="#cb87-9" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(model_vote_grn)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
svyglm(formula = I(pv_2024 == "grn") ~ gender * age + gender * 
    education + age * education + gender * region + ethnicity + 
    household + socgrad + marital + religion, design = survey_design_full, 
    family = binomial(link = "logit"))

Survey design:
svydesign(ids = ~1, weights = ~wt, data = uk_data)

Coefficients:
                                           Estimate Std. Error t value Pr(&gt;|t|)
(Intercept)                               -2.871924   0.205377 -13.984  &lt; 2e-16
gendermale                                -0.362675   0.228823  -1.585 0.112985
age25_TO_34                               -0.584490   0.142437  -4.103 4.08e-05
age35_TO_44                               -0.347914   0.143774  -2.420 0.015531
age45_TO_54                               -0.294269   0.150216  -1.959 0.050125
age55_TO_64                               -0.428298   0.168479  -2.542 0.011022
age65_TO_74                               -0.486557   0.219636  -2.215 0.026747
age75_PLUS                                -0.348988   0.310855  -1.123 0.261586
educationlow                               0.027265   0.125357   0.217 0.827822
regionEast of England                      0.434614   0.149122   2.914 0.003565
regionGreater London                      -0.071058   0.149042  -0.477 0.633532
regionNorth East England                  -0.357284   0.207609  -1.721 0.085271
regionNorth West England                  -0.321283   0.158593  -2.026 0.042790
regionScotland                            -0.394636   0.177681  -2.221 0.026356
regionSouth East England                   0.134353   0.144725   0.928 0.353243
regionSouth West England                   0.286707   0.149740   1.915 0.055541
regionWales                               -0.459686   0.203174  -2.263 0.023672
regionWest Midlands                        0.164471   0.151045   1.089 0.276210
regionYorkshire and the Humber             0.091959   0.155686   0.591 0.554747
ethnicityblack                            -0.231086   0.162141  -1.425 0.154104
ethnicitymixed                             0.090993   0.174455   0.522 0.601965
ethnicityother                            -0.208478   0.280210  -0.744 0.456879
ethnicitywhite                             0.053699   0.107248   0.501 0.616583
householdowns_with_mortgage_or_shared      0.049623   0.076300   0.650 0.515459
householdprivate_rented_or_rent_free       0.193508   0.077448   2.499 0.012476
householdsocial_rented                    -0.102389   0.094988  -1.078 0.281080
socgradC1                                 -0.003778   0.067964  -0.056 0.955673
socgradC2                                 -0.153207   0.084534  -1.812 0.069940
socgradDE                                  0.004538   0.075721   0.060 0.952216
maritalrelationship_living                 0.163994   0.082186   1.995 0.046008
maritalrelationship_notliving              0.427276   0.103341   4.135 3.56e-05
maritalseparated_divorced                  0.393841   0.101298   3.888 0.000101
maritalsingle                              0.269213   0.069867   3.853 0.000117
maritalwidowed                             0.302149   0.194876   1.550 0.121039
religionhindu                              0.189644   0.228247   0.831 0.406052
religionmuslim                             1.010474   0.121121   8.343  &lt; 2e-16
religionnone                               0.617795   0.062463   9.891  &lt; 2e-16
religionother                              0.805515   0.127933   6.296 3.09e-10
gendermale:age25_TO_34                    -0.034416   0.170670  -0.202 0.840189
gendermale:age35_TO_44                     0.058277   0.170151   0.343 0.731976
gendermale:age45_TO_54                     0.187189   0.173009   1.082 0.279279
gendermale:age55_TO_64                     0.284426   0.182327   1.560 0.118776
gendermale:age65_TO_74                     0.182510   0.223784   0.816 0.414756
gendermale:age75_PLUS                     -1.000784   0.419790  -2.384 0.017131
gendermale:educationlow                   -0.032015   0.108201  -0.296 0.767320
age25_TO_34:educationlow                   0.196918   0.163780   1.202 0.229243
age35_TO_44:educationlow                  -0.223815   0.165302  -1.354 0.175753
age45_TO_54:educationlow                  -0.475071   0.168993  -2.811 0.004939
age55_TO_64:educationlow                  -0.368882   0.182859  -2.017 0.043672
age65_TO_74:educationlow                  -0.666743   0.222573  -2.996 0.002741
age75_PLUS:educationlow                   -0.610063   0.366462  -1.665 0.095975
gendermale:regionEast of England          -0.475956   0.259750  -1.832 0.066907
gendermale:regionGreater London            0.225424   0.236819   0.952 0.341164
gendermale:regionNorth East England        0.078464   0.341166   0.230 0.818104
gendermale:regionNorth West England        0.592671   0.245529   2.414 0.015790
gendermale:regionScotland                  0.019024   0.305505   0.062 0.950348
gendermale:regionSouth East England       -0.061680   0.237192  -0.260 0.794832
gendermale:regionSouth West England       -0.190359   0.256269  -0.743 0.457604
gendermale:regionWales                     0.304487   0.338942   0.898 0.369008
gendermale:regionWest Midlands            -0.169727   0.256236  -0.662 0.507729
gendermale:regionYorkshire and the Humber -0.031611   0.263677  -0.120 0.904574
                                             
(Intercept)                               ***
gendermale                                   
age25_TO_34                               ***
age35_TO_44                               *  
age45_TO_54                               .  
age55_TO_64                               *  
age65_TO_74                               *  
age75_PLUS                                   
educationlow                                 
regionEast of England                     ** 
regionGreater London                         
regionNorth East England                  .  
regionNorth West England                  *  
regionScotland                            *  
regionSouth East England                     
regionSouth West England                  .  
regionWales                               *  
regionWest Midlands                          
regionYorkshire and the Humber               
ethnicityblack                               
ethnicitymixed                               
ethnicityother                               
ethnicitywhite                               
householdowns_with_mortgage_or_shared        
householdprivate_rented_or_rent_free      *  
householdsocial_rented                       
socgradC1                                    
socgradC2                                 .  
socgradDE                                    
maritalrelationship_living                *  
maritalrelationship_notliving             ***
maritalseparated_divorced                 ***
maritalsingle                             ***
maritalwidowed                               
religionhindu                                
religionmuslim                            ***
religionnone                              ***
religionother                             ***
gendermale:age25_TO_34                       
gendermale:age35_TO_44                       
gendermale:age45_TO_54                       
gendermale:age55_TO_64                       
gendermale:age65_TO_74                       
gendermale:age75_PLUS                     *  
gendermale:educationlow                      
age25_TO_34:educationlow                     
age35_TO_44:educationlow                     
age45_TO_54:educationlow                  ** 
age55_TO_64:educationlow                  *  
age65_TO_74:educationlow                  ** 
age75_PLUS:educationlow                   .  
gendermale:regionEast of England          .  
gendermale:regionGreater London              
gendermale:regionNorth East England          
gendermale:regionNorth West England       *  
gendermale:regionScotland                    
gendermale:regionSouth East England          
gendermale:regionSouth West England          
gendermale:regionWales                       
gendermale:regionWest Midlands               
gendermale:regionYorkshire and the Humber    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

(Dispersion parameter for binomial family taken to be 0.9906936)

Number of Fisher Scoring iterations: 6</code></pre>
</div>
<div class="sourceCode cell-code" id="cb89"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb89-1"><a href="#cb89-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Liberal Democrat vote model</span></span>
<span id="cb89-2"><a href="#cb89-2" aria-hidden="true" tabindex="-1"></a>model_vote_ldm <span class="ot">&lt;-</span> <span class="fu">svyglm</span>(</span>
<span id="cb89-3"><a href="#cb89-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">I</span>(pv_2024 <span class="sc">==</span> <span class="st">"ldm"</span>) <span class="sc">~</span> gender <span class="sc">*</span> age <span class="sc">+</span> gender <span class="sc">*</span> education <span class="sc">+</span> age <span class="sc">*</span> education <span class="sc">+</span> </span>
<span id="cb89-4"><a href="#cb89-4" aria-hidden="true" tabindex="-1"></a>                       gender <span class="sc">*</span> region <span class="sc">+</span> ethnicity <span class="sc">+</span> household <span class="sc">+</span> socgrad <span class="sc">+</span> </span>
<span id="cb89-5"><a href="#cb89-5" aria-hidden="true" tabindex="-1"></a>                       marital <span class="sc">+</span> religion,</span>
<span id="cb89-6"><a href="#cb89-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">design =</span> survey_design_full,</span>
<span id="cb89-7"><a href="#cb89-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">family =</span> <span class="fu">binomial</span>(<span class="at">link =</span> <span class="st">"logit"</span>)</span>
<span id="cb89-8"><a href="#cb89-8" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb89-9"><a href="#cb89-9" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(model_vote_ldm)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
svyglm(formula = I(pv_2024 == "ldm") ~ gender * age + gender * 
    education + age * education + gender * region + ethnicity + 
    household + socgrad + marital + religion, design = survey_design_full, 
    family = binomial(link = "logit"))

Survey design:
svydesign(ids = ~1, weights = ~wt, data = uk_data)

Coefficients:
                                            Estimate Std. Error t value
(Intercept)                               -2.8656809  0.2284889 -12.542
gendermale                                 0.0158911  0.2656831   0.060
age25_TO_34                                0.5808463  0.1696224   3.424
age35_TO_44                                0.7469188  0.1705775   4.379
age45_TO_54                                0.7318757  0.1736371   4.215
age55_TO_64                                0.5964043  0.1822943   3.272
age65_TO_74                                0.8611217  0.1924353   4.475
age75_PLUS                                 0.7988137  0.2322224   3.440
educationlow                               0.0401641  0.1663346   0.241
regionEast of England                      0.4578992  0.1497404   3.058
regionGreater London                       0.3551338  0.1446654   2.455
regionNorth East England                  -0.7677746  0.2298709  -3.340
regionNorth West England                  -0.0551773  0.1550003  -0.356
regionScotland                            -0.2274309  0.1721031  -1.321
regionSouth East England                   0.8590008  0.1319319   6.511
regionSouth West England                   1.0747149  0.1354096   7.937
regionWales                               -0.1668682  0.1939756  -0.860
regionWest Midlands                        0.1499000  0.1621430   0.924
regionYorkshire and the Humber            -0.1235566  0.1652523  -0.748
ethnicityblack                            -0.9402186  0.1689214  -5.566
ethnicitymixed                            -0.0388687  0.1811790  -0.215
ethnicityother                             0.0567869  0.2640436   0.215
ethnicitywhite                            -0.0306544  0.1113974  -0.275
householdowns_with_mortgage_or_shared     -0.0322492  0.0601973  -0.536
householdprivate_rented_or_rent_free      -0.0822033  0.0715891  -1.148
householdsocial_rented                    -0.3033083  0.0826542  -3.670
socgradC1                                 -0.1099378  0.0584354  -1.881
socgradC2                                 -0.2418803  0.0756416  -3.198
socgradDE                                 -0.1718599  0.0695548  -2.471
maritalrelationship_living                -0.3620134  0.0754268  -4.800
maritalrelationship_notliving             -0.2019475  0.1074517  -1.879
maritalseparated_divorced                  0.0767345  0.0853231   0.899
maritalsingle                             -0.0601592  0.0644006  -0.934
maritalwidowed                            -0.0007967  0.1372853  -0.006
religionhindu                             -0.9978062  0.2743353  -3.637
religionmuslim                            -0.3419972  0.1395052  -2.452
religionnone                              -0.0790539  0.0490523  -1.612
religionother                             -0.1575140  0.1382388  -1.139
gendermale:age25_TO_34                    -0.3771545  0.1952083  -1.932
gendermale:age35_TO_44                    -0.3383152  0.1916957  -1.765
gendermale:age45_TO_54                    -0.2789282  0.1910939  -1.460
gendermale:age55_TO_64                    -0.1706532  0.1927429  -0.885
gendermale:age65_TO_74                    -0.2288912  0.2003926  -1.142
gendermale:age75_PLUS                      0.2863531  0.2337121   1.225
gendermale:educationlow                   -0.1092569  0.0930616  -1.174
age25_TO_34:educationlow                  -0.2541224  0.1941031  -1.309
age35_TO_44:educationlow                  -0.4693127  0.1891271  -2.481
age45_TO_54:educationlow                  -0.3438851  0.1884636  -1.825
age55_TO_64:educationlow                  -0.1689601  0.1920321  -0.880
age65_TO_74:educationlow                  -0.5350131  0.1983384  -2.697
age75_PLUS:educationlow                   -0.3625461  0.2306516  -1.572
gendermale:regionEast of England          -0.0816162  0.2541681  -0.321
gendermale:regionGreater London            0.3992290  0.2364056   1.689
gendermale:regionNorth East England        0.5411261  0.3659736   1.479
gendermale:regionNorth West England        0.1106111  0.2572621   0.430
gendermale:regionScotland                  0.3652168  0.2891938   1.263
gendermale:regionSouth East England        0.0849777  0.2269336   0.374
gendermale:regionSouth West England        0.1061987  0.2354041   0.451
gendermale:regionWales                     0.5075050  0.3170289   1.601
gendermale:regionWest Midlands             0.2419094  0.2626938   0.921
gendermale:regionYorkshire and the Humber  0.6144835  0.2654613   2.315
                                          Pr(&gt;|t|)    
(Intercept)                                &lt; 2e-16 ***
gendermale                                0.952306    
age25_TO_34                               0.000617 ***
age35_TO_44                               1.20e-05 ***
age45_TO_54                               2.50e-05 ***
age55_TO_64                               0.001070 ** 
age65_TO_74                               7.67e-06 ***
age75_PLUS                                0.000583 ***
educationlow                              0.809196    
regionEast of England                     0.002230 ** 
regionGreater London                      0.014099 *  
regionNorth East England                  0.000839 ***
regionNorth West England                  0.721857    
regionScotland                            0.186351    
regionSouth East England                  7.58e-11 ***
regionSouth West England                  2.14e-15 ***
regionWales                               0.389656    
regionWest Midlands                       0.355237    
regionYorkshire and the Humber            0.454656    
ethnicityblack                            2.63e-08 ***
ethnicitymixed                            0.830134    
ethnicityother                            0.829717    
ethnicitywhite                            0.783179    
householdowns_with_mortgage_or_shared     0.592153    
householdprivate_rented_or_rent_free      0.250867    
householdsocial_rented                    0.000243 ***
socgradC1                                 0.059933 .  
socgradC2                                 0.001387 ** 
socgradDE                                 0.013484 *  
maritalrelationship_living                1.60e-06 ***
maritalrelationship_notliving             0.060195 .  
maritalseparated_divorced                 0.368479    
maritalsingle                             0.350238    
maritalwidowed                            0.995370    
religionhindu                             0.000276 ***
religionmuslim                            0.014231 *  
religionnone                              0.107054    
religionother                             0.254530    
gendermale:age25_TO_34                    0.053361 .  
gendermale:age35_TO_44                    0.077598 .  
gendermale:age45_TO_54                    0.144399    
gendermale:age55_TO_64                    0.375951    
gendermale:age65_TO_74                    0.253374    
gendermale:age75_PLUS                     0.220494    
gendermale:educationlow                   0.240393    
age25_TO_34:educationlow                  0.190472    
age35_TO_44:educationlow                  0.013089 *  
age45_TO_54:educationlow                  0.068059 .  
age55_TO_64:educationlow                  0.378945    
age65_TO_74:educationlow                  0.006990 ** 
age75_PLUS:educationlow                   0.115999    
gendermale:regionEast of England          0.748128    
gendermale:regionGreater London           0.091278 .  
gendermale:regionNorth East England       0.139259    
gendermale:regionNorth West England       0.667232    
gendermale:regionScotland                 0.206642    
gendermale:regionSouth East England       0.708064    
gendermale:regionSouth West England       0.651897    
gendermale:regionWales                    0.109428    
gendermale:regionWest Midlands            0.357120    
gendermale:regionYorkshire and the Humber 0.020631 *  
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

(Dispersion parameter for binomial family taken to be 1.002397)

Number of Fisher Scoring iterations: 6</code></pre>
</div>
</div>
</section>
<section id="checking-model-robustness" class="level5">
<h5 class="anchored" data-anchor-id="checking-model-robustness">Checking Model Robustness</h5>
<p>Important to check the goodness of fit of our models. If our models are good, then we can use them for continual segmented analysis and answer some pertinent business questions around specific audiences/ market areas.</p>
<p>Examining residuals vs.&nbsp;fitted values for each model:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb91"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb91-1"><a href="#cb91-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Residuals vs Fitted for Social Conservatism Model</span></span>
<span id="cb91-2"><a href="#cb91-2" aria-hidden="true" tabindex="-1"></a>res <span class="ot">&lt;-</span> <span class="fu">residuals</span>(model_social, <span class="at">type =</span> <span class="st">"response"</span>)</span>
<span id="cb91-3"><a href="#cb91-3" aria-hidden="true" tabindex="-1"></a>fit <span class="ot">&lt;-</span> <span class="fu">fitted</span>(model_social)</span>
<span id="cb91-4"><a href="#cb91-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb91-5"><a href="#cb91-5" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(fit, res,</span>
<span id="cb91-6"><a href="#cb91-6" aria-hidden="true" tabindex="-1"></a>     <span class="at">xlab =</span> <span class="st">"Fitted values"</span>,</span>
<span id="cb91-7"><a href="#cb91-7" aria-hidden="true" tabindex="-1"></a>     <span class="at">ylab =</span> <span class="st">"Residuals"</span>,</span>
<span id="cb91-8"><a href="#cb91-8" aria-hidden="true" tabindex="-1"></a>     <span class="at">main =</span> <span class="st">"Residuals vs Fitted"</span>)</span>
<span id="cb91-9"><a href="#cb91-9" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">h =</span> <span class="dv">0</span>, <span class="at">col =</span> <span class="st">"red"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="initial_analysis_files/figure-html/unnamed-chunk-16-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:80.0%"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb92"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb92-1"><a href="#cb92-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Distribution of residuals</span></span>
<span id="cb92-2"><a href="#cb92-2" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(res, <span class="at">breaks =</span> <span class="dv">30</span>, <span class="at">main =</span> <span class="st">"Histogram of residuals"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="initial_analysis_files/figure-html/unnamed-chunk-16-2.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:80.0%"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb93"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb93-1"><a href="#cb93-1" aria-hidden="true" tabindex="-1"></a><span class="fu">qqnorm</span>(res); <span class="fu">qqline</span>(res, <span class="at">col =</span> <span class="st">"red"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="initial_analysis_files/figure-html/unnamed-chunk-16-3.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:80.0%"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb94"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb94-1"><a href="#cb94-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Check fitted value range </span></span>
<span id="cb94-2"><a href="#cb94-2" aria-hidden="true" tabindex="-1"></a><span class="fu">range</span>(fit)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] -0.0713054  0.7337753</code></pre>
</div>
<div class="sourceCode cell-code" id="cb96"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb96-1"><a href="#cb96-1" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(fit <span class="sc">&lt;</span> <span class="sc">-</span><span class="dv">1</span> <span class="sc">|</span> fit <span class="sc">&gt;</span> <span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0</code></pre>
</div>
<div class="sourceCode cell-code" id="cb98"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb98-1"><a href="#cb98-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Pseudo R-squared</span></span>
<span id="cb98-2"><a href="#cb98-2" aria-hidden="true" tabindex="-1"></a>y <span class="ot">&lt;-</span> model_social<span class="sc">$</span>y</span>
<span id="cb98-3"><a href="#cb98-3" aria-hidden="true" tabindex="-1"></a>r2 <span class="ot">&lt;-</span> <span class="dv">1</span> <span class="sc">-</span> <span class="fu">sum</span>(res<span class="sc">^</span><span class="dv">2</span>) <span class="sc">/</span> <span class="fu">sum</span>((y <span class="sc">-</span> <span class="fu">mean</span>(y))<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb98-4"><a href="#cb98-4" aria-hidden="true" tabindex="-1"></a>r2</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.1309345</code></pre>
</div>
</div>
<p>Note that clustering of residuals vs.&nbsp;fitted show diagonal banding, but is likely that this comes predictors being mostly categorical, so fitted values clsuter at a few discrete points. No major heteroskasticity.</p>
<p>Predictions stay within the valid DV range. Normal that they shrink a bit from the extremes.</p>
<p>Residuals look roughly normal and centered, though tails deviate a bit.</p>
<p>R² ≈ 0.12: moderate explanatory power for this kind of attitudinal outcome in our social science context.</p>
<p>We would expect to see similar for the economic leftism model. Let’s see</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb100"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb100-1"><a href="#cb100-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Residuals vs Fitted for Economic Leftism Model</span></span>
<span id="cb100-2"><a href="#cb100-2" aria-hidden="true" tabindex="-1"></a>res <span class="ot">&lt;-</span> <span class="fu">residuals</span>(model_economic, <span class="at">type =</span> <span class="st">"response"</span>)</span>
<span id="cb100-3"><a href="#cb100-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb100-4"><a href="#cb100-4" aria-hidden="true" tabindex="-1"></a>fit <span class="ot">&lt;-</span> <span class="fu">fitted</span>(model_economic)</span>
<span id="cb100-5"><a href="#cb100-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb100-6"><a href="#cb100-6" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(fit, res,</span>
<span id="cb100-7"><a href="#cb100-7" aria-hidden="true" tabindex="-1"></a>     <span class="at">xlab =</span> <span class="st">"Fitted values"</span>,</span>
<span id="cb100-8"><a href="#cb100-8" aria-hidden="true" tabindex="-1"></a>     <span class="at">ylab =</span> <span class="st">"Residuals"</span>,</span>
<span id="cb100-9"><a href="#cb100-9" aria-hidden="true" tabindex="-1"></a>     <span class="at">main =</span> <span class="st">"Residuals vs Fitted"</span>)</span>
<span id="cb100-10"><a href="#cb100-10" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">h =</span> <span class="dv">0</span>, <span class="at">col =</span> <span class="st">"red"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="initial_analysis_files/figure-html/unnamed-chunk-17-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:80.0%"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb101"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb101-1"><a href="#cb101-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Distribution of residuals</span></span>
<span id="cb101-2"><a href="#cb101-2" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(res, <span class="at">breaks =</span> <span class="dv">30</span>, <span class="at">main =</span> <span class="st">"Histogram of residuals"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="initial_analysis_files/figure-html/unnamed-chunk-17-2.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:80.0%"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb102"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb102-1"><a href="#cb102-1" aria-hidden="true" tabindex="-1"></a><span class="fu">qqnorm</span>(res); <span class="fu">qqline</span>(res, <span class="at">col =</span> <span class="st">"red"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="initial_analysis_files/figure-html/unnamed-chunk-17-3.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:80.0%"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb103"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb103-1"><a href="#cb103-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Check fitted value range </span></span>
<span id="cb103-2"><a href="#cb103-2" aria-hidden="true" tabindex="-1"></a><span class="fu">range</span>(fit)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.0147716 0.6896771</code></pre>
</div>
<div class="sourceCode cell-code" id="cb105"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb105-1"><a href="#cb105-1" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(fit <span class="sc">&lt;</span> <span class="sc">-</span><span class="dv">1</span> <span class="sc">|</span> fit <span class="sc">&gt;</span> <span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0</code></pre>
</div>
<div class="sourceCode cell-code" id="cb107"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb107-1"><a href="#cb107-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Pseudo R-squared</span></span>
<span id="cb107-2"><a href="#cb107-2" aria-hidden="true" tabindex="-1"></a>y <span class="ot">&lt;-</span> model_economic<span class="sc">$</span>y</span>
<span id="cb107-3"><a href="#cb107-3" aria-hidden="true" tabindex="-1"></a>r2 <span class="ot">&lt;-</span> <span class="dv">1</span> <span class="sc">-</span> <span class="fu">sum</span>(res<span class="sc">^</span><span class="dv">2</span>) <span class="sc">/</span> <span class="fu">sum</span>((y <span class="sc">-</span> <span class="fu">mean</span>(y))<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb107-4"><a href="#cb107-4" aria-hidden="true" tabindex="-1"></a>r2</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.0640795</code></pre>
</div>
</div>
<p>R-squared lower at 6% than with the social conservatism model, but still reasonable for this kind of attitudinal outcome.</p>
<p>We can say that social conservatism is more demographically/ sociologically structured in our sample than economic leftism, owing to this lower R-squared.</p>
</section>
</section>
<section id="segmented-modelling---young-vs-older-age-bands-with-interaction-effects" class="level4">
<h4 class="anchored" data-anchor-id="segmented-modelling---young-vs-older-age-bands-with-interaction-effects">5) Segmented Modelling - Young vs Older Age Bands with Interaction Effects</h4>
<p><strong>Are young people truly different, or just experiencing new intersection age + gender effects? How do our other predictors work differently for this cohort of respondents?</strong></p>
<p>Using interaction modeling approach to maintain survey weight validity while testing age differences in gender effects.</p>
<section id="create-age-group-variable-and-interaction-models" class="level5">
<h5 class="anchored" data-anchor-id="create-age-group-variable-and-interaction-models">Create Age Group Variable and Interaction Models</h5>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb109"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb109-1"><a href="#cb109-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Create age group variable for interaction analysis</span></span>
<span id="cb109-2"><a href="#cb109-2" aria-hidden="true" tabindex="-1"></a>modeling_data_interaction <span class="ot">&lt;-</span> uk_data <span class="sc">%&gt;%</span></span>
<span id="cb109-3"><a href="#cb109-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb109-4"><a href="#cb109-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">age_group =</span> <span class="fu">case_when</span>(</span>
<span id="cb109-5"><a href="#cb109-5" aria-hidden="true" tabindex="-1"></a>      age <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"18_TO_24"</span>, <span class="st">"25_TO_34"</span>) <span class="sc">~</span> <span class="st">"young"</span>,</span>
<span id="cb109-6"><a href="#cb109-6" aria-hidden="true" tabindex="-1"></a>      age <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"35_TO_44"</span>, <span class="st">"45_TO_54"</span>, <span class="st">"55_TO_64"</span>, <span class="st">"65_TO_74"</span>, <span class="st">"75_PLUS"</span>) <span class="sc">~</span> <span class="st">"older"</span></span>
<span id="cb109-7"><a href="#cb109-7" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb109-8"><a href="#cb109-8" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb109-9"><a href="#cb109-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(age_group))</span>
<span id="cb109-10"><a href="#cb109-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb109-11"><a href="#cb109-11" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">paste</span>(<span class="st">"Sample size for interaction analysis:"</span>, <span class="fu">nrow</span>(modeling_data_interaction)))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Sample size for interaction analysis: 32621"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb111"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb111-1"><a href="#cb111-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Create survey design for interaction analysis</span></span>
<span id="cb111-2"><a href="#cb111-2" aria-hidden="true" tabindex="-1"></a>survey_design_interaction <span class="ot">&lt;-</span> <span class="fu">svydesign</span>(</span>
<span id="cb111-3"><a href="#cb111-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">ids =</span> <span class="sc">~</span><span class="dv">1</span>,</span>
<span id="cb111-4"><a href="#cb111-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">weights =</span> <span class="sc">~</span>wt,</span>
<span id="cb111-5"><a href="#cb111-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> modeling_data_interaction</span>
<span id="cb111-6"><a href="#cb111-6" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb111-7"><a href="#cb111-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb111-8"><a href="#cb111-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Social conservatism model with gender*age_group interaction</span></span>
<span id="cb111-9"><a href="#cb111-9" aria-hidden="true" tabindex="-1"></a>model_social_interaction <span class="ot">&lt;-</span> <span class="fu">svyglm</span>(</span>
<span id="cb111-10"><a href="#cb111-10" aria-hidden="true" tabindex="-1"></a>  social_conservatism <span class="sc">~</span> gender <span class="sc">*</span> age_group <span class="sc">+</span> education <span class="sc">+</span> ethnicity <span class="sc">+</span> region <span class="sc">+</span> </span>
<span id="cb111-11"><a href="#cb111-11" aria-hidden="true" tabindex="-1"></a>                       household <span class="sc">+</span> socgrad <span class="sc">+</span> marital <span class="sc">+</span> religion,</span>
<span id="cb111-12"><a href="#cb111-12" aria-hidden="true" tabindex="-1"></a>  <span class="at">design =</span> survey_design_interaction</span>
<span id="cb111-13"><a href="#cb111-13" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb111-14"><a href="#cb111-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb111-15"><a href="#cb111-15" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(model_social_interaction)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
svyglm(formula = social_conservatism ~ gender * age_group + education + 
    ethnicity + region + household + socgrad + marital + religion, 
    design = survey_design_interaction)

Survey design:
svydesign(ids = ~1, weights = ~wt, data = modeling_data_interaction)

Coefficients:
                                       Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)                            0.434393   0.014799  29.354  &lt; 2e-16 ***
gendermale                            -0.010734   0.005553  -1.933 0.053263 .  
age_groupyoung                        -0.082141   0.007047 -11.657  &lt; 2e-16 ***
educationlow                           0.136597   0.005376  25.411  &lt; 2e-16 ***
ethnicityblack                         0.032261   0.014341   2.250 0.024487 *  
ethnicitymixed                        -0.118203   0.018611  -6.351 2.16e-10 ***
ethnicityother                        -0.104838   0.026233  -3.996 6.45e-05 ***
ethnicitywhite                        -0.055625   0.011324  -4.912 9.05e-07 ***
regionEast of England                 -0.003176   0.010691  -0.297 0.766439    
regionGreater London                  -0.028560   0.010279  -2.778 0.005467 ** 
regionNorth East England               0.005875   0.013133   0.447 0.654609    
regionNorth West England              -0.018984   0.010279  -1.847 0.064775 .  
regionScotland                        -0.072431   0.011691  -6.195 5.89e-10 ***
regionSouth East England              -0.033223   0.009985  -3.327 0.000878 ***
regionSouth West England              -0.037472   0.011029  -3.398 0.000681 ***
regionWales                           -0.001230   0.013036  -0.094 0.924848    
regionWest Midlands                   -0.002122   0.010831  -0.196 0.844694    
regionYorkshire and the Humber         0.002018   0.010944   0.184 0.853727    
householdowns_with_mortgage_or_shared -0.033634   0.005953  -5.650 1.61e-08 ***
householdprivate_rented_or_rent_free  -0.044329   0.006852  -6.470 9.97e-11 ***
householdsocial_rented                 0.019470   0.007326   2.658 0.007869 ** 
socgradC1                              0.016615   0.006272   2.649 0.008073 ** 
socgradC2                              0.081144   0.007180  11.302  &lt; 2e-16 ***
socgradDE                              0.066996   0.007003   9.566  &lt; 2e-16 ***
maritalrelationship_living            -0.037934   0.007274  -5.215 1.85e-07 ***
maritalrelationship_notliving         -0.099229   0.010742  -9.237  &lt; 2e-16 ***
maritalseparated_divorced             -0.053277   0.009356  -5.694 1.25e-08 ***
maritalsingle                         -0.109253   0.006325 -17.273  &lt; 2e-16 ***
maritalwidowed                        -0.022845   0.013807  -1.655 0.098021 .  
religionhindu                          0.054758   0.019729   2.775 0.005515 ** 
religionmuslim                         0.012017   0.012720   0.945 0.344815    
religionnone                          -0.160887   0.005159 -31.185  &lt; 2e-16 ***
religionother                         -0.120911   0.013879  -8.712  &lt; 2e-16 ***
gendermale:age_groupyoung              0.043530   0.010085   4.316 1.59e-05 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

(Dispersion parameter for gaussian family taken to be 0.1490558)

Number of Fisher Scoring iterations: 2</code></pre>
</div>
<div class="sourceCode cell-code" id="cb113"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb113-1"><a href="#cb113-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Economic leftism model with gender*age_group interaction</span></span>
<span id="cb113-2"><a href="#cb113-2" aria-hidden="true" tabindex="-1"></a>model_economic_interaction <span class="ot">&lt;-</span> <span class="fu">svyglm</span>(</span>
<span id="cb113-3"><a href="#cb113-3" aria-hidden="true" tabindex="-1"></a>  economic_leftism <span class="sc">~</span> gender <span class="sc">*</span> age_group <span class="sc">+</span> education <span class="sc">+</span> ethnicity <span class="sc">+</span> region <span class="sc">+</span> </span>
<span id="cb113-4"><a href="#cb113-4" aria-hidden="true" tabindex="-1"></a>                    household <span class="sc">+</span> socgrad <span class="sc">+</span> marital <span class="sc">+</span> religion,</span>
<span id="cb113-5"><a href="#cb113-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">design =</span> survey_design_interaction</span>
<span id="cb113-6"><a href="#cb113-6" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb113-7"><a href="#cb113-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb113-8"><a href="#cb113-8" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(model_economic_interaction)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
svyglm(formula = economic_leftism ~ gender * age_group + education + 
    ethnicity + region + household + socgrad + marital + religion, 
    design = survey_design_interaction)

Survey design:
svydesign(ids = ~1, weights = ~wt, data = modeling_data_interaction)

Coefficients:
                                       Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)                            0.177378   0.015737  11.272  &lt; 2e-16 ***
gendermale                             0.026826   0.006198   4.328 1.51e-05 ***
age_groupyoung                         0.027044   0.006806   3.973 7.10e-05 ***
educationlow                          -0.007373   0.005640  -1.307 0.191120    
ethnicityblack                         0.005855   0.014992   0.391 0.696118    
ethnicitymixed                         0.061851   0.018088   3.419 0.000628 ***
ethnicityother                        -0.009987   0.027239  -0.367 0.713896    
ethnicitywhite                         0.023214   0.011342   2.047 0.040697 *  
regionEast of England                 -0.007338   0.011870  -0.618 0.536427    
regionGreater London                   0.009147   0.011464   0.798 0.424945    
regionNorth East England               0.030377   0.014275   2.128 0.033346 *  
regionNorth West England               0.057310   0.011136   5.146 2.67e-07 ***
regionScotland                         0.049003   0.012522   3.913 9.12e-05 ***
regionSouth East England              -0.029545   0.011197  -2.639 0.008326 ** 
regionSouth West England              -0.009432   0.012129  -0.778 0.436771    
regionWales                            0.033920   0.014669   2.312 0.020766 *  
regionWest Midlands                    0.005929   0.011957   0.496 0.620001    
regionYorkshire and the Humber         0.033041   0.012040   2.744 0.006070 ** 
householdowns_with_mortgage_or_shared  0.097294   0.006478  15.020  &lt; 2e-16 ***
householdprivate_rented_or_rent_free   0.117471   0.007076  16.602  &lt; 2e-16 ***
householdsocial_rented                 0.154591   0.007810  19.793  &lt; 2e-16 ***
socgradC1                              0.063920   0.006710   9.526  &lt; 2e-16 ***
socgradC2                              0.090474   0.007683  11.776  &lt; 2e-16 ***
socgradDE                              0.100502   0.007525  13.356  &lt; 2e-16 ***
maritalrelationship_living             0.032399   0.007380   4.390 1.14e-05 ***
maritalrelationship_notliving          0.050866   0.010785   4.716 2.41e-06 ***
maritalseparated_divorced             -0.010946   0.010547  -1.038 0.299338    
maritalsingle                          0.035399   0.006472   5.469 4.55e-08 ***
maritalwidowed                        -0.064339   0.016110  -3.994 6.52e-05 ***
religionhindu                          0.042256   0.021324   1.982 0.047527 *  
religionmuslim                         0.062365   0.013181   4.732 2.24e-06 ***
religionnone                           0.068310   0.005527  12.359  &lt; 2e-16 ***
religionother                          0.076867   0.014873   5.168 2.38e-07 ***
gendermale:age_groupyoung             -0.050812   0.010029  -5.066 4.08e-07 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

(Dispersion parameter for gaussian family taken to be 0.1592979)

Number of Fisher Scoring iterations: 2</code></pre>
</div>
</div>
<p>Social Conservatism - Gender x Age Interaction: Coefficient: 0.044 p-value: 0 Interpretation: Difference in male effect between young vs older</p>
<p>Economic Leftism - Gender x Age Interaction: Coefficient: -0.051 p-value: 0 Interpretation: Difference in male effect between young vs older</p>
<p>The relative effect is marginal between young and old. Not that important for our takeaway results. We already know that gender effects differ by age, so this proves it statistically.</p>
</section>
</section>
<section id="presentation-generation-visuals-etc." class="level4">
<h4 class="anchored" data-anchor-id="presentation-generation-visuals-etc.">6) Presentation generation, visuals etc.</h4>
<p>Come back to this at a later stage. Enough results for now to move onto the function generation. We’ll do this step in a separate document.</p>
</section>
<section id="extended-segment-analysis---intersectionality" class="level4">
<h4 class="anchored" data-anchor-id="extended-segment-analysis---intersectionality">7) Extended Segment Analysis - Intersectionality</h4>
<p><strong>What specifically is driving the change to the right-wing amongst younger men? Is the ongoing shift about women moving more left, or is it also about men moving more right</strong></p>
<p><strong>Can we find evidence for the claims posited in the article on this issue? Those made by Alice Evans?</strong></p>
<section id="vote-switching-left-to-right-shifters-2019-2024" class="level5">
<h5 class="anchored" data-anchor-id="vote-switching-left-to-right-shifters-2019-2024">Vote Switching: Left-to-Right Shifters 2019-2024</h5>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb115"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb115-1"><a href="#cb115-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Identify vote switchers from left-wing to right-wing parties</span></span>
<span id="cb115-2"><a href="#cb115-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Define party classifications</span></span>
<span id="cb115-3"><a href="#cb115-3" aria-hidden="true" tabindex="-1"></a>left_parties <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"lab"</span>, <span class="st">"grn"</span>, <span class="st">"ldm"</span>)  <span class="co"># Labour, Green, Lib Dem</span></span>
<span id="cb115-4"><a href="#cb115-4" aria-hidden="true" tabindex="-1"></a>right_parties <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"con"</span>, <span class="st">"rfm"</span>)        <span class="co"># Conservative, Reform</span></span>
<span id="cb115-5"><a href="#cb115-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-6"><a href="#cb115-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Create switching analysis dataset</span></span>
<span id="cb115-7"><a href="#cb115-7" aria-hidden="true" tabindex="-1"></a>vote_switchers <span class="ot">&lt;-</span> uk_data <span class="sc">%&gt;%</span></span>
<span id="cb115-8"><a href="#cb115-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(pv_2019) <span class="sc">&amp;</span> <span class="sc">!</span><span class="fu">is.na</span>(pv_2024)) <span class="sc">%&gt;%</span></span>
<span id="cb115-9"><a href="#cb115-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb115-10"><a href="#cb115-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">voted_left_2019 =</span> pv_2019 <span class="sc">%in%</span> left_parties,</span>
<span id="cb115-11"><a href="#cb115-11" aria-hidden="true" tabindex="-1"></a>    <span class="at">voted_right_2024 =</span> pv_2024 <span class="sc">%in%</span> right_parties,</span>
<span id="cb115-12"><a href="#cb115-12" aria-hidden="true" tabindex="-1"></a>    <span class="at">left_to_right_switch =</span> voted_left_2019 <span class="sc">&amp;</span> voted_right_2024</span>
<span id="cb115-13"><a href="#cb115-13" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb115-14"><a href="#cb115-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-15"><a href="#cb115-15" aria-hidden="true" tabindex="-1"></a><span class="co"># Summary of switching patterns</span></span>
<span id="cb115-16"><a href="#cb115-16" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"=== VOTE SWITCHING SUMMARY ===</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>=== VOTE SWITCHING SUMMARY ===</code></pre>
</div>
<div class="sourceCode cell-code" id="cb117"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb117-1"><a href="#cb117-1" aria-hidden="true" tabindex="-1"></a>switching_summary <span class="ot">&lt;-</span> vote_switchers <span class="sc">%&gt;%</span></span>
<span id="cb117-2"><a href="#cb117-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(voted_left_2019, voted_right_2024) <span class="sc">%&gt;%</span></span>
<span id="cb117-3"><a href="#cb117-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(</span>
<span id="cb117-4"><a href="#cb117-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">count =</span> <span class="fu">n</span>(),</span>
<span id="cb117-5"><a href="#cb117-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">weighted_count =</span> <span class="fu">sum</span>(wt, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb117-6"><a href="#cb117-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">.groups =</span> <span class="st">"drop"</span></span>
<span id="cb117-7"><a href="#cb117-7" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb117-8"><a href="#cb117-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">percentage =</span> <span class="fu">round</span>(weighted_count <span class="sc">/</span> <span class="fu">sum</span>(weighted_count) <span class="sc">*</span> <span class="dv">100</span>, <span class="dv">1</span>))</span>
<span id="cb117-9"><a href="#cb117-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb117-10"><a href="#cb117-10" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(switching_summary)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 4 × 5
  voted_left_2019 voted_right_2024 count weighted_count percentage
  &lt;lgl&gt;           &lt;lgl&gt;            &lt;int&gt;          &lt;dbl&gt;      &lt;dbl&gt;
1 FALSE           FALSE            10807         10614.       32.6
2 FALSE           TRUE              9398         10175.       31.2
3 TRUE            FALSE            11471         10912.       33.5
4 TRUE            TRUE               945           902.        2.8</code></pre>
</div>
<div class="sourceCode cell-code" id="cb119"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb119-1"><a href="#cb119-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Focus on left-to-right switchers</span></span>
<span id="cb119-2"><a href="#cb119-2" aria-hidden="true" tabindex="-1"></a>left_to_right_switchers <span class="ot">&lt;-</span> vote_switchers <span class="sc">%&gt;%</span></span>
<span id="cb119-3"><a href="#cb119-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(left_to_right_switch <span class="sc">==</span> <span class="cn">TRUE</span>)</span>
<span id="cb119-4"><a href="#cb119-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb119-5"><a href="#cb119-5" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">Total left-to-right switchers:"</span>, <span class="fu">nrow</span>(left_to_right_switchers))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Total left-to-right switchers: 945</code></pre>
</div>
<div class="sourceCode cell-code" id="cb121"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb121-1"><a href="#cb121-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">Weighted count:"</span>, <span class="fu">round</span>(<span class="fu">sum</span>(left_to_right_switchers<span class="sc">$</span>wt, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Weighted count: 902</code></pre>
</div>
<div class="sourceCode cell-code" id="cb123"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb123-1"><a href="#cb123-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Demographics of left-to-right switchers vs non-switchers</span></span>
<span id="cb123-2"><a href="#cb123-2" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">=== DEMOGRAPHICS OF LEFT-TO-RIGHT SWITCHERS ===</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
=== DEMOGRAPHICS OF LEFT-TO-RIGHT SWITCHERS ===</code></pre>
</div>
<div class="sourceCode cell-code" id="cb125"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb125-1"><a href="#cb125-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Gender breakdown</span></span>
<span id="cb125-2"><a href="#cb125-2" aria-hidden="true" tabindex="-1"></a>gender_switching <span class="ot">&lt;-</span> vote_switchers <span class="sc">%&gt;%</span></span>
<span id="cb125-3"><a href="#cb125-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(gender, left_to_right_switch) <span class="sc">%&gt;%</span></span>
<span id="cb125-4"><a href="#cb125-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(</span>
<span id="cb125-5"><a href="#cb125-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">weighted_count =</span> <span class="fu">sum</span>(wt, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb125-6"><a href="#cb125-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">.groups =</span> <span class="st">"keep"</span></span>
<span id="cb125-7"><a href="#cb125-7" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb125-8"><a href="#cb125-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(gender) <span class="sc">%&gt;%</span></span>
<span id="cb125-9"><a href="#cb125-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb125-10"><a href="#cb125-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">total =</span> <span class="fu">sum</span>(weighted_count),</span>
<span id="cb125-11"><a href="#cb125-11" aria-hidden="true" tabindex="-1"></a>    <span class="at">switch_rate =</span> <span class="fu">round</span>(weighted_count[left_to_right_switch <span class="sc">==</span> <span class="cn">TRUE</span>] <span class="sc">/</span> total <span class="sc">*</span> <span class="dv">100</span>, <span class="dv">1</span>)</span>
<span id="cb125-12"><a href="#cb125-12" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb125-13"><a href="#cb125-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(left_to_right_switch <span class="sc">==</span> <span class="cn">TRUE</span>) <span class="sc">%&gt;%</span></span>
<span id="cb125-14"><a href="#cb125-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(gender, switch_rate)</span>
<span id="cb125-15"><a href="#cb125-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb125-16"><a href="#cb125-16" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="st">"Left-to-right switching rates by gender:"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Left-to-right switching rates by gender:"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb127"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb127-1"><a href="#cb127-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(gender_switching)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 2 × 2
# Groups:   gender [2]
  gender switch_rate
  &lt;chr&gt;        &lt;dbl&gt;
1 female         3  
2 male           2.6</code></pre>
</div>
<div class="sourceCode cell-code" id="cb129"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb129-1"><a href="#cb129-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Age breakdown</span></span>
<span id="cb129-2"><a href="#cb129-2" aria-hidden="true" tabindex="-1"></a>age_switching <span class="ot">&lt;-</span> vote_switchers <span class="sc">%&gt;%</span></span>
<span id="cb129-3"><a href="#cb129-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(age, left_to_right_switch) <span class="sc">%&gt;%</span></span>
<span id="cb129-4"><a href="#cb129-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(</span>
<span id="cb129-5"><a href="#cb129-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">weighted_count =</span> <span class="fu">sum</span>(wt, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb129-6"><a href="#cb129-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">.groups =</span> <span class="st">"keep"</span></span>
<span id="cb129-7"><a href="#cb129-7" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb129-8"><a href="#cb129-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(age) <span class="sc">%&gt;%</span></span>
<span id="cb129-9"><a href="#cb129-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb129-10"><a href="#cb129-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">total =</span> <span class="fu">sum</span>(weighted_count),</span>
<span id="cb129-11"><a href="#cb129-11" aria-hidden="true" tabindex="-1"></a>    <span class="at">switch_rate =</span> <span class="fu">round</span>(weighted_count[left_to_right_switch <span class="sc">==</span> <span class="cn">TRUE</span>] <span class="sc">/</span> total <span class="sc">*</span> <span class="dv">100</span>, <span class="dv">1</span>)</span>
<span id="cb129-12"><a href="#cb129-12" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb129-13"><a href="#cb129-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(left_to_right_switch <span class="sc">==</span> <span class="cn">TRUE</span>) <span class="sc">%&gt;%</span></span>
<span id="cb129-14"><a href="#cb129-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(age, switch_rate) <span class="sc">%&gt;%</span></span>
<span id="cb129-15"><a href="#cb129-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(switch_rate))</span>
<span id="cb129-16"><a href="#cb129-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-17"><a href="#cb129-17" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">Left-to-right switching rates by age:"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "\nLeft-to-right switching rates by age:"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb131"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb131-1"><a href="#cb131-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(age_switching)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 7 × 2
# Groups:   age [7]
  age      switch_rate
  &lt;chr&gt;          &lt;dbl&gt;
1 25_TO_34         3.9
2 35_TO_44         3.4
3 45_TO_54         2.7
4 55_TO_64         2.6
5 18_TO_24         2.3
6 65_TO_74         1.9
7 75_PLUS          1.9</code></pre>
</div>
<div class="sourceCode cell-code" id="cb133"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb133-1"><a href="#cb133-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Education breakdown</span></span>
<span id="cb133-2"><a href="#cb133-2" aria-hidden="true" tabindex="-1"></a>education_switching <span class="ot">&lt;-</span> vote_switchers <span class="sc">%&gt;%</span></span>
<span id="cb133-3"><a href="#cb133-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(education)) <span class="sc">%&gt;%</span></span>
<span id="cb133-4"><a href="#cb133-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(education, left_to_right_switch) <span class="sc">%&gt;%</span></span>
<span id="cb133-5"><a href="#cb133-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(</span>
<span id="cb133-6"><a href="#cb133-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">weighted_count =</span> <span class="fu">sum</span>(wt, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb133-7"><a href="#cb133-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">.groups =</span> <span class="st">"keep"</span></span>
<span id="cb133-8"><a href="#cb133-8" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb133-9"><a href="#cb133-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(education) <span class="sc">%&gt;%</span></span>
<span id="cb133-10"><a href="#cb133-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb133-11"><a href="#cb133-11" aria-hidden="true" tabindex="-1"></a>    <span class="at">total =</span> <span class="fu">sum</span>(weighted_count),</span>
<span id="cb133-12"><a href="#cb133-12" aria-hidden="true" tabindex="-1"></a>    <span class="at">switch_rate =</span> <span class="fu">round</span>(weighted_count[left_to_right_switch <span class="sc">==</span> <span class="cn">TRUE</span>] <span class="sc">/</span> total <span class="sc">*</span> <span class="dv">100</span>, <span class="dv">1</span>)</span>
<span id="cb133-13"><a href="#cb133-13" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb133-14"><a href="#cb133-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(left_to_right_switch <span class="sc">==</span> <span class="cn">TRUE</span>) <span class="sc">%&gt;%</span></span>
<span id="cb133-15"><a href="#cb133-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(education, switch_rate)</span>
<span id="cb133-16"><a href="#cb133-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb133-17"><a href="#cb133-17" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">Left-to-right switching rates by education:"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "\nLeft-to-right switching rates by education:"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb135"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb135-1"><a href="#cb135-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(education_switching)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 2 × 2
# Groups:   education [2]
  education switch_rate
  &lt;chr&gt;           &lt;dbl&gt;
1 high              2.9
2 low               2.7</code></pre>
</div>
<div class="sourceCode cell-code" id="cb137"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb137-1"><a href="#cb137-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Predictive model for left-to-right switching</span></span>
<span id="cb137-2"><a href="#cb137-2" aria-hidden="true" tabindex="-1"></a>switching_model <span class="ot">&lt;-</span> vote_switchers <span class="sc">%&gt;%</span></span>
<span id="cb137-3"><a href="#cb137-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(gender) <span class="sc">&amp;</span> <span class="sc">!</span><span class="fu">is.na</span>(age) <span class="sc">&amp;</span> <span class="sc">!</span><span class="fu">is.na</span>(education) <span class="sc">&amp;</span> <span class="sc">!</span><span class="fu">is.na</span>(ethnicity))</span>
<span id="cb137-4"><a href="#cb137-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb137-5"><a href="#cb137-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Create survey design for switching analysis</span></span>
<span id="cb137-6"><a href="#cb137-6" aria-hidden="true" tabindex="-1"></a>survey_design_switching <span class="ot">&lt;-</span> <span class="fu">svydesign</span>(</span>
<span id="cb137-7"><a href="#cb137-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">ids =</span> <span class="sc">~</span><span class="dv">1</span>,</span>
<span id="cb137-8"><a href="#cb137-8" aria-hidden="true" tabindex="-1"></a>  <span class="at">weights =</span> <span class="sc">~</span>wt,</span>
<span id="cb137-9"><a href="#cb137-9" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> switching_model</span>
<span id="cb137-10"><a href="#cb137-10" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb137-11"><a href="#cb137-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb137-12"><a href="#cb137-12" aria-hidden="true" tabindex="-1"></a><span class="co"># Logistic regression predicting left-to-right switching</span></span>
<span id="cb137-13"><a href="#cb137-13" aria-hidden="true" tabindex="-1"></a>switch_prediction_model <span class="ot">&lt;-</span> <span class="fu">svyglm</span>(</span>
<span id="cb137-14"><a href="#cb137-14" aria-hidden="true" tabindex="-1"></a>  left_to_right_switch <span class="sc">~</span> gender <span class="sc">*</span> age <span class="sc">+</span> gender <span class="sc">*</span> education <span class="sc">+</span> age <span class="sc">*</span> education <span class="sc">+</span> </span>
<span id="cb137-15"><a href="#cb137-15" aria-hidden="true" tabindex="-1"></a>                       gender <span class="sc">*</span> region <span class="sc">+</span> ethnicity <span class="sc">+</span> household <span class="sc">+</span> socgrad <span class="sc">+</span> </span>
<span id="cb137-16"><a href="#cb137-16" aria-hidden="true" tabindex="-1"></a>                       marital <span class="sc">+</span> religion,</span>
<span id="cb137-17"><a href="#cb137-17" aria-hidden="true" tabindex="-1"></a>  <span class="at">design =</span> survey_design_switching,</span>
<span id="cb137-18"><a href="#cb137-18" aria-hidden="true" tabindex="-1"></a>  <span class="at">family =</span> <span class="fu">binomial</span>(<span class="at">link =</span> <span class="st">"logit"</span>)</span>
<span id="cb137-19"><a href="#cb137-19" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb137-20"><a href="#cb137-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb137-21"><a href="#cb137-21" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(switch_prediction_model)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
svyglm(formula = left_to_right_switch ~ gender * age + gender * 
    education + age * education + gender * region + ethnicity + 
    household + socgrad + marital + religion, design = survey_design_switching, 
    family = binomial(link = "logit"))

Survey design:
svydesign(ids = ~1, weights = ~wt, data = switching_model)

Coefficients:
                                           Estimate Std. Error t value Pr(&gt;|t|)
(Intercept)                               -3.477061   0.323112 -10.761  &lt; 2e-16
gendermale                                -0.420732   0.368737  -1.141  0.25388
age25_TO_34                                0.190028   0.246642   0.770  0.44103
age35_TO_44                                0.046385   0.258950   0.179  0.85784
age45_TO_54                               -0.147148   0.275874  -0.533  0.59377
age55_TO_64                               -0.218761   0.298511  -0.733  0.46366
age65_TO_74                               -1.427000   0.450267  -3.169  0.00153
age75_PLUS                                 0.415174   0.386116   1.075  0.28227
educationlow                              -0.287415   0.248342  -1.157  0.24714
regionEast of England                     -0.259274   0.214548  -1.208  0.22688
regionGreater London                      -0.214347   0.202048  -1.061  0.28875
regionNorth East England                   0.032262   0.230178   0.140  0.88853
regionNorth West England                  -0.226320   0.201482  -1.123  0.26133
regionScotland                            -1.535163   0.329381  -4.661 3.16e-06
regionSouth East England                  -0.154306   0.194547  -0.793  0.42769
regionSouth West England                  -0.433223   0.221467  -1.956  0.05046
regionWales                               -0.183395   0.268584  -0.683  0.49472
regionWest Midlands                       -0.194144   0.222813  -0.871  0.38358
regionYorkshire and the Humber            -0.200906   0.211827  -0.948  0.34291
ethnicityblack                             0.150770   0.207130   0.728  0.46668
ethnicitymixed                            -0.050478   0.287352  -0.176  0.86056
ethnicityother                            -0.109985   0.477121  -0.231  0.81769
ethnicitywhite                             0.216660   0.168075   1.289  0.19738
householdowns_with_mortgage_or_shared      0.119206   0.101709   1.172  0.24119
householdprivate_rented_or_rent_free      -0.028922   0.115351  -0.251  0.80202
householdsocial_rented                     0.133275   0.117884   1.131  0.25825
socgradC1                                  0.114118   0.096708   1.180  0.23800
socgradC2                                  0.036590   0.111399   0.328  0.74257
socgradDE                                 -0.032501   0.117438  -0.277  0.78197
maritalrelationship_living                 0.186650   0.108970   1.713  0.08675
maritalrelationship_notliving              0.080344   0.169563   0.474  0.63563
maritalseparated_divorced                  0.124522   0.141934   0.877  0.38032
maritalsingle                              0.142042   0.107207   1.325  0.18520
maritalwidowed                            -0.225601   0.312762  -0.721  0.47072
religionhindu                              0.342448   0.268841   1.274  0.20275
religionmuslim                             0.151838   0.181020   0.839  0.40159
religionnone                              -0.354053   0.081635  -4.337 1.45e-05
religionother                             -0.127866   0.192221  -0.665  0.50592
gendermale:age25_TO_34                     0.169799   0.282090   0.602  0.54722
gendermale:age35_TO_44                     0.005854   0.287195   0.020  0.98374
gendermale:age45_TO_54                    -0.001737   0.300390  -0.006  0.99539
gendermale:age55_TO_64                     0.056750   0.309463   0.183  0.85450
gendermale:age65_TO_74                     0.020872   0.349888   0.060  0.95243
gendermale:age75_PLUS                     -0.399866   0.449247  -0.890  0.37343
gendermale:educationlow                   -0.310405   0.150866  -2.057  0.03965
age25_TO_34:educationlow                   0.491474   0.275206   1.786  0.07413
age35_TO_44:educationlow                   0.605962   0.281013   2.156  0.03106
age45_TO_54:educationlow                   0.487670   0.294171   1.658  0.09737
age55_TO_64:educationlow                   0.514129   0.312876   1.643  0.10034
age65_TO_74:educationlow                   1.590990   0.464205   3.427  0.00061
age75_PLUS:educationlow                   -0.441617   0.440474  -1.003  0.31606
gendermale:regionEast of England           0.154026   0.368944   0.417  0.67633
gendermale:regionGreater London            0.459524   0.334236   1.375  0.16919
gendermale:regionNorth East England        0.650517   0.394651   1.648  0.09929
gendermale:regionNorth West England        0.698648   0.335836   2.080  0.03750
gendermale:regionScotland                  1.214550   0.475829   2.552  0.01070
gendermale:regionSouth East England        0.319264   0.341057   0.936  0.34923
gendermale:regionSouth West England        0.671735   0.378010   1.777  0.07557
gendermale:regionWales                     0.540198   0.423184   1.277  0.20179
gendermale:regionWest Midlands             0.338941   0.367357   0.923  0.35620
gendermale:regionYorkshire and the Humber  0.605824   0.353836   1.712  0.08688
                                             
(Intercept)                               ***
gendermale                                   
age25_TO_34                                  
age35_TO_44                                  
age45_TO_54                                  
age55_TO_64                                  
age65_TO_74                               ** 
age75_PLUS                                   
educationlow                                 
regionEast of England                        
regionGreater London                         
regionNorth East England                     
regionNorth West England                     
regionScotland                            ***
regionSouth East England                     
regionSouth West England                  .  
regionWales                                  
regionWest Midlands                          
regionYorkshire and the Humber               
ethnicityblack                               
ethnicitymixed                               
ethnicityother                               
ethnicitywhite                               
householdowns_with_mortgage_or_shared        
householdprivate_rented_or_rent_free         
householdsocial_rented                       
socgradC1                                    
socgradC2                                    
socgradDE                                    
maritalrelationship_living                .  
maritalrelationship_notliving                
maritalseparated_divorced                    
maritalsingle                                
maritalwidowed                               
religionhindu                                
religionmuslim                               
religionnone                              ***
religionother                                
gendermale:age25_TO_34                       
gendermale:age35_TO_44                       
gendermale:age45_TO_54                       
gendermale:age55_TO_64                       
gendermale:age65_TO_74                       
gendermale:age75_PLUS                        
gendermale:educationlow                   *  
age25_TO_34:educationlow                  .  
age35_TO_44:educationlow                  *  
age45_TO_54:educationlow                  .  
age55_TO_64:educationlow                     
age65_TO_74:educationlow                  ***
age75_PLUS:educationlow                      
gendermale:regionEast of England             
gendermale:regionGreater London              
gendermale:regionNorth East England       .  
gendermale:regionNorth West England       *  
gendermale:regionScotland                 *  
gendermale:regionSouth East England          
gendermale:regionSouth West England       .  
gendermale:regionWales                       
gendermale:regionWest Midlands               
gendermale:regionYorkshire and the Humber .  
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

(Dispersion parameter for binomial family taken to be 0.9939905)

Number of Fisher Scoring iterations: 7</code></pre>
</div>
<div class="sourceCode cell-code" id="cb139"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb139-1"><a href="#cb139-1" aria-hidden="true" tabindex="-1"></a><span class="fu">nobs</span>(switch_prediction_model)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 32005</code></pre>
</div>
</div>
<p>Switch rate represents the percentage of that group which switched from left to right in terms of party vote.</p>
<p>Being aged 25 to 34 is positively associated with switching from left to right in terms of party vote. Further analysis can be done on this and on the specific points, if it’s deemed necessary down the line.</p>
</section>
<section id="vote-switching-right-to-left-shifters-2019-2024" class="level5">
<h5 class="anchored" data-anchor-id="vote-switching-right-to-left-shifters-2019-2024">Vote Switching: Right-to-Left Shifters 2019-2024</h5>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb141"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb141-1"><a href="#cb141-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Identify vote switchers from right-wing to left-wing parties</span></span>
<span id="cb141-2"><a href="#cb141-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Using same party classifications as above</span></span>
<span id="cb141-3"><a href="#cb141-3" aria-hidden="true" tabindex="-1"></a><span class="co"># left_parties &lt;- c("lab", "grn", "ldm")  # Labour, Green, Lib Dem</span></span>
<span id="cb141-4"><a href="#cb141-4" aria-hidden="true" tabindex="-1"></a><span class="co"># right_parties &lt;- c("con", "rfm")        # Conservative, Reform</span></span>
<span id="cb141-5"><a href="#cb141-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb141-6"><a href="#cb141-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Create right-to-left switching analysis dataset</span></span>
<span id="cb141-7"><a href="#cb141-7" aria-hidden="true" tabindex="-1"></a>vote_switchers_rtl <span class="ot">&lt;-</span> uk_data <span class="sc">%&gt;%</span></span>
<span id="cb141-8"><a href="#cb141-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(pv_2019) <span class="sc">&amp;</span> <span class="sc">!</span><span class="fu">is.na</span>(pv_2024)) <span class="sc">%&gt;%</span></span>
<span id="cb141-9"><a href="#cb141-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb141-10"><a href="#cb141-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">voted_right_2019 =</span> pv_2019 <span class="sc">%in%</span> right_parties,</span>
<span id="cb141-11"><a href="#cb141-11" aria-hidden="true" tabindex="-1"></a>    <span class="at">voted_left_2024 =</span> pv_2024 <span class="sc">%in%</span> left_parties,</span>
<span id="cb141-12"><a href="#cb141-12" aria-hidden="true" tabindex="-1"></a>    <span class="at">right_to_left_switch =</span> voted_right_2019 <span class="sc">&amp;</span> voted_left_2024</span>
<span id="cb141-13"><a href="#cb141-13" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb141-14"><a href="#cb141-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb141-15"><a href="#cb141-15" aria-hidden="true" tabindex="-1"></a><span class="co"># Summary of right-to-left switching patterns</span></span>
<span id="cb141-16"><a href="#cb141-16" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"=== RIGHT-TO-LEFT VOTE SWITCHING SUMMARY ===</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>=== RIGHT-TO-LEFT VOTE SWITCHING SUMMARY ===</code></pre>
</div>
<div class="sourceCode cell-code" id="cb143"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb143-1"><a href="#cb143-1" aria-hidden="true" tabindex="-1"></a>switching_summary_rtl <span class="ot">&lt;-</span> vote_switchers_rtl <span class="sc">%&gt;%</span></span>
<span id="cb143-2"><a href="#cb143-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(voted_right_2019, voted_left_2024) <span class="sc">%&gt;%</span></span>
<span id="cb143-3"><a href="#cb143-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(</span>
<span id="cb143-4"><a href="#cb143-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">count =</span> <span class="fu">n</span>(),</span>
<span id="cb143-5"><a href="#cb143-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">weighted_count =</span> <span class="fu">sum</span>(wt, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb143-6"><a href="#cb143-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">.groups =</span> <span class="st">"drop"</span></span>
<span id="cb143-7"><a href="#cb143-7" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb143-8"><a href="#cb143-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">percentage =</span> <span class="fu">round</span>(weighted_count <span class="sc">/</span> <span class="fu">sum</span>(weighted_count) <span class="sc">*</span> <span class="dv">100</span>, <span class="dv">1</span>))</span>
<span id="cb143-9"><a href="#cb143-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb143-10"><a href="#cb143-10" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(switching_summary_rtl)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 4 × 5
  voted_right_2019 voted_left_2024 count weighted_count percentage
  &lt;lgl&gt;            &lt;lgl&gt;           &lt;int&gt;          &lt;dbl&gt;      &lt;dbl&gt;
1 FALSE            FALSE            6791          6774.       20.8
2 FALSE            TRUE            15480         14658.       45  
3 TRUE             FALSE            7605          8432.       25.9
4 TRUE             TRUE             2745          2741.        8.4</code></pre>
</div>
<div class="sourceCode cell-code" id="cb145"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb145-1"><a href="#cb145-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Focus on right-to-left switchers</span></span>
<span id="cb145-2"><a href="#cb145-2" aria-hidden="true" tabindex="-1"></a>right_to_left_switchers <span class="ot">&lt;-</span> vote_switchers_rtl <span class="sc">%&gt;%</span></span>
<span id="cb145-3"><a href="#cb145-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(right_to_left_switch <span class="sc">==</span> <span class="cn">TRUE</span>)</span>
<span id="cb145-4"><a href="#cb145-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb145-5"><a href="#cb145-5" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">Total right-to-left switchers:"</span>, <span class="fu">nrow</span>(right_to_left_switchers))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Total right-to-left switchers: 2745</code></pre>
</div>
<div class="sourceCode cell-code" id="cb147"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb147-1"><a href="#cb147-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">Weighted count:"</span>, <span class="fu">round</span>(<span class="fu">sum</span>(right_to_left_switchers<span class="sc">$</span>wt, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Weighted count: 2741</code></pre>
</div>
<div class="sourceCode cell-code" id="cb149"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb149-1"><a href="#cb149-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Demographics of right-to-left switchers vs non-switchers</span></span>
<span id="cb149-2"><a href="#cb149-2" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">=== DEMOGRAPHICS OF RIGHT-TO-LEFT SWITCHERS ===</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
=== DEMOGRAPHICS OF RIGHT-TO-LEFT SWITCHERS ===</code></pre>
</div>
<div class="sourceCode cell-code" id="cb151"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb151-1"><a href="#cb151-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Gender breakdown</span></span>
<span id="cb151-2"><a href="#cb151-2" aria-hidden="true" tabindex="-1"></a>gender_switching_rtl <span class="ot">&lt;-</span> vote_switchers_rtl <span class="sc">%&gt;%</span></span>
<span id="cb151-3"><a href="#cb151-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(gender, right_to_left_switch) <span class="sc">%&gt;%</span></span>
<span id="cb151-4"><a href="#cb151-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(</span>
<span id="cb151-5"><a href="#cb151-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">weighted_count =</span> <span class="fu">sum</span>(wt, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb151-6"><a href="#cb151-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">.groups =</span> <span class="st">"keep"</span></span>
<span id="cb151-7"><a href="#cb151-7" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb151-8"><a href="#cb151-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(gender) <span class="sc">%&gt;%</span></span>
<span id="cb151-9"><a href="#cb151-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb151-10"><a href="#cb151-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">total =</span> <span class="fu">sum</span>(weighted_count),</span>
<span id="cb151-11"><a href="#cb151-11" aria-hidden="true" tabindex="-1"></a>    <span class="at">switch_rate =</span> <span class="fu">round</span>(weighted_count[right_to_left_switch <span class="sc">==</span> <span class="cn">TRUE</span>] <span class="sc">/</span> total <span class="sc">*</span> <span class="dv">100</span>, <span class="dv">1</span>)</span>
<span id="cb151-12"><a href="#cb151-12" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb151-13"><a href="#cb151-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(right_to_left_switch <span class="sc">==</span> <span class="cn">TRUE</span>) <span class="sc">%&gt;%</span></span>
<span id="cb151-14"><a href="#cb151-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(gender, switch_rate)</span>
<span id="cb151-15"><a href="#cb151-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb151-16"><a href="#cb151-16" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="st">"Right-to-left switching rates by gender:"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Right-to-left switching rates by gender:"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb153"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb153-1"><a href="#cb153-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(gender_switching_rtl)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 2 × 2
# Groups:   gender [2]
  gender switch_rate
  &lt;chr&gt;        &lt;dbl&gt;
1 female         8  
2 male           8.8</code></pre>
</div>
<div class="sourceCode cell-code" id="cb155"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb155-1"><a href="#cb155-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Age breakdown</span></span>
<span id="cb155-2"><a href="#cb155-2" aria-hidden="true" tabindex="-1"></a>age_switching_rtl <span class="ot">&lt;-</span> vote_switchers_rtl <span class="sc">%&gt;%</span></span>
<span id="cb155-3"><a href="#cb155-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(age, right_to_left_switch) <span class="sc">%&gt;%</span></span>
<span id="cb155-4"><a href="#cb155-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(</span>
<span id="cb155-5"><a href="#cb155-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">weighted_count =</span> <span class="fu">sum</span>(wt, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb155-6"><a href="#cb155-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">.groups =</span> <span class="st">"keep"</span></span>
<span id="cb155-7"><a href="#cb155-7" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb155-8"><a href="#cb155-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(age) <span class="sc">%&gt;%</span></span>
<span id="cb155-9"><a href="#cb155-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb155-10"><a href="#cb155-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">total =</span> <span class="fu">sum</span>(weighted_count),</span>
<span id="cb155-11"><a href="#cb155-11" aria-hidden="true" tabindex="-1"></a>    <span class="at">switch_rate =</span> <span class="fu">round</span>(weighted_count[right_to_left_switch <span class="sc">==</span> <span class="cn">TRUE</span>] <span class="sc">/</span> total <span class="sc">*</span> <span class="dv">100</span>, <span class="dv">1</span>)</span>
<span id="cb155-12"><a href="#cb155-12" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb155-13"><a href="#cb155-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(right_to_left_switch <span class="sc">==</span> <span class="cn">TRUE</span>) <span class="sc">%&gt;%</span></span>
<span id="cb155-14"><a href="#cb155-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(age, switch_rate) <span class="sc">%&gt;%</span></span>
<span id="cb155-15"><a href="#cb155-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(switch_rate))</span>
<span id="cb155-16"><a href="#cb155-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb155-17"><a href="#cb155-17" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">Right-to-left switching rates by age:"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "\nRight-to-left switching rates by age:"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb157"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb157-1"><a href="#cb157-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(age_switching_rtl)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 7 × 2
# Groups:   age [7]
  age      switch_rate
  &lt;chr&gt;          &lt;dbl&gt;
1 55_TO_64        10.5
2 45_TO_54         9.7
3 35_TO_44         9.5
4 75_PLUS          9.3
5 65_TO_74         8.3
6 25_TO_34         7.5
7 18_TO_24         2.1</code></pre>
</div>
<div class="sourceCode cell-code" id="cb159"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb159-1"><a href="#cb159-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Education breakdown</span></span>
<span id="cb159-2"><a href="#cb159-2" aria-hidden="true" tabindex="-1"></a>education_switching_rtl <span class="ot">&lt;-</span> vote_switchers_rtl <span class="sc">%&gt;%</span></span>
<span id="cb159-3"><a href="#cb159-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(education)) <span class="sc">%&gt;%</span></span>
<span id="cb159-4"><a href="#cb159-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(education, right_to_left_switch) <span class="sc">%&gt;%</span></span>
<span id="cb159-5"><a href="#cb159-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(</span>
<span id="cb159-6"><a href="#cb159-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">weighted_count =</span> <span class="fu">sum</span>(wt, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb159-7"><a href="#cb159-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">.groups =</span> <span class="st">"keep"</span></span>
<span id="cb159-8"><a href="#cb159-8" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb159-9"><a href="#cb159-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(education) <span class="sc">%&gt;%</span></span>
<span id="cb159-10"><a href="#cb159-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb159-11"><a href="#cb159-11" aria-hidden="true" tabindex="-1"></a>    <span class="at">total =</span> <span class="fu">sum</span>(weighted_count),</span>
<span id="cb159-12"><a href="#cb159-12" aria-hidden="true" tabindex="-1"></a>    <span class="at">switch_rate =</span> <span class="fu">round</span>(weighted_count[right_to_left_switch <span class="sc">==</span> <span class="cn">TRUE</span>] <span class="sc">/</span> total <span class="sc">*</span> <span class="dv">100</span>, <span class="dv">1</span>)</span>
<span id="cb159-13"><a href="#cb159-13" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb159-14"><a href="#cb159-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(right_to_left_switch <span class="sc">==</span> <span class="cn">TRUE</span>) <span class="sc">%&gt;%</span></span>
<span id="cb159-15"><a href="#cb159-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(education, switch_rate)</span>
<span id="cb159-16"><a href="#cb159-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb159-17"><a href="#cb159-17" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">Right-to-left switching rates by education:"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "\nRight-to-left switching rates by education:"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb161"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb161-1"><a href="#cb161-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(education_switching_rtl)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 2 × 2
# Groups:   education [2]
  education switch_rate
  &lt;chr&gt;           &lt;dbl&gt;
1 high              9.1
2 low               8  </code></pre>
</div>
<div class="sourceCode cell-code" id="cb163"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb163-1"><a href="#cb163-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Predictive model for right-to-left switching</span></span>
<span id="cb163-2"><a href="#cb163-2" aria-hidden="true" tabindex="-1"></a>switching_model_rtl <span class="ot">&lt;-</span> vote_switchers_rtl <span class="sc">%&gt;%</span></span>
<span id="cb163-3"><a href="#cb163-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(gender) <span class="sc">&amp;</span> <span class="sc">!</span><span class="fu">is.na</span>(age) <span class="sc">&amp;</span> <span class="sc">!</span><span class="fu">is.na</span>(education) <span class="sc">&amp;</span> <span class="sc">!</span><span class="fu">is.na</span>(ethnicity))</span>
<span id="cb163-4"><a href="#cb163-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb163-5"><a href="#cb163-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Create survey design for right-to-left switching analysis</span></span>
<span id="cb163-6"><a href="#cb163-6" aria-hidden="true" tabindex="-1"></a>survey_design_switching_rtl <span class="ot">&lt;-</span> <span class="fu">svydesign</span>(</span>
<span id="cb163-7"><a href="#cb163-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">ids =</span> <span class="sc">~</span><span class="dv">1</span>,</span>
<span id="cb163-8"><a href="#cb163-8" aria-hidden="true" tabindex="-1"></a>  <span class="at">weights =</span> <span class="sc">~</span>wt,</span>
<span id="cb163-9"><a href="#cb163-9" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> switching_model_rtl</span>
<span id="cb163-10"><a href="#cb163-10" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb163-11"><a href="#cb163-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb163-12"><a href="#cb163-12" aria-hidden="true" tabindex="-1"></a><span class="co"># Logistic regression predicting right-to-left switching</span></span>
<span id="cb163-13"><a href="#cb163-13" aria-hidden="true" tabindex="-1"></a>switch_prediction_model_rtl <span class="ot">&lt;-</span> <span class="fu">svyglm</span>(</span>
<span id="cb163-14"><a href="#cb163-14" aria-hidden="true" tabindex="-1"></a>  right_to_left_switch <span class="sc">~</span> gender <span class="sc">*</span> age <span class="sc">+</span> gender <span class="sc">*</span> education <span class="sc">+</span> age <span class="sc">*</span> education <span class="sc">+</span> </span>
<span id="cb163-15"><a href="#cb163-15" aria-hidden="true" tabindex="-1"></a>                       gender <span class="sc">*</span> region <span class="sc">+</span> ethnicity <span class="sc">+</span> household <span class="sc">+</span> socgrad <span class="sc">+</span> </span>
<span id="cb163-16"><a href="#cb163-16" aria-hidden="true" tabindex="-1"></a>                       marital <span class="sc">+</span> religion,</span>
<span id="cb163-17"><a href="#cb163-17" aria-hidden="true" tabindex="-1"></a>  <span class="at">design =</span> survey_design_switching_rtl,</span>
<span id="cb163-18"><a href="#cb163-18" aria-hidden="true" tabindex="-1"></a>  <span class="at">family =</span> <span class="fu">binomial</span>(<span class="at">link =</span> <span class="st">"logit"</span>)</span>
<span id="cb163-19"><a href="#cb163-19" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb163-20"><a href="#cb163-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb163-21"><a href="#cb163-21" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(switch_prediction_model_rtl)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
svyglm(formula = right_to_left_switch ~ gender * age + gender * 
    education + age * education + gender * region + ethnicity + 
    household + socgrad + marital + religion, design = survey_design_switching_rtl, 
    family = binomial(link = "logit"))

Survey design:
svydesign(ids = ~1, weights = ~wt, data = switching_model_rtl)

Coefficients:
                                          Estimate Std. Error t value Pr(&gt;|t|)
(Intercept)                               -2.88592    0.25185 -11.459  &lt; 2e-16
gendermale                                 0.56205    0.27379   2.053 0.040092
age25_TO_34                                0.92281    0.20935   4.408 1.05e-05
age35_TO_44                                0.96796    0.21027   4.603 4.17e-06
age45_TO_54                                1.06415    0.21327   4.990 6.08e-07
age55_TO_64                                1.14027    0.21964   5.192 2.10e-07
age65_TO_74                                0.86256    0.24108   3.578 0.000347
age75_PLUS                                 1.12598    0.28085   4.009 6.11e-05
educationlow                              -0.95376    0.23891  -3.992 6.56e-05
regionEast of England                      0.10988    0.13205   0.832 0.405353
regionGreater London                      -0.27823    0.13453  -2.068 0.038628
regionNorth East England                  -0.38475    0.17606  -2.185 0.028876
regionNorth West England                  -0.26566    0.13507  -1.967 0.049207
regionScotland                            -0.55198    0.16374  -3.371 0.000750
regionSouth East England                   0.05957    0.12271   0.485 0.627373
regionSouth West England                   0.23633    0.12983   1.820 0.068718
regionWales                               -0.72970    0.18972  -3.846 0.000120
regionWest Midlands                       -0.04374    0.13704  -0.319 0.749607
regionYorkshire and the Humber            -0.10480    0.14078  -0.744 0.456633
ethnicityblack                            -0.01190    0.14710  -0.081 0.935514
ethnicitymixed                             0.09533    0.18157   0.525 0.599578
ethnicityother                            -0.26975    0.34769  -0.776 0.437849
ethnicitywhite                            -0.02851    0.11636  -0.245 0.806425
householdowns_with_mortgage_or_shared      0.10970    0.05966   1.839 0.065962
householdprivate_rented_or_rent_free      -0.07752    0.07100  -1.092 0.274890
householdsocial_rented                    -0.19479    0.08184  -2.380 0.017318
socgradC1                                 -0.03479    0.05761  -0.604 0.545869
socgradC2                                 -0.08241    0.06948  -1.186 0.235555
socgradDE                                 -0.10107    0.07054  -1.433 0.151918
maritalrelationship_living                -0.15179    0.06761  -2.245 0.024767
maritalrelationship_notliving             -0.20021    0.10824  -1.850 0.064372
maritalseparated_divorced                 -0.08146    0.08523  -0.956 0.339147
maritalsingle                             -0.42655    0.06443  -6.620 3.64e-11
maritalwidowed                            -0.12411    0.13587  -0.913 0.361004
religionhindu                             -0.10465    0.18741  -0.558 0.576565
religionmuslim                            -0.49830    0.15140  -3.291 0.000998
religionnone                              -0.28604    0.04800  -5.959 2.57e-09
religionother                             -0.25549    0.13137  -1.945 0.051806
gendermale:age25_TO_34                    -0.52414    0.25072  -2.091 0.036579
gendermale:age35_TO_44                    -0.50560    0.24711  -2.046 0.040757
gendermale:age45_TO_54                    -0.53198    0.24813  -2.144 0.032045
gendermale:age55_TO_64                    -0.61595    0.25014  -2.462 0.013807
gendermale:age65_TO_74                    -0.80345    0.26193  -3.067 0.002161
gendermale:age75_PLUS                     -0.89831    0.29575  -3.037 0.002388
gendermale:educationlow                   -0.02247    0.09007  -0.249 0.803043
age25_TO_34:educationlow                   0.78419    0.25400   3.087 0.002021
age35_TO_44:educationlow                   1.04954    0.24918   4.212 2.54e-05
age45_TO_54:educationlow                   0.95461    0.25007   3.817 0.000135
age55_TO_64:educationlow                   0.94841    0.25281   3.751 0.000176
age65_TO_74:educationlow                   1.01906    0.27038   3.769 0.000164
age75_PLUS:educationlow                    0.82757    0.30469   2.716 0.006609
gendermale:regionEast of England           0.01192    0.20026   0.060 0.952532
gendermale:regionGreater London            0.20068    0.19925   1.007 0.313856
gendermale:regionNorth East England        0.10185    0.26694   0.382 0.702808
gendermale:regionNorth West England        0.39563    0.19909   1.987 0.046909
gendermale:regionScotland                  0.29222    0.24653   1.185 0.235901
gendermale:regionSouth East England        0.02563    0.18740   0.137 0.891216
gendermale:regionSouth West England       -0.06204    0.20296  -0.306 0.759853
gendermale:regionWales                     0.49634    0.27877   1.780 0.075011
gendermale:regionWest Midlands             0.14695    0.20326   0.723 0.469702
gendermale:regionYorkshire and the Humber  0.22280    0.21255   1.048 0.294538
                                             
(Intercept)                               ***
gendermale                                *  
age25_TO_34                               ***
age35_TO_44                               ***
age45_TO_54                               ***
age55_TO_64                               ***
age65_TO_74                               ***
age75_PLUS                                ***
educationlow                              ***
regionEast of England                        
regionGreater London                      *  
regionNorth East England                  *  
regionNorth West England                  *  
regionScotland                            ***
regionSouth East England                     
regionSouth West England                  .  
regionWales                               ***
regionWest Midlands                          
regionYorkshire and the Humber               
ethnicityblack                               
ethnicitymixed                               
ethnicityother                               
ethnicitywhite                               
householdowns_with_mortgage_or_shared     .  
householdprivate_rented_or_rent_free         
householdsocial_rented                    *  
socgradC1                                    
socgradC2                                    
socgradDE                                    
maritalrelationship_living                *  
maritalrelationship_notliving             .  
maritalseparated_divorced                    
maritalsingle                             ***
maritalwidowed                               
religionhindu                                
religionmuslim                            ***
religionnone                              ***
religionother                             .  
gendermale:age25_TO_34                    *  
gendermale:age35_TO_44                    *  
gendermale:age45_TO_54                    *  
gendermale:age55_TO_64                    *  
gendermale:age65_TO_74                    ** 
gendermale:age75_PLUS                     ** 
gendermale:educationlow                      
age25_TO_34:educationlow                  ** 
age35_TO_44:educationlow                  ***
age45_TO_54:educationlow                  ***
age55_TO_64:educationlow                  ***
age65_TO_74:educationlow                  ***
age75_PLUS:educationlow                   ** 
gendermale:regionEast of England             
gendermale:regionGreater London              
gendermale:regionNorth East England          
gendermale:regionNorth West England       *  
gendermale:regionScotland                    
gendermale:regionSouth East England          
gendermale:regionSouth West England          
gendermale:regionWales                    .  
gendermale:regionWest Midlands               
gendermale:regionYorkshire and the Humber    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

(Dispersion parameter for binomial family taken to be 0.998621)

Number of Fisher Scoring iterations: 6</code></pre>
</div>
<div class="sourceCode cell-code" id="cb165"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb165-1"><a href="#cb165-1" aria-hidden="true" tabindex="-1"></a><span class="fu">nobs</span>(switch_prediction_model_rtl)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 32005</code></pre>
</div>
</div>
<p>Switch rate represents the percentage of that group which switched from right to left in terms of party vote.</p>
<p>Having verified the goodness of fit of our earlier OLS predictive models, I feel confident in basing segmented analysis results on these. They’ll be utilized to generate predicted values.</p>
</section>
<section id="geographic-london-vs.-non-london" class="level5">
<h5 class="anchored" data-anchor-id="geographic-london-vs.-non-london">Geographic: London vs.&nbsp;non-London</h5>
<p>Is the gender divide smaller/different in London vs.&nbsp;rest of the UK? Run a model for London vs.&nbsp;Manchester vs.&nbsp;rural constituencies</p>
<p>Do economic leftism gender gaps vary by region’s economic health? Comparing wealthy south east vs.&nbsp;post industrial north</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb167"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb167-1"><a href="#cb167-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Gender gap analysis by region and age group (using weighted means)</span></span>
<span id="cb167-2"><a href="#cb167-2" aria-hidden="true" tabindex="-1"></a>gender_gap_by_region_age <span class="ot">&lt;-</span> uk_data <span class="sc">%&gt;%</span></span>
<span id="cb167-3"><a href="#cb167-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(social_conservatism), <span class="sc">!</span><span class="fu">is.na</span>(economic_leftism), <span class="sc">!</span><span class="fu">is.na</span>(gender), <span class="sc">!</span><span class="fu">is.na</span>(region), <span class="sc">!</span><span class="fu">is.na</span>(age), <span class="sc">!</span><span class="fu">is.na</span>(wt)) <span class="sc">%&gt;%</span></span>
<span id="cb167-4"><a href="#cb167-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(region, age, gender) <span class="sc">%&gt;%</span></span>
<span id="cb167-5"><a href="#cb167-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(</span>
<span id="cb167-6"><a href="#cb167-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">avg_social =</span> <span class="fu">weighted.mean</span>(social_conservatism, wt, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb167-7"><a href="#cb167-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">avg_economic =</span> <span class="fu">weighted.mean</span>(economic_leftism, wt, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb167-8"><a href="#cb167-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">n =</span> <span class="fu">n</span>(),</span>
<span id="cb167-9"><a href="#cb167-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">.groups =</span> <span class="st">"drop"</span></span>
<span id="cb167-10"><a href="#cb167-10" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb167-11"><a href="#cb167-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_wider</span>(<span class="at">names_from =</span> gender, <span class="at">values_from =</span> <span class="fu">c</span>(avg_social, avg_economic, n), <span class="at">names_sep =</span> <span class="st">"_"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb167-12"><a href="#cb167-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(avg_social_male), <span class="sc">!</span><span class="fu">is.na</span>(avg_social_female), </span>
<span id="cb167-13"><a href="#cb167-13" aria-hidden="true" tabindex="-1"></a>         <span class="sc">!</span><span class="fu">is.na</span>(avg_economic_male), <span class="sc">!</span><span class="fu">is.na</span>(avg_economic_female)) <span class="sc">%&gt;%</span></span>
<span id="cb167-14"><a href="#cb167-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb167-15"><a href="#cb167-15" aria-hidden="true" tabindex="-1"></a>    <span class="at">social_gap =</span> avg_social_male <span class="sc">-</span> avg_social_female,</span>
<span id="cb167-16"><a href="#cb167-16" aria-hidden="true" tabindex="-1"></a>    <span class="at">economic_gap =</span> avg_economic_male <span class="sc">-</span> avg_economic_female</span>
<span id="cb167-17"><a href="#cb167-17" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb167-18"><a href="#cb167-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(region, age, social_gap, economic_gap, n_male, n_female) <span class="sc">%&gt;%</span></span>
<span id="cb167-19"><a href="#cb167-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(region, age)</span>
<span id="cb167-20"><a href="#cb167-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb167-21"><a href="#cb167-21" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="st">"Gender gaps by region and age group (male - female):"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Gender gaps by region and age group (male - female):"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb169"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb169-1"><a href="#cb169-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(gender_gap_by_region_age)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 77 × 6
   region          age      social_gap economic_gap n_male n_female
   &lt;chr&gt;           &lt;chr&gt;         &lt;dbl&gt;        &lt;dbl&gt;  &lt;int&gt;    &lt;int&gt;
 1 East Midlands   18_TO_24   -0.0114      -0.157      103      174
 2 East Midlands   25_TO_34    0.00943      0.0262     138      282
 3 East Midlands   35_TO_44    0.0354      -0.0404     189      250
 4 East Midlands   45_TO_54   -0.0841       0.0448     194      273
 5 East Midlands   55_TO_64   -0.0767       0.0179     186      270
 6 East Midlands   65_TO_74   -0.0267       0.00290    153      145
 7 East Midlands   75_PLUS     0.0811      -0.0759      45       64
 8 East of England 18_TO_24    0.101       -0.0367     118      187
 9 East of England 25_TO_34    0.0864       0.0334     212      317
10 East of England 35_TO_44    0.0916       0.0458     266      352
# ℹ 67 more rows</code></pre>
</div>
<div class="sourceCode cell-code" id="cb171"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb171-1"><a href="#cb171-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Create London vs Rest of UK comparison</span></span>
<span id="cb171-2"><a href="#cb171-2" aria-hidden="true" tabindex="-1"></a>london_vs_rest <span class="ot">&lt;-</span> gender_gap_by_region_age <span class="sc">%&gt;%</span></span>
<span id="cb171-3"><a href="#cb171-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb171-4"><a href="#cb171-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">location =</span> <span class="fu">ifelse</span>(region <span class="sc">==</span> <span class="st">"Greater London"</span>, <span class="st">"London"</span>, <span class="st">"Rest of UK"</span>)</span>
<span id="cb171-5"><a href="#cb171-5" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb171-6"><a href="#cb171-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(location, age) <span class="sc">%&gt;%</span></span>
<span id="cb171-7"><a href="#cb171-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(</span>
<span id="cb171-8"><a href="#cb171-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">social_gap =</span> <span class="fu">weighted.mean</span>(social_gap, n_male <span class="sc">+</span> n_female, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb171-9"><a href="#cb171-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">economic_gap =</span> <span class="fu">weighted.mean</span>(economic_gap, n_male <span class="sc">+</span> n_female, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb171-10"><a href="#cb171-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">total_n =</span> <span class="fu">sum</span>(n_male <span class="sc">+</span> n_female, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb171-11"><a href="#cb171-11" aria-hidden="true" tabindex="-1"></a>    <span class="at">.groups =</span> <span class="st">"drop"</span></span>
<span id="cb171-12"><a href="#cb171-12" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb171-13"><a href="#cb171-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="at">cols =</span> <span class="fu">c</span>(social_gap, economic_gap), </span>
<span id="cb171-14"><a href="#cb171-14" aria-hidden="true" tabindex="-1"></a>               <span class="at">names_to =</span> <span class="st">"gap_type"</span>, </span>
<span id="cb171-15"><a href="#cb171-15" aria-hidden="true" tabindex="-1"></a>               <span class="at">values_to =</span> <span class="st">"gap_value"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb171-16"><a href="#cb171-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb171-17"><a href="#cb171-17" aria-hidden="true" tabindex="-1"></a>    <span class="at">gap_type =</span> <span class="fu">case_when</span>(</span>
<span id="cb171-18"><a href="#cb171-18" aria-hidden="true" tabindex="-1"></a>      gap_type <span class="sc">==</span> <span class="st">"social_gap"</span> <span class="sc">~</span> <span class="st">"Social Conservatism Gap"</span>,</span>
<span id="cb171-19"><a href="#cb171-19" aria-hidden="true" tabindex="-1"></a>      gap_type <span class="sc">==</span> <span class="st">"economic_gap"</span> <span class="sc">~</span> <span class="st">"Economic Leftism Gap"</span></span>
<span id="cb171-20"><a href="#cb171-20" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb171-21"><a href="#cb171-21" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb171-22"><a href="#cb171-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb171-23"><a href="#cb171-23" aria-hidden="true" tabindex="-1"></a><span class="co"># Create line plot to show trends more clearly</span></span>
<span id="cb171-24"><a href="#cb171-24" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb171-25"><a href="#cb171-25" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(london_vs_rest, <span class="fu">aes</span>(<span class="at">x =</span> age, <span class="at">y =</span> gap_value, <span class="at">color =</span> location, <span class="at">group =</span> location)) <span class="sc">+</span></span>
<span id="cb171-26"><a href="#cb171-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">size =</span> <span class="fl">1.2</span>) <span class="sc">+</span></span>
<span id="cb171-27"><a href="#cb171-27" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb171-28"><a href="#cb171-28" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="dv">0</span>, <span class="at">linetype =</span> <span class="st">"dashed"</span>, <span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb171-29"><a href="#cb171-29" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>gap_type, <span class="at">scales =</span> <span class="st">"free_y"</span>) <span class="sc">+</span></span>
<span id="cb171-30"><a href="#cb171-30" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb171-31"><a href="#cb171-31" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Gender Ideological Gaps: London vs Rest of UK"</span>,</span>
<span id="cb171-32"><a href="#cb171-32" aria-hidden="true" tabindex="-1"></a>    <span class="at">subtitle =</span> <span class="st">"How gender divides vary by age and location"</span>,</span>
<span id="cb171-33"><a href="#cb171-33" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"Age Group"</span>, </span>
<span id="cb171-34"><a href="#cb171-34" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">"Gender Gap (Male - Female)"</span>,</span>
<span id="cb171-35"><a href="#cb171-35" aria-hidden="true" tabindex="-1"></a>    <span class="at">color =</span> <span class="st">"Location"</span>,</span>
<span id="cb171-36"><a href="#cb171-36" aria-hidden="true" tabindex="-1"></a>    <span class="at">caption =</span> <span class="st">"Positive = men more conservative/economically left than women"</span></span>
<span id="cb171-37"><a href="#cb171-37" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb171-38"><a href="#cb171-38" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb171-39"><a href="#cb171-39" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(</span>
<span id="cb171-40"><a href="#cb171-40" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">45</span>, <span class="at">hjust =</span> <span class="dv">1</span>),</span>
<span id="cb171-41"><a href="#cb171-41" aria-hidden="true" tabindex="-1"></a>    <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">14</span>, <span class="at">face =</span> <span class="st">"bold"</span>),</span>
<span id="cb171-42"><a href="#cb171-42" aria-hidden="true" tabindex="-1"></a>    <span class="at">strip.text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">12</span>, <span class="at">face =</span> <span class="st">"bold"</span>)</span>
<span id="cb171-43"><a href="#cb171-43" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb171-44"><a href="#cb171-44" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"London"</span> <span class="ot">=</span> <span class="st">"#E74C3C"</span>, <span class="st">"Rest of UK"</span> <span class="ot">=</span> <span class="st">"#3498DB"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="initial_analysis_files/figure-html/unnamed-chunk-21-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:80.0%"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="education-and-age-group-mean-difference" class="level5">
<h5 class="anchored" data-anchor-id="education-and-age-group-mean-difference">Education and Age Group Mean Difference</h5>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb172"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb172-1"><a href="#cb172-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Gender gap analysis by education and age group (using weighted means)</span></span>
<span id="cb172-2"><a href="#cb172-2" aria-hidden="true" tabindex="-1"></a>gender_gap_by_education_age <span class="ot">&lt;-</span> uk_data <span class="sc">%&gt;%</span></span>
<span id="cb172-3"><a href="#cb172-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(social_conservatism), <span class="sc">!</span><span class="fu">is.na</span>(economic_leftism), <span class="sc">!</span><span class="fu">is.na</span>(gender), <span class="sc">!</span><span class="fu">is.na</span>(education), <span class="sc">!</span><span class="fu">is.na</span>(age), <span class="sc">!</span><span class="fu">is.na</span>(wt)) <span class="sc">%&gt;%</span></span>
<span id="cb172-4"><a href="#cb172-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(education, age, gender) <span class="sc">%&gt;%</span></span>
<span id="cb172-5"><a href="#cb172-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(</span>
<span id="cb172-6"><a href="#cb172-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">avg_social =</span> <span class="fu">weighted.mean</span>(social_conservatism, wt, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb172-7"><a href="#cb172-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">avg_economic =</span> <span class="fu">weighted.mean</span>(economic_leftism, wt, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb172-8"><a href="#cb172-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">n =</span> <span class="fu">n</span>(),</span>
<span id="cb172-9"><a href="#cb172-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">.groups =</span> <span class="st">"drop"</span></span>
<span id="cb172-10"><a href="#cb172-10" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb172-11"><a href="#cb172-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_wider</span>(<span class="at">names_from =</span> gender, <span class="at">values_from =</span> <span class="fu">c</span>(avg_social, avg_economic, n), <span class="at">names_sep =</span> <span class="st">"_"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb172-12"><a href="#cb172-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(avg_social_male), <span class="sc">!</span><span class="fu">is.na</span>(avg_social_female), </span>
<span id="cb172-13"><a href="#cb172-13" aria-hidden="true" tabindex="-1"></a>         <span class="sc">!</span><span class="fu">is.na</span>(avg_economic_male), <span class="sc">!</span><span class="fu">is.na</span>(avg_economic_female)) <span class="sc">%&gt;%</span></span>
<span id="cb172-14"><a href="#cb172-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb172-15"><a href="#cb172-15" aria-hidden="true" tabindex="-1"></a>    <span class="at">social_gap =</span> avg_social_male <span class="sc">-</span> avg_social_female,</span>
<span id="cb172-16"><a href="#cb172-16" aria-hidden="true" tabindex="-1"></a>    <span class="at">economic_gap =</span> avg_economic_male <span class="sc">-</span> avg_economic_female</span>
<span id="cb172-17"><a href="#cb172-17" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb172-18"><a href="#cb172-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(education, age, social_gap, economic_gap, n_male, n_female) <span class="sc">%&gt;%</span></span>
<span id="cb172-19"><a href="#cb172-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(education, age)</span>
<span id="cb172-20"><a href="#cb172-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb172-21"><a href="#cb172-21" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="st">"Gender gaps by education and age group (male - female):"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Gender gaps by education and age group (male - female):"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb174"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb174-1"><a href="#cb174-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(gender_gap_by_education_age)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 14 × 6
   education age      social_gap economic_gap n_male n_female
   &lt;chr&gt;     &lt;chr&gt;         &lt;dbl&gt;        &lt;dbl&gt;  &lt;int&gt;    &lt;int&gt;
 1 high      18_TO_24    0.0811      -0.0906     499      809
 2 high      25_TO_34    0.106       -0.0415    1432     2106
 3 high      35_TO_44    0.0544       0.0219    1287     1738
 4 high      45_TO_54    0.0269      -0.0184    1013     1278
 5 high      55_TO_64   -0.0651       0.00160    746      881
 6 high      65_TO_74   -0.0213       0.0395     556      540
 7 high      75_PLUS    -0.0546      -0.0733     229      191
 8 low       18_TO_24    0.0511      -0.0579     902     1484
 9 low       25_TO_34   -0.0276      -0.0177    1122     1575
10 low       35_TO_44    0.00383      0.0101    1324     1726
11 low       45_TO_54   -0.0638       0.0598    1481     2048
12 low       55_TO_64   -0.0522       0.0536    1574     1988
13 low       65_TO_74   -0.0189       0.0578    1357     1564
14 low       75_PLUS     0.0216       0.0204     502      496</code></pre>
</div>
<div class="sourceCode cell-code" id="cb176"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb176-1"><a href="#cb176-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Check education levels</span></span>
<span id="cb176-2"><a href="#cb176-2" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Available education levels:</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Available education levels:</code></pre>
</div>
<div class="sourceCode cell-code" id="cb178"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb178-1"><a href="#cb178-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">unique</span>(gender_gap_by_education_age<span class="sc">$</span>education))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "high" "low" </code></pre>
</div>
<div class="sourceCode cell-code" id="cb180"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb180-1"><a href="#cb180-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Create education comparison for visualization</span></span>
<span id="cb180-2"><a href="#cb180-2" aria-hidden="true" tabindex="-1"></a>education_comparison <span class="ot">&lt;-</span> gender_gap_by_education_age <span class="sc">%&gt;%</span></span>
<span id="cb180-3"><a href="#cb180-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="at">cols =</span> <span class="fu">c</span>(social_gap, economic_gap), </span>
<span id="cb180-4"><a href="#cb180-4" aria-hidden="true" tabindex="-1"></a>               <span class="at">names_to =</span> <span class="st">"gap_type"</span>, </span>
<span id="cb180-5"><a href="#cb180-5" aria-hidden="true" tabindex="-1"></a>               <span class="at">values_to =</span> <span class="st">"gap_value"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb180-6"><a href="#cb180-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb180-7"><a href="#cb180-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">gap_type =</span> <span class="fu">case_when</span>(</span>
<span id="cb180-8"><a href="#cb180-8" aria-hidden="true" tabindex="-1"></a>      gap_type <span class="sc">==</span> <span class="st">"social_gap"</span> <span class="sc">~</span> <span class="st">"Social Conservatism Gap"</span>,</span>
<span id="cb180-9"><a href="#cb180-9" aria-hidden="true" tabindex="-1"></a>      gap_type <span class="sc">==</span> <span class="st">"economic_gap"</span> <span class="sc">~</span> <span class="st">"Economic Leftism Gap"</span></span>
<span id="cb180-10"><a href="#cb180-10" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb180-11"><a href="#cb180-11" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb180-12"><a href="#cb180-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb180-13"><a href="#cb180-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Create line plot for education gaps</span></span>
<span id="cb180-14"><a href="#cb180-14" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(education_comparison, <span class="fu">aes</span>(<span class="at">x =</span> age, <span class="at">y =</span> gap_value, <span class="at">color =</span> education, <span class="at">group =</span> education)) <span class="sc">+</span></span>
<span id="cb180-15"><a href="#cb180-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">size =</span> <span class="fl">1.2</span>) <span class="sc">+</span></span>
<span id="cb180-16"><a href="#cb180-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb180-17"><a href="#cb180-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="dv">0</span>, <span class="at">linetype =</span> <span class="st">"dashed"</span>, <span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb180-18"><a href="#cb180-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>gap_type, <span class="at">scales =</span> <span class="st">"free_y"</span>) <span class="sc">+</span></span>
<span id="cb180-19"><a href="#cb180-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb180-20"><a href="#cb180-20" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Gender Ideological Gaps by Education Level"</span>,</span>
<span id="cb180-21"><a href="#cb180-21" aria-hidden="true" tabindex="-1"></a>    <span class="at">subtitle =</span> <span class="st">"How gender divides vary by age and education"</span>,</span>
<span id="cb180-22"><a href="#cb180-22" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"Age Group"</span>, </span>
<span id="cb180-23"><a href="#cb180-23" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">"Gender Gap (Male - Female)"</span>,</span>
<span id="cb180-24"><a href="#cb180-24" aria-hidden="true" tabindex="-1"></a>    <span class="at">color =</span> <span class="st">"Education"</span>,</span>
<span id="cb180-25"><a href="#cb180-25" aria-hidden="true" tabindex="-1"></a>    <span class="at">caption =</span> <span class="st">"Positive = men more conservative/economically left than women"</span></span>
<span id="cb180-26"><a href="#cb180-26" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb180-27"><a href="#cb180-27" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb180-28"><a href="#cb180-28" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(</span>
<span id="cb180-29"><a href="#cb180-29" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">45</span>, <span class="at">hjust =</span> <span class="dv">1</span>),</span>
<span id="cb180-30"><a href="#cb180-30" aria-hidden="true" tabindex="-1"></a>    <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">14</span>, <span class="at">face =</span> <span class="st">"bold"</span>),</span>
<span id="cb180-31"><a href="#cb180-31" aria-hidden="true" tabindex="-1"></a>    <span class="at">strip.text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">12</span>, <span class="at">face =</span> <span class="st">"bold"</span>)</span>
<span id="cb180-32"><a href="#cb180-32" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb180-33"><a href="#cb180-33" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_brewer</span>(<span class="at">type =</span> <span class="st">"qual"</span>, <span class="at">palette =</span> <span class="st">"Set1"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="initial_analysis_files/figure-html/unnamed-chunk-22-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:80.0%"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="social-grade-and-age-group-mean-difference" class="level5">
<h5 class="anchored" data-anchor-id="social-grade-and-age-group-mean-difference">Social Grade and Age Group Mean Difference</h5>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb181"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb181-1"><a href="#cb181-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Gender gap analysis by social grade and age group (using weighted means)</span></span>
<span id="cb181-2"><a href="#cb181-2" aria-hidden="true" tabindex="-1"></a>gender_gap_by_socgrad_age <span class="ot">&lt;-</span> uk_data <span class="sc">%&gt;%</span></span>
<span id="cb181-3"><a href="#cb181-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(social_conservatism), <span class="sc">!</span><span class="fu">is.na</span>(economic_leftism), <span class="sc">!</span><span class="fu">is.na</span>(gender), <span class="sc">!</span><span class="fu">is.na</span>(socgrad), <span class="sc">!</span><span class="fu">is.na</span>(age), <span class="sc">!</span><span class="fu">is.na</span>(wt)) <span class="sc">%&gt;%</span></span>
<span id="cb181-4"><a href="#cb181-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(socgrad, age, gender) <span class="sc">%&gt;%</span></span>
<span id="cb181-5"><a href="#cb181-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(</span>
<span id="cb181-6"><a href="#cb181-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">avg_social =</span> <span class="fu">weighted.mean</span>(social_conservatism, wt, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb181-7"><a href="#cb181-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">avg_economic =</span> <span class="fu">weighted.mean</span>(economic_leftism, wt, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb181-8"><a href="#cb181-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">n =</span> <span class="fu">n</span>(),</span>
<span id="cb181-9"><a href="#cb181-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">.groups =</span> <span class="st">"drop"</span></span>
<span id="cb181-10"><a href="#cb181-10" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb181-11"><a href="#cb181-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_wider</span>(<span class="at">names_from =</span> gender, <span class="at">values_from =</span> <span class="fu">c</span>(avg_social, avg_economic, n), <span class="at">names_sep =</span> <span class="st">"_"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb181-12"><a href="#cb181-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(avg_social_male), <span class="sc">!</span><span class="fu">is.na</span>(avg_social_female), </span>
<span id="cb181-13"><a href="#cb181-13" aria-hidden="true" tabindex="-1"></a>         <span class="sc">!</span><span class="fu">is.na</span>(avg_economic_male), <span class="sc">!</span><span class="fu">is.na</span>(avg_economic_female)) <span class="sc">%&gt;%</span></span>
<span id="cb181-14"><a href="#cb181-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb181-15"><a href="#cb181-15" aria-hidden="true" tabindex="-1"></a>    <span class="at">social_gap =</span> avg_social_male <span class="sc">-</span> avg_social_female,</span>
<span id="cb181-16"><a href="#cb181-16" aria-hidden="true" tabindex="-1"></a>    <span class="at">economic_gap =</span> avg_economic_male <span class="sc">-</span> avg_economic_female</span>
<span id="cb181-17"><a href="#cb181-17" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb181-18"><a href="#cb181-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(socgrad, age, social_gap, economic_gap, n_male, n_female) <span class="sc">%&gt;%</span></span>
<span id="cb181-19"><a href="#cb181-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(socgrad, age)</span>
<span id="cb181-20"><a href="#cb181-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb181-21"><a href="#cb181-21" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="st">"Gender gaps by social grade and age group (male - female):"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Gender gaps by social grade and age group (male - female):"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb183"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb183-1"><a href="#cb183-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(gender_gap_by_socgrad_age)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 28 × 6
   socgrad age      social_gap economic_gap n_male n_female
   &lt;chr&gt;   &lt;chr&gt;         &lt;dbl&gt;        &lt;dbl&gt;  &lt;int&gt;    &lt;int&gt;
 1 AB      18_TO_24    0.0773       -0.0774    569      865
 2 AB      25_TO_34    0.0606       -0.0252   1204     1561
 3 AB      35_TO_44    0.0742        0.0345   1224     1377
 4 AB      45_TO_54    0.0193        0.0409    948     1083
 5 AB      55_TO_64   -0.00648       0.0201    788      826
 6 AB      65_TO_74   -0.0159        0.0273    678      592
 7 AB      75_PLUS    -0.0385       -0.0599    339      226
 8 C1      18_TO_24    0.0993       -0.107     205      484
 9 C1      25_TO_34    0.0726       -0.0371    557      934
10 C1      35_TO_44    0.0271        0.0348    545      879
# ℹ 18 more rows</code></pre>
</div>
<div class="sourceCode cell-code" id="cb185"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb185-1"><a href="#cb185-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Check social grade levels</span></span>
<span id="cb185-2"><a href="#cb185-2" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Available social grade levels:</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Available social grade levels:</code></pre>
</div>
<div class="sourceCode cell-code" id="cb187"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb187-1"><a href="#cb187-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">unique</span>(gender_gap_by_socgrad_age<span class="sc">$</span>socgrad))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "AB" "C1" "C2" "DE"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb189"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb189-1"><a href="#cb189-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Create social grade comparison for visualization</span></span>
<span id="cb189-2"><a href="#cb189-2" aria-hidden="true" tabindex="-1"></a>socgrad_comparison <span class="ot">&lt;-</span> gender_gap_by_socgrad_age <span class="sc">%&gt;%</span></span>
<span id="cb189-3"><a href="#cb189-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="at">cols =</span> <span class="fu">c</span>(social_gap, economic_gap), </span>
<span id="cb189-4"><a href="#cb189-4" aria-hidden="true" tabindex="-1"></a>               <span class="at">names_to =</span> <span class="st">"gap_type"</span>, </span>
<span id="cb189-5"><a href="#cb189-5" aria-hidden="true" tabindex="-1"></a>               <span class="at">values_to =</span> <span class="st">"gap_value"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb189-6"><a href="#cb189-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb189-7"><a href="#cb189-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">gap_type =</span> <span class="fu">case_when</span>(</span>
<span id="cb189-8"><a href="#cb189-8" aria-hidden="true" tabindex="-1"></a>      gap_type <span class="sc">==</span> <span class="st">"social_gap"</span> <span class="sc">~</span> <span class="st">"Social Conservatism Gap"</span>,</span>
<span id="cb189-9"><a href="#cb189-9" aria-hidden="true" tabindex="-1"></a>      gap_type <span class="sc">==</span> <span class="st">"economic_gap"</span> <span class="sc">~</span> <span class="st">"Economic Leftism Gap"</span></span>
<span id="cb189-10"><a href="#cb189-10" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb189-11"><a href="#cb189-11" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb189-12"><a href="#cb189-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb189-13"><a href="#cb189-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Create line plot for social grade gaps</span></span>
<span id="cb189-14"><a href="#cb189-14" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(socgrad_comparison, <span class="fu">aes</span>(<span class="at">x =</span> age, <span class="at">y =</span> gap_value, <span class="at">color =</span> socgrad, <span class="at">group =</span> socgrad)) <span class="sc">+</span></span>
<span id="cb189-15"><a href="#cb189-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">size =</span> <span class="fl">1.2</span>) <span class="sc">+</span></span>
<span id="cb189-16"><a href="#cb189-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb189-17"><a href="#cb189-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="dv">0</span>, <span class="at">linetype =</span> <span class="st">"dashed"</span>, <span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb189-18"><a href="#cb189-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>gap_type, <span class="at">scales =</span> <span class="st">"free_y"</span>) <span class="sc">+</span></span>
<span id="cb189-19"><a href="#cb189-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb189-20"><a href="#cb189-20" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Gender Ideological Gaps by Social Grade"</span>,</span>
<span id="cb189-21"><a href="#cb189-21" aria-hidden="true" tabindex="-1"></a>    <span class="at">subtitle =</span> <span class="st">"How gender divides vary by age and social class (AB=highest, DE=lowest)"</span>,</span>
<span id="cb189-22"><a href="#cb189-22" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"Age Group"</span>, </span>
<span id="cb189-23"><a href="#cb189-23" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">"Gender Gap (Male - Female)"</span>,</span>
<span id="cb189-24"><a href="#cb189-24" aria-hidden="true" tabindex="-1"></a>    <span class="at">color =</span> <span class="st">"Social Grade"</span>,</span>
<span id="cb189-25"><a href="#cb189-25" aria-hidden="true" tabindex="-1"></a>    <span class="at">caption =</span> <span class="st">"Positive = men more conservative/economically left than women"</span></span>
<span id="cb189-26"><a href="#cb189-26" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb189-27"><a href="#cb189-27" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb189-28"><a href="#cb189-28" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(</span>
<span id="cb189-29"><a href="#cb189-29" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">45</span>, <span class="at">hjust =</span> <span class="dv">1</span>),</span>
<span id="cb189-30"><a href="#cb189-30" aria-hidden="true" tabindex="-1"></a>    <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">14</span>, <span class="at">face =</span> <span class="st">"bold"</span>),</span>
<span id="cb189-31"><a href="#cb189-31" aria-hidden="true" tabindex="-1"></a>    <span class="at">strip.text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">12</span>, <span class="at">face =</span> <span class="st">"bold"</span>)</span>
<span id="cb189-32"><a href="#cb189-32" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb189-33"><a href="#cb189-33" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"AB"</span> <span class="ot">=</span> <span class="st">"#8E44AD"</span>, <span class="st">"C1"</span> <span class="ot">=</span> <span class="st">"#3498DB"</span>, <span class="st">"C2"</span> <span class="ot">=</span> <span class="st">"#E67E22"</span>, <span class="st">"DE"</span> <span class="ot">=</span> <span class="st">"#E74C3C"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="initial_analysis_files/figure-html/unnamed-chunk-23-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:80.0%"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="ethnicity-and-age-group-mean-difference" class="level5">
<h5 class="anchored" data-anchor-id="ethnicity-and-age-group-mean-difference">Ethnicity and Age Group Mean Difference</h5>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb190"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb190-1"><a href="#cb190-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Gender gap analysis by ethnicity and age group (using weighted means)</span></span>
<span id="cb190-2"><a href="#cb190-2" aria-hidden="true" tabindex="-1"></a>gender_gap_by_ethnicity_age <span class="ot">&lt;-</span> uk_data <span class="sc">%&gt;%</span></span>
<span id="cb190-3"><a href="#cb190-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(social_conservatism), <span class="sc">!</span><span class="fu">is.na</span>(economic_leftism), <span class="sc">!</span><span class="fu">is.na</span>(gender), <span class="sc">!</span><span class="fu">is.na</span>(ethnicity), <span class="sc">!</span><span class="fu">is.na</span>(age), <span class="sc">!</span><span class="fu">is.na</span>(wt)) <span class="sc">%&gt;%</span></span>
<span id="cb190-4"><a href="#cb190-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(ethnicity, age, gender) <span class="sc">%&gt;%</span></span>
<span id="cb190-5"><a href="#cb190-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(</span>
<span id="cb190-6"><a href="#cb190-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">avg_social =</span> <span class="fu">weighted.mean</span>(social_conservatism, wt, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb190-7"><a href="#cb190-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">avg_economic =</span> <span class="fu">weighted.mean</span>(economic_leftism, wt, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb190-8"><a href="#cb190-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">n =</span> <span class="fu">n</span>(),</span>
<span id="cb190-9"><a href="#cb190-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">.groups =</span> <span class="st">"drop"</span></span>
<span id="cb190-10"><a href="#cb190-10" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb190-11"><a href="#cb190-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_wider</span>(<span class="at">names_from =</span> gender, <span class="at">values_from =</span> <span class="fu">c</span>(avg_social, avg_economic, n), <span class="at">names_sep =</span> <span class="st">"_"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb190-12"><a href="#cb190-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(avg_social_male), <span class="sc">!</span><span class="fu">is.na</span>(avg_social_female), </span>
<span id="cb190-13"><a href="#cb190-13" aria-hidden="true" tabindex="-1"></a>         <span class="sc">!</span><span class="fu">is.na</span>(avg_economic_male), <span class="sc">!</span><span class="fu">is.na</span>(avg_economic_female)) <span class="sc">%&gt;%</span></span>
<span id="cb190-14"><a href="#cb190-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb190-15"><a href="#cb190-15" aria-hidden="true" tabindex="-1"></a>    <span class="at">social_gap =</span> avg_social_male <span class="sc">-</span> avg_social_female,</span>
<span id="cb190-16"><a href="#cb190-16" aria-hidden="true" tabindex="-1"></a>    <span class="at">economic_gap =</span> avg_economic_male <span class="sc">-</span> avg_economic_female</span>
<span id="cb190-17"><a href="#cb190-17" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb190-18"><a href="#cb190-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(ethnicity, age, social_gap, economic_gap, n_male, n_female) <span class="sc">%&gt;%</span></span>
<span id="cb190-19"><a href="#cb190-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(ethnicity, age)</span>
<span id="cb190-20"><a href="#cb190-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb190-21"><a href="#cb190-21" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="st">"Gender gaps by ethnicity and age group (male - female):"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Gender gaps by ethnicity and age group (male - female):"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb192"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb192-1"><a href="#cb192-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(gender_gap_by_ethnicity_age)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 34 × 6
   ethnicity age      social_gap economic_gap n_male n_female
   &lt;chr&gt;     &lt;chr&gt;         &lt;dbl&gt;        &lt;dbl&gt;  &lt;int&gt;    &lt;int&gt;
 1 asian     18_TO_24    0.0756      -0.0755     282      385
 2 asian     25_TO_34    0.0158      -0.0149     325      433
 3 asian     35_TO_44    0.00578     -0.00532    216      324
 4 asian     45_TO_54   -0.0799       0.00295    178      165
 5 asian     55_TO_64   -0.0311       0.126       72       79
 6 asian     65_TO_74   -0.0127       0.136       21       21
 7 asian     75_PLUS     0.263       -0.401        7       10
 8 black     18_TO_24    0.0542      -0.0901     131      172
 9 black     25_TO_34    0.0259      -0.0148     334      353
10 black     35_TO_44    0.122        0.0605     191      167
# ℹ 24 more rows</code></pre>
</div>
<div class="sourceCode cell-code" id="cb194"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb194-1"><a href="#cb194-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Check ethnicity levels</span></span>
<span id="cb194-2"><a href="#cb194-2" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Available ethnicity levels:</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Available ethnicity levels:</code></pre>
</div>
<div class="sourceCode cell-code" id="cb196"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb196-1"><a href="#cb196-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">unique</span>(gender_gap_by_ethnicity_age<span class="sc">$</span>ethnicity))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "asian" "black" "mixed" "other" "white"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb198"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb198-1"><a href="#cb198-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Create ethnicity comparison for visualization</span></span>
<span id="cb198-2"><a href="#cb198-2" aria-hidden="true" tabindex="-1"></a>ethnicity_comparison <span class="ot">&lt;-</span> gender_gap_by_ethnicity_age <span class="sc">%&gt;%</span></span>
<span id="cb198-3"><a href="#cb198-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="at">cols =</span> <span class="fu">c</span>(social_gap, economic_gap), </span>
<span id="cb198-4"><a href="#cb198-4" aria-hidden="true" tabindex="-1"></a>               <span class="at">names_to =</span> <span class="st">"gap_type"</span>, </span>
<span id="cb198-5"><a href="#cb198-5" aria-hidden="true" tabindex="-1"></a>               <span class="at">values_to =</span> <span class="st">"gap_value"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb198-6"><a href="#cb198-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb198-7"><a href="#cb198-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">gap_type =</span> <span class="fu">case_when</span>(</span>
<span id="cb198-8"><a href="#cb198-8" aria-hidden="true" tabindex="-1"></a>      gap_type <span class="sc">==</span> <span class="st">"social_gap"</span> <span class="sc">~</span> <span class="st">"Social Conservatism Gap"</span>,</span>
<span id="cb198-9"><a href="#cb198-9" aria-hidden="true" tabindex="-1"></a>      gap_type <span class="sc">==</span> <span class="st">"economic_gap"</span> <span class="sc">~</span> <span class="st">"Economic Leftism Gap"</span></span>
<span id="cb198-10"><a href="#cb198-10" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb198-11"><a href="#cb198-11" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb198-12"><a href="#cb198-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb198-13"><a href="#cb198-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Create line plot for ethnicity gaps</span></span>
<span id="cb198-14"><a href="#cb198-14" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(ethnicity_comparison, <span class="fu">aes</span>(<span class="at">x =</span> age, <span class="at">y =</span> gap_value, <span class="at">color =</span> ethnicity, <span class="at">group =</span> ethnicity)) <span class="sc">+</span></span>
<span id="cb198-15"><a href="#cb198-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">size =</span> <span class="fl">1.2</span>) <span class="sc">+</span></span>
<span id="cb198-16"><a href="#cb198-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb198-17"><a href="#cb198-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="dv">0</span>, <span class="at">linetype =</span> <span class="st">"dashed"</span>, <span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb198-18"><a href="#cb198-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>gap_type, <span class="at">scales =</span> <span class="st">"free_y"</span>) <span class="sc">+</span></span>
<span id="cb198-19"><a href="#cb198-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb198-20"><a href="#cb198-20" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Gender Ideological Gaps by Ethnicity"</span>,</span>
<span id="cb198-21"><a href="#cb198-21" aria-hidden="true" tabindex="-1"></a>    <span class="at">subtitle =</span> <span class="st">"How gender divides vary by age and ethnic background"</span>,</span>
<span id="cb198-22"><a href="#cb198-22" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"Age Group"</span>, </span>
<span id="cb198-23"><a href="#cb198-23" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">"Gender Gap (Male - Female)"</span>,</span>
<span id="cb198-24"><a href="#cb198-24" aria-hidden="true" tabindex="-1"></a>    <span class="at">color =</span> <span class="st">"Ethnicity"</span>,</span>
<span id="cb198-25"><a href="#cb198-25" aria-hidden="true" tabindex="-1"></a>    <span class="at">caption =</span> <span class="st">"Positive = men more conservative/economically left than women"</span></span>
<span id="cb198-26"><a href="#cb198-26" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb198-27"><a href="#cb198-27" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb198-28"><a href="#cb198-28" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(</span>
<span id="cb198-29"><a href="#cb198-29" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">45</span>, <span class="at">hjust =</span> <span class="dv">1</span>),</span>
<span id="cb198-30"><a href="#cb198-30" aria-hidden="true" tabindex="-1"></a>    <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">14</span>, <span class="at">face =</span> <span class="st">"bold"</span>),</span>
<span id="cb198-31"><a href="#cb198-31" aria-hidden="true" tabindex="-1"></a>    <span class="at">strip.text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">12</span>, <span class="at">face =</span> <span class="st">"bold"</span>)</span>
<span id="cb198-32"><a href="#cb198-32" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb198-33"><a href="#cb198-33" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"white"</span> <span class="ot">=</span> <span class="st">"#2C3E50"</span>, <span class="st">"asian"</span> <span class="ot">=</span> <span class="st">"#E74C3C"</span>, <span class="st">"black"</span> <span class="ot">=</span> <span class="st">"#F39C12"</span>, <span class="st">"mixed"</span> <span class="ot">=</span> <span class="st">"#9B59B6"</span>, <span class="st">"other"</span> <span class="ot">=</span> <span class="st">"#1ABC9C"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="initial_analysis_files/figure-html/unnamed-chunk-24-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:80.0%"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="religion-and-age-group-mean-difference" class="level5">
<h5 class="anchored" data-anchor-id="religion-and-age-group-mean-difference">Religion and Age Group Mean Difference</h5>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb199"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb199-1"><a href="#cb199-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Gender gap analysis by religion and age group (using weighted means)</span></span>
<span id="cb199-2"><a href="#cb199-2" aria-hidden="true" tabindex="-1"></a>gender_gap_by_religion_age <span class="ot">&lt;-</span> uk_data <span class="sc">%&gt;%</span></span>
<span id="cb199-3"><a href="#cb199-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(social_conservatism), <span class="sc">!</span><span class="fu">is.na</span>(economic_leftism), <span class="sc">!</span><span class="fu">is.na</span>(gender), <span class="sc">!</span><span class="fu">is.na</span>(religion), <span class="sc">!</span><span class="fu">is.na</span>(age), <span class="sc">!</span><span class="fu">is.na</span>(wt)) <span class="sc">%&gt;%</span></span>
<span id="cb199-4"><a href="#cb199-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(religion, age, gender) <span class="sc">%&gt;%</span></span>
<span id="cb199-5"><a href="#cb199-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(</span>
<span id="cb199-6"><a href="#cb199-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">avg_social =</span> <span class="fu">weighted.mean</span>(social_conservatism, wt, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb199-7"><a href="#cb199-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">avg_economic =</span> <span class="fu">weighted.mean</span>(economic_leftism, wt, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb199-8"><a href="#cb199-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">n =</span> <span class="fu">n</span>(),</span>
<span id="cb199-9"><a href="#cb199-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">.groups =</span> <span class="st">"drop"</span></span>
<span id="cb199-10"><a href="#cb199-10" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb199-11"><a href="#cb199-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_wider</span>(<span class="at">names_from =</span> gender, <span class="at">values_from =</span> <span class="fu">c</span>(avg_social, avg_economic, n), <span class="at">names_sep =</span> <span class="st">"_"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb199-12"><a href="#cb199-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(avg_social_male), <span class="sc">!</span><span class="fu">is.na</span>(avg_social_female), </span>
<span id="cb199-13"><a href="#cb199-13" aria-hidden="true" tabindex="-1"></a>         <span class="sc">!</span><span class="fu">is.na</span>(avg_economic_male), <span class="sc">!</span><span class="fu">is.na</span>(avg_economic_female)) <span class="sc">%&gt;%</span></span>
<span id="cb199-14"><a href="#cb199-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb199-15"><a href="#cb199-15" aria-hidden="true" tabindex="-1"></a>    <span class="at">social_gap =</span> avg_social_male <span class="sc">-</span> avg_social_female,</span>
<span id="cb199-16"><a href="#cb199-16" aria-hidden="true" tabindex="-1"></a>    <span class="at">economic_gap =</span> avg_economic_male <span class="sc">-</span> avg_economic_female</span>
<span id="cb199-17"><a href="#cb199-17" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb199-18"><a href="#cb199-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(religion, age, social_gap, economic_gap, n_male, n_female) <span class="sc">%&gt;%</span></span>
<span id="cb199-19"><a href="#cb199-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(religion, age)</span>
<span id="cb199-20"><a href="#cb199-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb199-21"><a href="#cb199-21" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="st">"Gender gaps by religion and age group (male - female):"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Gender gaps by religion and age group (male - female):"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb201"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb201-1"><a href="#cb201-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(gender_gap_by_religion_age)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 34 × 6
   religion  age      social_gap economic_gap n_male n_female
   &lt;chr&gt;     &lt;chr&gt;         &lt;dbl&gt;        &lt;dbl&gt;  &lt;int&gt;    &lt;int&gt;
 1 christian 18_TO_24    0.0921       -0.0374    415      587
 2 christian 25_TO_34    0.0479       -0.0139   1027     1208
 3 christian 35_TO_44    0.0726        0.0205   1126     1364
 4 christian 45_TO_54    0.0369        0.0237   1047     1566
 5 christian 55_TO_64   -0.00671       0.0199   1228     1635
 6 christian 65_TO_74    0.00451       0.0456   1184     1452
 7 christian 75_PLUS     0.00824      -0.0156    501      513
 8 hindu     18_TO_24    0.0886        0.0123     57       48
 9 hindu     25_TO_34    0.0475       -0.0976     72      103
10 hindu     35_TO_44    0.0537        0.0181     39       73
# ℹ 24 more rows</code></pre>
</div>
<div class="sourceCode cell-code" id="cb203"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb203-1"><a href="#cb203-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Check religion levels</span></span>
<span id="cb203-2"><a href="#cb203-2" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Available religion levels:</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Available religion levels:</code></pre>
</div>
<div class="sourceCode cell-code" id="cb205"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb205-1"><a href="#cb205-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">unique</span>(gender_gap_by_religion_age<span class="sc">$</span>religion))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "christian" "hindu"     "muslim"    "none"      "other"    </code></pre>
</div>
<div class="sourceCode cell-code" id="cb207"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb207-1"><a href="#cb207-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Create religion comparison for visualization</span></span>
<span id="cb207-2"><a href="#cb207-2" aria-hidden="true" tabindex="-1"></a>religion_comparison <span class="ot">&lt;-</span> gender_gap_by_religion_age <span class="sc">%&gt;%</span></span>
<span id="cb207-3"><a href="#cb207-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="at">cols =</span> <span class="fu">c</span>(social_gap, economic_gap), </span>
<span id="cb207-4"><a href="#cb207-4" aria-hidden="true" tabindex="-1"></a>               <span class="at">names_to =</span> <span class="st">"gap_type"</span>, </span>
<span id="cb207-5"><a href="#cb207-5" aria-hidden="true" tabindex="-1"></a>               <span class="at">values_to =</span> <span class="st">"gap_value"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb207-6"><a href="#cb207-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb207-7"><a href="#cb207-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">gap_type =</span> <span class="fu">case_when</span>(</span>
<span id="cb207-8"><a href="#cb207-8" aria-hidden="true" tabindex="-1"></a>      gap_type <span class="sc">==</span> <span class="st">"social_gap"</span> <span class="sc">~</span> <span class="st">"Social Conservatism Gap"</span>,</span>
<span id="cb207-9"><a href="#cb207-9" aria-hidden="true" tabindex="-1"></a>      gap_type <span class="sc">==</span> <span class="st">"economic_gap"</span> <span class="sc">~</span> <span class="st">"Economic Leftism Gap"</span></span>
<span id="cb207-10"><a href="#cb207-10" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb207-11"><a href="#cb207-11" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb207-12"><a href="#cb207-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb207-13"><a href="#cb207-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Create line plot for religion gaps</span></span>
<span id="cb207-14"><a href="#cb207-14" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(religion_comparison, <span class="fu">aes</span>(<span class="at">x =</span> age, <span class="at">y =</span> gap_value, <span class="at">color =</span> religion, <span class="at">group =</span> religion)) <span class="sc">+</span></span>
<span id="cb207-15"><a href="#cb207-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">size =</span> <span class="fl">1.2</span>) <span class="sc">+</span></span>
<span id="cb207-16"><a href="#cb207-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb207-17"><a href="#cb207-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="dv">0</span>, <span class="at">linetype =</span> <span class="st">"dashed"</span>, <span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb207-18"><a href="#cb207-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>gap_type, <span class="at">scales =</span> <span class="st">"free_y"</span>) <span class="sc">+</span></span>
<span id="cb207-19"><a href="#cb207-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb207-20"><a href="#cb207-20" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Gender Ideological Gaps by Religion"</span>,</span>
<span id="cb207-21"><a href="#cb207-21" aria-hidden="true" tabindex="-1"></a>    <span class="at">subtitle =</span> <span class="st">"How gender divides vary by age and religious affiliation"</span>,</span>
<span id="cb207-22"><a href="#cb207-22" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"Age Group"</span>, </span>
<span id="cb207-23"><a href="#cb207-23" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">"Gender Gap (Male - Female)"</span>,</span>
<span id="cb207-24"><a href="#cb207-24" aria-hidden="true" tabindex="-1"></a>    <span class="at">color =</span> <span class="st">"Religion"</span>,</span>
<span id="cb207-25"><a href="#cb207-25" aria-hidden="true" tabindex="-1"></a>    <span class="at">caption =</span> <span class="st">"Positive = men more conservative/economically left than women"</span></span>
<span id="cb207-26"><a href="#cb207-26" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb207-27"><a href="#cb207-27" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb207-28"><a href="#cb207-28" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(</span>
<span id="cb207-29"><a href="#cb207-29" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">45</span>, <span class="at">hjust =</span> <span class="dv">1</span>),</span>
<span id="cb207-30"><a href="#cb207-30" aria-hidden="true" tabindex="-1"></a>    <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">14</span>, <span class="at">face =</span> <span class="st">"bold"</span>),</span>
<span id="cb207-31"><a href="#cb207-31" aria-hidden="true" tabindex="-1"></a>    <span class="at">strip.text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">12</span>, <span class="at">face =</span> <span class="st">"bold"</span>)</span>
<span id="cb207-32"><a href="#cb207-32" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb207-33"><a href="#cb207-33" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"christian"</span> <span class="ot">=</span> <span class="st">"#8E44AD"</span>, <span class="st">"none"</span> <span class="ot">=</span> <span class="st">"#34495E"</span>, <span class="st">"muslim"</span> <span class="ot">=</span> <span class="st">"#E74C3C"</span>, <span class="st">"hindu"</span> <span class="ot">=</span> <span class="st">"#F39C12"</span>, <span class="st">"other"</span> <span class="ot">=</span> <span class="st">"#27AE60"</span>, <span class="st">"no_answer"</span> <span class="ot">=</span> <span class="st">"#95A5A6"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="initial_analysis_files/figure-html/unnamed-chunk-25-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:80.0%"></p>
</figure>
</div>
</div>
</div>
<p>Some sample size concerns with the above graphics, but gives a good indication of general trends.</p>
</section>
<section id="further-steps-for-research" class="level5">
<h5 class="anchored" data-anchor-id="further-steps-for-research">Further Steps for Research</h5>
<p><strong>Further steps</strong></p>
<p>Currently thinking to create a polarization index, which measures how far someone is from the mean on both social and economic dimensions. Then we can see who is most polarized, and what predicts this. Not necessary for the current project, an idea for future work.</p>
<p>Likewise, merging in historical data from the British Election Study (BES) would allow us to see how these patterns have changed over time, and whether younger generations are truly more polarized than older ones were at the same age. But not necessary for CEO’s immediate priorities.</p>
<p>Additionally, I am considering a more in-depth clustering based analysis of the young person demographic, based on combining issue preferences with demographics like ethnicity, education, and region. This could yield useful archetypes for marketing and communications purposes, but again, could be time-consuming.</p>
<ul>
<li><p>Geographic mapping: urban/rural and constituency-level polarization hotspots</p></li>
<li><p>Polarization intensity metrics: identify most extreme vs moderate young segments</p></li>
<li><p>Attitude clustering: natural groupings and messaging archetypes for corporate strategy</p></li>
<li><p>“Movement” analysis: who is shifting away from older generational patterns most (merging in historical data)</p></li>
<li><p>Issue-specific drivers: which attitudes (social vs economic) drive overall polarization</p></li>
<li><p>Increased usage of the age_numeric variables, more granular analysis of age effects</p></li>
</ul>
</section>
</section>
<section id="function-generation-for-future-use" class="level4">
<h4 class="anchored" data-anchor-id="function-generation-for-future-use">8) Function generation for future use</h4>
<p>Thinking through function generation.</p>
</section>
</section>

</main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->




</body></html>
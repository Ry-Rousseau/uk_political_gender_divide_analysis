<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.6.42">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Your Document Title</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="initial_analysis_files/libs/clipboard/clipboard.min.js"></script>
<script src="initial_analysis_files/libs/quarto-html/quarto.js"></script>
<script src="initial_analysis_files/libs/quarto-html/popper.min.js"></script>
<script src="initial_analysis_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="initial_analysis_files/libs/quarto-html/anchor.min.js"></script>
<link href="initial_analysis_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="initial_analysis_files/libs/quarto-html/quarto-syntax-highlighting-2f5df379a58b258e96c21c0638c20c03.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="initial_analysis_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="initial_analysis_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="initial_analysis_files/libs/bootstrap/bootstrap-1bc8a17f135ab3d594c857e9f48e611b.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">


</head>

<body class="fullcontent">

<div id="quarto-content" class="page-columns page-rows-contents page-layout-article">

<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Your Document Title</h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<section id="research-questions" class="level4">
<h4 class="anchored" data-anchor-id="research-questions">research questions:</h4>
<p>what evidence of this ideological gender divide exists in the UK and is it different across generations?</p>
<p>young peopleʼs attitudes and if we can challenge the idea theyʼre a monolith</p>
<p>how do the above translate into public-facing guidance for the FTSE CEO?</p>
<p>what is the divide? do economic or social views drive the divide that we’re experiencing? can this be drilled down into specific areas of either?</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">source</span>(<span class="st">'scripts/setup.R'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Loading UK Election Study data...
Data loaded successfully!
Dataset dimensions: 32621 rows x 27 columns

Data overview:
Rows: 32,621
Columns: 27
$ respondent_id &lt;chr&gt; "fd0000516392", "fd0000644501", "fd0001323582", "fd00014…
$ wt            &lt;dbl&gt; 1.0414001, 1.0650522, 1.0794774, 1.1965344, 1.9464518, 0…
$ age           &lt;chr&gt; "25_TO_34", "18_TO_24", "25_TO_34", "55_TO_64", "25_TO_3…
$ gender        &lt;chr&gt; "male", "male", "male", "male", "female", "female", "mal…
$ education     &lt;chr&gt; "low", "low", "low", "low", "high", "high", "high", "low…
$ ethnicity     &lt;chr&gt; "white", "white", "white", "white", "other", "white", "w…
$ region        &lt;chr&gt; "East of England", "South West England", "South West Eng…
$ cons_code     &lt;chr&gt; "E14001359", "E14001495", "E14001429", "E14001500", "E14…
$ cons_name     &lt;chr&gt; "Bedfordshire Mid", "Devon South West", "Poole", "Southa…
$ household     &lt;chr&gt; "owns_with_mortgage_or_shared", "owns_with_mortgage_or_s…
$ religion      &lt;chr&gt; "none", "none", "none", "none", "none", "none", "christi…
$ socgrad       &lt;chr&gt; "C2", "AB", "C2", "AB", "DE", "AB", "AB", "DE", "C1", "D…
$ marital       &lt;chr&gt; "relationship_notliving", "single", "relationship_living…
$ pv_2019       &lt;chr&gt; "dnv", "ldm", "con", "brx", "dnv", "dnv", "snp", "lab", …
$ pv_2024       &lt;chr&gt; "rfm", "rfm", "lab", "con", "lab", "lab", "lab", "grn", …
$ eu_ref        &lt;chr&gt; "leave", "dnv", "leave", "leave", "dnv", "remain", "rema…
$ exact_age     &lt;dbl&gt; 26, 22, 26, 61, 30, 30, 41, 44, 66, 73, 21, 80, 65, 77, …
$ econ_redist   &lt;chr&gt; "Neither agree nor disagree", "Strongly agree", "Disagre…
$ econ_bigbiz   &lt;chr&gt; "Neither agree nor disagree", "Strongly agree", "Agree",…
$ econ_unfair   &lt;chr&gt; "Agree", "Strongly agree", "Agree", "Agree", "Disagree",…
$ econ_onelaw   &lt;chr&gt; "Agree", "Agree", "Agree", "Strongly agree", "Agree", "S…
$ econ_exploit  &lt;chr&gt; "Strongly agree", "Strongly agree", "Agree", "Agree", "A…
$ soc_respect   &lt;chr&gt; "Agree", "Strongly agree", "Neither agree nor disagree",…
$ soc_deathpen  &lt;chr&gt; "Strongly agree", "Strongly agree", "Neither agree nor d…
$ soc_schools   &lt;chr&gt; "Neither agree nor disagree", "Strongly agree", "Agree",…
$ soc_censor    &lt;chr&gt; "Strongly disagree", "Strongly agree", "Disagree", "Disa…
$ soc_punish    &lt;chr&gt; "Agree", "Strongly agree", "Agree", "Agree", "Strongly a…</code></pre>
</div>
</div>
</section>
<section id="analysis-plan" class="level4">
<h4 class="anchored" data-anchor-id="analysis-plan">Analysis plan</h4>
<ol type="1">
<li><p>Verify data integrity, create composite social/economic scales</p></li>
<li><p>Generate average scorings based on age-group, calculate differences by individual to age-group scores - how do individual differ from their age cohort?</p></li>
<li><p>Quantify the size of gender differences in liberal/authoritarian attitudes across age groups:</p></li>
</ol>
<ul>
<li>did the 2024 vote exhibit the gender gap? (age/vote distribution by party vote 2024)</li>
<li>is the gap wider amongst younger generations vs.&nbsp;other? (gap size by age band)</li>
<li>specific issue gaps?</li>
</ul>
<ol start="4" type="1">
<li>Modelling stage - how does age, gender, other demographics predict ideology?</li>
</ol>
<ul>
<li>how can we predict party vote, conservatism, economic leftism using the demographic information that we have (weighted regression)?</li>
</ul>
<ol start="5" type="1">
<li>Segmented modelling - how do young people experience different effects to those of all voters?</li>
</ol>
<ul>
<li>Forest plot comparing model coefficients (full sample vs.&nbsp;young people)</li>
<li>Predicted value plot incorporating gender/age from the model</li>
</ul>
<ol start="6" type="1">
<li><p>Visualization creation, draw out most relevant insights from the above stages</p></li>
<li><p>Extended segment analysis</p></li>
</ol>
<ul>
<li>What specific ideological markers are significant for corporate positioning strategy? What specific dimension is driving the growing gender divide for the future?</li>
<li>is this happening mostly in urban areas? can we merge in additional data via use of constituency codes?</li>
</ul>
<ol start="7" type="1">
<li>Based on above results, incorporate into a unified tracking function</li>
</ol>
<ul>
<li>Test this function using survey waves from randomly selected batches from the main data, label for multiple months as proof of concept working.</li>
</ul>
</section>
<section id="how-do-we-measure-political-ideology" class="level3">
<h3 class="anchored" data-anchor-id="how-do-we-measure-political-ideology">How do we measure political ideology?</h3>
<ol type="1">
<li><p>social preferences - conservatism variable</p></li>
<li><p>economic preferences - economic leftism variable</p></li>
<li><p>2024 party vote - between reform, labour, greens, conservatives, etc.</p></li>
<li><p>Tailored topic viewpoints - big business, traditional values, death penalty etc.</p></li>
</ol>
<!-- First stage analysis (basically, where do things stand now?, what is the state of the gender gap across generations from the information that we have now?): -->
<!-- -   Quantify the size of gender differences in liberal/authoritarian attitudes across age groups -->
<!-- -   Show if the gap is wider among younger generations (18-34) vs other -->
<!-- -   Key metric: Gap size in composite social attitudes scale by age band -->
<!-- -   weighted regression model - effect of age, gender, age:gender interaction, education, ethnicity, region, household, religion, social_grade classification, marital status on conservatism + economic leftism + combined right-wing score -->
<!-- 3) Specific guidance - how can messaging and PR change for the company? -->
<!-- -   Challenge the "young monolith" assumption by showing attitude distributions within 18-34 demographic -->
<!-- -   Segment young men vs young women across both economic and social dimensions -->
<!-- -   Identify distinct clusters for targeted messaging -->
<!-- 4) Tracking Dashboard Framework -->
<!-- -   Automated functions to monitor changes over time -->
<!-- -   Key indicators: gender gap trends, generational shifts, attitude polarization metrics -->
<!-- -   Proof of concept using monthly splits from current data -->
<section id="verify-data-qualityintegrity" class="level4">
<h4 class="anchored" data-anchor-id="verify-data-qualityintegrity">1) Verify data quality/integrity</h4>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(VIM)</span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a><span class="co">#VIM::aggr(uk_data, plot = FALSE)</span></span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a><span class="co">#unique(uk_data$eu_ref)</span></span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a><span class="co"># we treat don't know as missing data</span></span>
<span id="cb3-8"><a href="#cb3-8" aria-hidden="true" tabindex="-1"></a><span class="co"># sapply(uk_data[,c(3:6, 11:27)], unique)</span></span>
<span id="cb3-9"><a href="#cb3-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-10"><a href="#cb3-10" aria-hidden="true" tabindex="-1"></a><span class="co"># apply unique to all data</span></span>
<span id="cb3-11"><a href="#cb3-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-12"><a href="#cb3-12" aria-hidden="true" tabindex="-1"></a><span class="co"># encode NA's appropriately</span></span>
<span id="cb3-13"><a href="#cb3-13" aria-hidden="true" tabindex="-1"></a>uk_data <span class="ot">&lt;-</span> uk_data <span class="sc">%&gt;%</span></span>
<span id="cb3-14"><a href="#cb3-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="fu">across</span>(<span class="fu">everything</span>(), <span class="sc">~</span><span class="fu">case_when</span>(</span>
<span id="cb3-15"><a href="#cb3-15" aria-hidden="true" tabindex="-1"></a>    .x <span class="sc">==</span> <span class="st">"Don't know"</span> <span class="sc">~</span> <span class="cn">NA</span>,</span>
<span id="cb3-16"><a href="#cb3-16" aria-hidden="true" tabindex="-1"></a>    .x <span class="sc">==</span> <span class="st">"dk"</span> <span class="sc">~</span> <span class="cn">NA</span>,</span>
<span id="cb3-17"><a href="#cb3-17" aria-hidden="true" tabindex="-1"></a>    .x <span class="sc">==</span> <span class="st">"no_answer"</span> <span class="sc">~</span> <span class="cn">NA</span>,           <span class="co"># religion column</span></span>
<span id="cb3-18"><a href="#cb3-18" aria-hidden="true" tabindex="-1"></a>    .x <span class="sc">==</span> <span class="st">"prefer_not_to_say"</span> <span class="sc">~</span> <span class="cn">NA</span>,   <span class="co"># marital column</span></span>
<span id="cb3-19"><a href="#cb3-19" aria-hidden="true" tabindex="-1"></a>    <span class="cn">TRUE</span> <span class="sc">~</span> .x</span>
<span id="cb3-20"><a href="#cb3-20" aria-hidden="true" tabindex="-1"></a>  )))</span>
<span id="cb3-21"><a href="#cb3-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-22"><a href="#cb3-22" aria-hidden="true" tabindex="-1"></a>VIM<span class="sc">::</span><span class="fu">aggr</span>(uk_data, <span class="at">plot =</span> <span class="cn">FALSE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
 Missings in variables:
     Variable Count
     religion   488
      marital   148
       eu_ref   658
    exact_age    25
  econ_redist   772
  econ_bigbiz   538
  econ_unfair   535
  econ_onelaw   408
 econ_exploit   556
  soc_respect   613
 soc_deathpen   845
  soc_schools   391
   soc_censor   775
   soc_punish   528</code></pre>
</div>
</div>
<p>Generally very few NAs in the data. Roughly equal rates across survey questions.</p>
</section>
<section id="create-composite-economicsocial-ideology-scales" class="level4">
<h4 class="anchored" data-anchor-id="create-composite-economicsocial-ideology-scales">2) Create Composite Economic/Social Ideology Scales</h4>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Function to recode attitude responses to -1 to 1 scale</span></span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>recode_attitude <span class="ot">&lt;-</span> <span class="cf">function</span>(x) {</span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">case_when</span>(</span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a>    x <span class="sc">==</span> <span class="st">"Strongly agree"</span> <span class="sc">~</span> <span class="dv">1</span>,</span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a>    x <span class="sc">==</span> <span class="st">"Agree"</span> <span class="sc">~</span> <span class="fl">0.5</span>,</span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a>    x <span class="sc">==</span> <span class="st">"Neither agree nor disagree"</span> <span class="sc">~</span> <span class="dv">0</span>,</span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a>    x <span class="sc">==</span> <span class="st">"Disagree"</span> <span class="sc">~</span> <span class="sc">-</span><span class="fl">0.5</span>,</span>
<span id="cb5-8"><a href="#cb5-8" aria-hidden="true" tabindex="-1"></a>    x <span class="sc">==</span> <span class="st">"Strongly disagree"</span> <span class="sc">~</span> <span class="sc">-</span><span class="dv">1</span>,</span>
<span id="cb5-9"><a href="#cb5-9" aria-hidden="true" tabindex="-1"></a>    <span class="cn">TRUE</span> <span class="sc">~</span> <span class="cn">NA_real_</span></span>
<span id="cb5-10"><a href="#cb5-10" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb5-11"><a href="#cb5-11" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb5-12"><a href="#cb5-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-13"><a href="#cb5-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Convert attitude variables to numeric and create scales</span></span>
<span id="cb5-14"><a href="#cb5-14" aria-hidden="true" tabindex="-1"></a>uk_data_test <span class="ot">&lt;-</span> uk_data <span class="sc">%&gt;%</span></span>
<span id="cb5-15"><a href="#cb5-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb5-16"><a href="#cb5-16" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Convert social attitude variables to numeric (-2 to 2 scale)</span></span>
<span id="cb5-17"><a href="#cb5-17" aria-hidden="true" tabindex="-1"></a>    <span class="at">soc_respect =</span> <span class="fu">recode_attitude</span>(soc_respect),</span>
<span id="cb5-18"><a href="#cb5-18" aria-hidden="true" tabindex="-1"></a>    <span class="at">soc_deathpen =</span> <span class="fu">recode_attitude</span>(soc_deathpen),</span>
<span id="cb5-19"><a href="#cb5-19" aria-hidden="true" tabindex="-1"></a>    <span class="at">soc_schools =</span> <span class="fu">recode_attitude</span>(soc_schools),</span>
<span id="cb5-20"><a href="#cb5-20" aria-hidden="true" tabindex="-1"></a>    <span class="at">soc_censor =</span> <span class="fu">recode_attitude</span>(soc_censor),</span>
<span id="cb5-21"><a href="#cb5-21" aria-hidden="true" tabindex="-1"></a>    <span class="at">soc_punish =</span> <span class="fu">recode_attitude</span>(soc_punish),</span>
<span id="cb5-22"><a href="#cb5-22" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Convert economic attitude variables to numeric (-2 to 2 scale)</span></span>
<span id="cb5-23"><a href="#cb5-23" aria-hidden="true" tabindex="-1"></a>    <span class="at">econ_redist =</span> <span class="fu">recode_attitude</span>(econ_redist),</span>
<span id="cb5-24"><a href="#cb5-24" aria-hidden="true" tabindex="-1"></a>    <span class="at">econ_bigbiz =</span> <span class="fu">recode_attitude</span>(econ_bigbiz),</span>
<span id="cb5-25"><a href="#cb5-25" aria-hidden="true" tabindex="-1"></a>    <span class="at">econ_unfair =</span> <span class="fu">recode_attitude</span>(econ_unfair),</span>
<span id="cb5-26"><a href="#cb5-26" aria-hidden="true" tabindex="-1"></a>    <span class="at">econ_onelaw =</span> <span class="fu">recode_attitude</span>(econ_onelaw),</span>
<span id="cb5-27"><a href="#cb5-27" aria-hidden="true" tabindex="-1"></a>    <span class="at">econ_exploit =</span> <span class="fu">recode_attitude</span>(econ_exploit)) <span class="sc">%&gt;%</span> </span>
<span id="cb5-28"><a href="#cb5-28" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rowwise</span>() <span class="sc">%&gt;%</span></span>
<span id="cb5-29"><a href="#cb5-29" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb5-30"><a href="#cb5-30" aria-hidden="true" tabindex="-1"></a>    <span class="at">social_conservatism =</span> <span class="fu">mean</span>(<span class="fu">c_across</span>(<span class="fu">c</span>(soc_respect, soc_deathpen, soc_schools, soc_censor, soc_punish)), <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb5-31"><a href="#cb5-31" aria-hidden="true" tabindex="-1"></a>    <span class="at">economic_leftism =</span> <span class="fu">mean</span>(<span class="fu">c_across</span>(<span class="fu">c</span>(econ_redist, econ_bigbiz, econ_unfair, econ_onelaw, econ_exploit)), <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb5-32"><a href="#cb5-32" aria-hidden="true" tabindex="-1"></a>    <span class="at">social_na_count =</span> <span class="fu">sum</span>(<span class="fu">is.na</span>(<span class="fu">c_across</span>(<span class="fu">c</span>(soc_respect, soc_deathpen, soc_schools, soc_censor, soc_punish)))),</span>
<span id="cb5-33"><a href="#cb5-33" aria-hidden="true" tabindex="-1"></a>    <span class="at">economic_na_count =</span> <span class="fu">sum</span>(<span class="fu">is.na</span>(<span class="fu">c_across</span>(<span class="fu">c</span>(econ_redist, econ_bigbiz, econ_unfair, econ_onelaw, econ_exploit))))</span>
<span id="cb5-34"><a href="#cb5-34" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb5-35"><a href="#cb5-35" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>()</span>
<span id="cb5-36"><a href="#cb5-36" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-37"><a href="#cb5-37" aria-hidden="true" tabindex="-1"></a>uk_data <span class="ot">&lt;-</span> uk_data_test</span>
<span id="cb5-38"><a href="#cb5-38" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-39"><a href="#cb5-39" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(uk_data_test<span class="sc">$</span>social_conservatism)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   Min. 1st Qu.  Median    Mean 3rd Qu.    Max.    NA's 
-1.0000  0.1000  0.4000  0.3187  0.6000  1.0000     118 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a>uk_data_test <span class="sc">%&gt;%</span> </span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="fu">is.na</span>(social_conservatism)) <span class="sc">%&gt;%</span> </span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 118 × 31
   respondent_id    wt age      gender education ethnicity region      cons_code
   &lt;chr&gt;         &lt;dbl&gt; &lt;chr&gt;    &lt;chr&gt;  &lt;chr&gt;     &lt;chr&gt;     &lt;chr&gt;       &lt;chr&gt;    
 1 fd0288697394  0.885 25_TO_34 female low       asian     North West… E14001416
 2 fd0408935511  1.06  35_TO_44 female low       white     Scotland    S14000101
 3 fd0700150710  0.778 18_TO_24 male   low       black     South East… E14001599
 4 fd0704501787  0.916 45_TO_54 female low       white     East Midla… E14001266
 5 fd0889318795  0.958 45_TO_54 male   high      white     Greater Lo… E14001085
 6 fd1111550039  0.962 55_TO_64 female low       white     West Midla… E14001473
 7 fd1161681917  0.716 35_TO_44 female high      white     South West… E14001356
 8 fd1276995392  0.887 35_TO_44 female low       white     West Midla… E14001523
 9 fd1329112856  0.876 35_TO_44 female low       white     Yorkshire … E14001452
10 fd1536151046  0.776 55_TO_64 female high      white     Yorkshire … E14001506
# ℹ 108 more rows
# ℹ 23 more variables: cons_name &lt;chr&gt;, household &lt;chr&gt;, religion &lt;chr&gt;,
#   socgrad &lt;chr&gt;, marital &lt;chr&gt;, pv_2019 &lt;chr&gt;, pv_2024 &lt;chr&gt;, eu_ref &lt;chr&gt;,
#   exact_age &lt;dbl&gt;, econ_redist &lt;dbl&gt;, econ_bigbiz &lt;dbl&gt;, econ_unfair &lt;dbl&gt;,
#   econ_onelaw &lt;dbl&gt;, econ_exploit &lt;dbl&gt;, soc_respect &lt;dbl&gt;,
#   soc_deathpen &lt;dbl&gt;, soc_schools &lt;dbl&gt;, soc_censor &lt;dbl&gt;, soc_punish &lt;dbl&gt;,
#   social_conservatism &lt;dbl&gt;, economic_leftism &lt;dbl&gt;, social_na_count &lt;int&gt;, …</code></pre>
</div>
</div>
<p>above scale creation could be optimized for efficiency but is good code. Rowwise operations decrease efficiency, could be eliminated.</p>
<p>Interpreting the scales: - agreement with the social questions implies high social conservatism - agreement with the economic questions implise high economic leftism</p>
</section>
<section id="quantify-size-of-gender-differences-across-age-groups" class="level4">
<h4 class="anchored" data-anchor-id="quantify-size-of-gender-differences-across-age-groups">3) Quantify size of gender differences across age groups</h4>
<section id="vote-shares-in-2024-election-by-gender-and-age-bands" class="level5">
<h5 class="anchored" data-anchor-id="vote-shares-in-2024-election-by-gender-and-age-bands">Vote shares in 2024 election by Gender and Age Bands</h5>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="co"># create a visualization that shows, for each gender in each age band, their vote split in the 2024 election</span></span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a><span class="co"># First, let's examine the vote choices available</span></span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Available 2024 vote choices:</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Available 2024 vote choices:</code></pre>
</div>
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">unique</span>(uk_data<span class="sc">$</span>pv_2024))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "rfm" "lab" "con" "grn" "wnv" "ldm" "snp" "oth" "pcy"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate weighted vote shares by gender and age group</span></span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a>vote_shares <span class="ot">&lt;-</span> uk_data <span class="sc">%&gt;%</span></span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(pv_2024) <span class="sc">&amp;</span> <span class="sc">!</span><span class="fu">is.na</span>(gender) <span class="sc">&amp;</span> <span class="sc">!</span><span class="fu">is.na</span>(age)) <span class="sc">%&gt;%</span></span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(age, gender, pv_2024) <span class="sc">%&gt;%</span></span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(</span>
<span id="cb13-6"><a href="#cb13-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">weighted_count =</span> <span class="fu">sum</span>(wt, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb13-7"><a href="#cb13-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">.groups =</span> <span class="st">"keep"</span></span>
<span id="cb13-8"><a href="#cb13-8" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb13-9"><a href="#cb13-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(age, gender) <span class="sc">%&gt;%</span></span>
<span id="cb13-10"><a href="#cb13-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb13-11"><a href="#cb13-11" aria-hidden="true" tabindex="-1"></a>    <span class="at">total_weighted =</span> <span class="fu">sum</span>(weighted_count),</span>
<span id="cb13-12"><a href="#cb13-12" aria-hidden="true" tabindex="-1"></a>    <span class="at">vote_share =</span> weighted_count <span class="sc">/</span> total_weighted <span class="sc">*</span> <span class="dv">100</span></span>
<span id="cb13-13"><a href="#cb13-13" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb13-14"><a href="#cb13-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>()</span>
<span id="cb13-15"><a href="#cb13-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-16"><a href="#cb13-16" aria-hidden="true" tabindex="-1"></a><span class="co"># Display the data</span></span>
<span id="cb13-17"><a href="#cb13-17" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="st">"Vote shares by age, gender, and party:"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Vote shares by age, gender, and party:"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(vote_shares)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 125 × 6
   age      gender pv_2024 weighted_count total_weighted vote_share
   &lt;chr&gt;    &lt;chr&gt;  &lt;chr&gt;            &lt;dbl&gt;          &lt;dbl&gt;      &lt;dbl&gt;
 1 18_TO_24 female con             145.            1992.      7.29 
 2 18_TO_24 female grn             253.            1992.     12.7  
 3 18_TO_24 female lab            1021.            1992.     51.3  
 4 18_TO_24 female ldm              96.8           1992.      4.86 
 5 18_TO_24 female oth              22.6           1992.      1.14 
 6 18_TO_24 female pcy               6.07          1992.      0.305
 7 18_TO_24 female rfm             180.            1992.      9.01 
 8 18_TO_24 female snp              36.6           1992.      1.84 
 9 18_TO_24 female wnv             231.            1992.     11.6  
10 18_TO_24 male   con             172.            1433.     12.0  
# ℹ 115 more rows</code></pre>
</div>
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="co"># visualization - side-by-side comparison for key parties</span></span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a>major_parties <span class="ot">&lt;-</span> vote_shares <span class="sc">%&gt;%</span></span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(pv_2024 <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"con"</span>, <span class="st">"lab"</span>, <span class="st">"ldm"</span>, <span class="st">"rfm"</span>, <span class="st">"grn"</span>))</span>
<span id="cb17-4"><a href="#cb17-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-5"><a href="#cb17-5" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(major_parties, <span class="fu">aes</span>(<span class="at">x =</span> age, <span class="at">y =</span> vote_share, <span class="at">fill =</span> gender)) <span class="sc">+</span></span>
<span id="cb17-6"><a href="#cb17-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_col</span>(<span class="at">position =</span> <span class="st">"dodge"</span>) <span class="sc">+</span></span>
<span id="cb17-7"><a href="#cb17-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>pv_2024, <span class="at">scales =</span> <span class="st">"free_y"</span>) <span class="sc">+</span></span>
<span id="cb17-8"><a href="#cb17-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb17-9"><a href="#cb17-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Gender Differences in 2024 Vote Choice by Age Group"</span>,</span>
<span id="cb17-10"><a href="#cb17-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">subtitle =</span> <span class="st">"Side-by-side comparison for major parties"</span>,</span>
<span id="cb17-11"><a href="#cb17-11" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"Age Group"</span>,</span>
<span id="cb17-12"><a href="#cb17-12" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">"Vote Share (%)"</span>,</span>
<span id="cb17-13"><a href="#cb17-13" aria-hidden="true" tabindex="-1"></a>    <span class="at">fill =</span> <span class="st">"Gender"</span></span>
<span id="cb17-14"><a href="#cb17-14" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb17-15"><a href="#cb17-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb17-16"><a href="#cb17-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(</span>
<span id="cb17-17"><a href="#cb17-17" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">45</span>, <span class="at">hjust =</span> <span class="dv">1</span>),</span>
<span id="cb17-18"><a href="#cb17-18" aria-hidden="true" tabindex="-1"></a>    <span class="at">strip.text =</span> <span class="fu">element_text</span>(<span class="at">face =</span> <span class="st">"bold"</span>)</span>
<span id="cb17-19"><a href="#cb17-19" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb17-20"><a href="#cb17-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"male"</span> <span class="ot">=</span> <span class="st">"lightblue"</span>, <span class="st">"female"</span> <span class="ot">=</span> <span class="st">"pink"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="initial_analysis_files/figure-html/unnamed-chunk-4-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:80.0%"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="average-social-conservatism-by-genderage-bands" class="level5">
<h5 class="anchored" data-anchor-id="average-social-conservatism-by-genderage-bands">Average social conservatism by gender/age bands</h5>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Load survey package for proper weighted calculations</span></span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(survey)</span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-4"><a href="#cb18-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Create survey design object</span></span>
<span id="cb18-5"><a href="#cb18-5" aria-hidden="true" tabindex="-1"></a>survey_design <span class="ot">&lt;-</span> <span class="fu">svydesign</span>(</span>
<span id="cb18-6"><a href="#cb18-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">ids =</span> <span class="sc">~</span><span class="dv">1</span>,  <span class="co"># no clustering</span></span>
<span id="cb18-7"><a href="#cb18-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">weights =</span> <span class="sc">~</span>wt,</span>
<span id="cb18-8"><a href="#cb18-8" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> uk_data <span class="sc">%&gt;%</span> <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(social_conservatism) <span class="sc">&amp;</span> <span class="sc">!</span><span class="fu">is.na</span>(gender) <span class="sc">&amp;</span> <span class="sc">!</span><span class="fu">is.na</span>(age))</span>
<span id="cb18-9"><a href="#cb18-9" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb18-10"><a href="#cb18-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-11"><a href="#cb18-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate survey-weighted means by age and gender</span></span>
<span id="cb18-12"><a href="#cb18-12" aria-hidden="true" tabindex="-1"></a>social_conservatism_means <span class="ot">&lt;-</span> <span class="fu">svyby</span>(</span>
<span id="cb18-13"><a href="#cb18-13" aria-hidden="true" tabindex="-1"></a>  <span class="sc">~</span>social_conservatism,</span>
<span id="cb18-14"><a href="#cb18-14" aria-hidden="true" tabindex="-1"></a>  <span class="sc">~</span>age <span class="sc">+</span> gender,</span>
<span id="cb18-15"><a href="#cb18-15" aria-hidden="true" tabindex="-1"></a>  <span class="at">design =</span> survey_design,</span>
<span id="cb18-16"><a href="#cb18-16" aria-hidden="true" tabindex="-1"></a>  <span class="at">FUN =</span> svymean,</span>
<span id="cb18-17"><a href="#cb18-17" aria-hidden="true" tabindex="-1"></a>  <span class="at">na.rm =</span> <span class="cn">TRUE</span></span>
<span id="cb18-18"><a href="#cb18-18" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb18-19"><a href="#cb18-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-20"><a href="#cb18-20" aria-hidden="true" tabindex="-1"></a><span class="co"># Convert to data frame and clean up</span></span>
<span id="cb18-21"><a href="#cb18-21" aria-hidden="true" tabindex="-1"></a>social_conservatism_means <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(social_conservatism_means) <span class="sc">%&gt;%</span></span>
<span id="cb18-22"><a href="#cb18-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">mean_social_conservatism =</span> social_conservatism)</span>
<span id="cb18-23"><a href="#cb18-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-24"><a href="#cb18-24" aria-hidden="true" tabindex="-1"></a><span class="co"># Display the results</span></span>
<span id="cb18-25"><a href="#cb18-25" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="st">"Survey-weighted means by age and gender:"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Survey-weighted means by age and gender:"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(social_conservatism_means)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                     age gender mean_social_conservatism          se
18_TO_24.female 18_TO_24 female                0.1460869 0.008286800
25_TO_34.female 25_TO_34 female                0.2607681 0.006890166
35_TO_44.female 35_TO_44 female                0.3067387 0.006918410
45_TO_54.female 45_TO_54 female                0.3494708 0.006760156
55_TO_64.female 55_TO_64 female                0.3949497 0.007455386
65_TO_74.female 65_TO_74 female                0.4284155 0.008263432
75_PLUS.female   75_PLUS female                0.4510734 0.013586050
18_TO_24.male   18_TO_24   male                0.2055819 0.010742247
25_TO_34.male   25_TO_34   male                0.3004190 0.008206120
35_TO_44.male   35_TO_44   male                0.3332870 0.008202318
45_TO_54.male   45_TO_54   male                0.3128641 0.008557283
55_TO_64.male   55_TO_64   male                0.3370399 0.009408996
65_TO_74.male   65_TO_74   male                0.3997589 0.009484841
75_PLUS.male     75_PLUS   male                0.4445209 0.014750208</code></pre>
</div>
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Create barplot</span></span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(social_conservatism_means, <span class="fu">aes</span>(<span class="at">x =</span> age, <span class="at">y =</span> mean_social_conservatism, <span class="at">fill =</span> gender)) <span class="sc">+</span></span>
<span id="cb22-3"><a href="#cb22-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_col</span>(<span class="at">position =</span> <span class="st">"dodge"</span>) <span class="sc">+</span></span>
<span id="cb22-4"><a href="#cb22-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_errorbar</span>(<span class="fu">aes</span>(<span class="at">ymin =</span> mean_social_conservatism <span class="sc">-</span> se,</span>
<span id="cb22-5"><a href="#cb22-5" aria-hidden="true" tabindex="-1"></a>                    <span class="at">ymax =</span> mean_social_conservatism <span class="sc">+</span> se),</span>
<span id="cb22-6"><a href="#cb22-6" aria-hidden="true" tabindex="-1"></a>                <span class="at">position =</span> <span class="fu">position_dodge</span>(<span class="at">width =</span> <span class="fl">0.9</span>), <span class="at">width =</span> <span class="fl">0.25</span>, <span class="at">alpha =</span> <span class="fl">0.7</span>) <span class="sc">+</span></span>
<span id="cb22-7"><a href="#cb22-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb22-8"><a href="#cb22-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Average Social Conservatism Scores by Age Group and Gender"</span>,</span>
<span id="cb22-9"><a href="#cb22-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">subtitle =</span> <span class="st">"Survey-weighted means with standard errors. Higher scores = more conservative"</span>,</span>
<span id="cb22-10"><a href="#cb22-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"Age Group"</span>,</span>
<span id="cb22-11"><a href="#cb22-11" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">"Mean Social Conservatism Score"</span>,</span>
<span id="cb22-12"><a href="#cb22-12" aria-hidden="true" tabindex="-1"></a>    <span class="at">fill =</span> <span class="st">"Gender"</span></span>
<span id="cb22-13"><a href="#cb22-13" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb22-14"><a href="#cb22-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb22-15"><a href="#cb22-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">45</span>, <span class="at">hjust =</span> <span class="dv">1</span>)) <span class="sc">+</span></span>
<span id="cb22-16"><a href="#cb22-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"male"</span> <span class="ot">=</span> <span class="st">"lightblue"</span>, <span class="st">"female"</span> <span class="ot">=</span> <span class="st">"pink"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="initial_analysis_files/figure-html/unnamed-chunk-5-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:80.0%"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="average-economic-leftism-by-genderage-bands" class="level5">
<h5 class="anchored" data-anchor-id="average-economic-leftism-by-genderage-bands">Average economic leftism by gender/age bands</h5>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate survey-weighted means for economic leftism by age and gender</span></span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a>economic_leftism_means <span class="ot">&lt;-</span> <span class="fu">svyby</span>(</span>
<span id="cb23-3"><a href="#cb23-3" aria-hidden="true" tabindex="-1"></a>  <span class="sc">~</span>economic_leftism,</span>
<span id="cb23-4"><a href="#cb23-4" aria-hidden="true" tabindex="-1"></a>  <span class="sc">~</span>age <span class="sc">+</span> gender,</span>
<span id="cb23-5"><a href="#cb23-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">design =</span> survey_design,</span>
<span id="cb23-6"><a href="#cb23-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">FUN =</span> svymean,</span>
<span id="cb23-7"><a href="#cb23-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">na.rm =</span> <span class="cn">TRUE</span></span>
<span id="cb23-8"><a href="#cb23-8" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb23-9"><a href="#cb23-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-10"><a href="#cb23-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Convert to data frame and clean up</span></span>
<span id="cb23-11"><a href="#cb23-11" aria-hidden="true" tabindex="-1"></a>economic_leftism_means <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(economic_leftism_means) <span class="sc">%&gt;%</span></span>
<span id="cb23-12"><a href="#cb23-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">mean_economic_leftism =</span> economic_leftism)</span>
<span id="cb23-13"><a href="#cb23-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-14"><a href="#cb23-14" aria-hidden="true" tabindex="-1"></a><span class="co"># Display the results</span></span>
<span id="cb23-15"><a href="#cb23-15" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="st">"Survey-weighted economic leftism means by age and gender:"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Survey-weighted economic leftism means by age and gender:"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(economic_leftism_means)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                     age gender mean_economic_leftism          se
18_TO_24.female 18_TO_24 female             0.4653603 0.007661601
25_TO_34.female 25_TO_34 female             0.4556771 0.006046594
35_TO_44.female 35_TO_44 female             0.4445916 0.006306771
45_TO_54.female 45_TO_54 female             0.4199695 0.006742521
55_TO_64.female 55_TO_64 female             0.3848760 0.007786974
65_TO_74.female 65_TO_74 female             0.3125429 0.009425094
75_PLUS.female   75_PLUS female             0.2009801 0.015962435
18_TO_24.male   18_TO_24   male             0.3973085 0.010354327
25_TO_34.male   25_TO_34   male             0.4266462 0.007664853
35_TO_44.male   35_TO_44   male             0.4606472 0.007574518
45_TO_54.male   45_TO_54   male             0.4510540 0.008125294
55_TO_64.male   55_TO_64   male             0.4237312 0.009592899
65_TO_74.male   65_TO_74   male             0.3637152 0.010713940
75_PLUS.male     75_PLUS   male             0.1940865 0.017827940</code></pre>
</div>
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Create barplot</span></span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(economic_leftism_means, <span class="fu">aes</span>(<span class="at">x =</span> age, <span class="at">y =</span> mean_economic_leftism, <span class="at">fill =</span> gender)) <span class="sc">+</span></span>
<span id="cb27-3"><a href="#cb27-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_col</span>(<span class="at">position =</span> <span class="st">"dodge"</span>) <span class="sc">+</span></span>
<span id="cb27-4"><a href="#cb27-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_errorbar</span>(<span class="fu">aes</span>(<span class="at">ymin =</span> mean_economic_leftism <span class="sc">-</span> se,</span>
<span id="cb27-5"><a href="#cb27-5" aria-hidden="true" tabindex="-1"></a>                    <span class="at">ymax =</span> mean_economic_leftism <span class="sc">+</span> se),</span>
<span id="cb27-6"><a href="#cb27-6" aria-hidden="true" tabindex="-1"></a>                <span class="at">position =</span> <span class="fu">position_dodge</span>(<span class="at">width =</span> <span class="fl">0.9</span>), <span class="at">width =</span> <span class="fl">0.25</span>, <span class="at">alpha =</span> <span class="fl">0.7</span>) <span class="sc">+</span></span>
<span id="cb27-7"><a href="#cb27-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb27-8"><a href="#cb27-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Average Economic Leftism Scores by Age Group and Gender"</span>,</span>
<span id="cb27-9"><a href="#cb27-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">subtitle =</span> <span class="st">"Survey-weighted means with standard errors. Higher scores = more left-wing"</span>,</span>
<span id="cb27-10"><a href="#cb27-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"Age Group"</span>,</span>
<span id="cb27-11"><a href="#cb27-11" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">"Mean Economic Leftism Score"</span>,</span>
<span id="cb27-12"><a href="#cb27-12" aria-hidden="true" tabindex="-1"></a>    <span class="at">fill =</span> <span class="st">"Gender"</span></span>
<span id="cb27-13"><a href="#cb27-13" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb27-14"><a href="#cb27-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb27-15"><a href="#cb27-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">45</span>, <span class="at">hjust =</span> <span class="dv">1</span>)) <span class="sc">+</span></span>
<span id="cb27-16"><a href="#cb27-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"male"</span> <span class="ot">=</span> <span class="st">"lightblue"</span>, <span class="st">"female"</span> <span class="ot">=</span> <span class="st">"pink"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="initial_analysis_files/figure-html/unnamed-chunk-6-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:80.0%"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="average-social-conservatism-by-exact-age" class="level5">
<h5 class="anchored" data-anchor-id="average-social-conservatism-by-exact-age">Average social conservatism by exact age</h5>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Create survey design object for exact age analysis</span></span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a>survey_design_exact_age <span class="ot">&lt;-</span> <span class="fu">svydesign</span>(</span>
<span id="cb28-3"><a href="#cb28-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">ids =</span> <span class="sc">~</span><span class="dv">1</span>,</span>
<span id="cb28-4"><a href="#cb28-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">weights =</span> <span class="sc">~</span>wt,</span>
<span id="cb28-5"><a href="#cb28-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> uk_data <span class="sc">%&gt;%</span> <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(social_conservatism) <span class="sc">&amp;</span> <span class="sc">!</span><span class="fu">is.na</span>(gender) <span class="sc">&amp;</span> <span class="sc">!</span><span class="fu">is.na</span>(exact_age))</span>
<span id="cb28-6"><a href="#cb28-6" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb28-7"><a href="#cb28-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-8"><a href="#cb28-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate survey-weighted means by exact age and gender</span></span>
<span id="cb28-9"><a href="#cb28-9" aria-hidden="true" tabindex="-1"></a>social_conservatism_by_age <span class="ot">&lt;-</span> <span class="fu">svyby</span>(</span>
<span id="cb28-10"><a href="#cb28-10" aria-hidden="true" tabindex="-1"></a>  <span class="sc">~</span>social_conservatism,</span>
<span id="cb28-11"><a href="#cb28-11" aria-hidden="true" tabindex="-1"></a>  <span class="sc">~</span>exact_age <span class="sc">+</span> gender,</span>
<span id="cb28-12"><a href="#cb28-12" aria-hidden="true" tabindex="-1"></a>  <span class="at">design =</span> survey_design_exact_age,</span>
<span id="cb28-13"><a href="#cb28-13" aria-hidden="true" tabindex="-1"></a>  <span class="at">FUN =</span> svymean,</span>
<span id="cb28-14"><a href="#cb28-14" aria-hidden="true" tabindex="-1"></a>  <span class="at">na.rm =</span> <span class="cn">TRUE</span></span>
<span id="cb28-15"><a href="#cb28-15" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb28-16"><a href="#cb28-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-17"><a href="#cb28-17" aria-hidden="true" tabindex="-1"></a><span class="co"># Convert to data frame and clean up</span></span>
<span id="cb28-18"><a href="#cb28-18" aria-hidden="true" tabindex="-1"></a>social_conservatism_by_age <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(social_conservatism_by_age) <span class="sc">%&gt;%</span></span>
<span id="cb28-19"><a href="#cb28-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">mean_social_conservatism =</span> social_conservatism)</span>
<span id="cb28-20"><a href="#cb28-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-21"><a href="#cb28-21" aria-hidden="true" tabindex="-1"></a><span class="co"># Create line plot with confidence intervals</span></span>
<span id="cb28-22"><a href="#cb28-22" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(social_conservatism_by_age, <span class="fu">aes</span>(<span class="at">x =</span> exact_age, <span class="at">y =</span> mean_social_conservatism, <span class="at">color =</span> gender)) <span class="sc">+</span></span>
<span id="cb28-23"><a href="#cb28-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">size =</span> <span class="fl">1.2</span>) <span class="sc">+</span></span>
<span id="cb28-24"><a href="#cb28-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_ribbon</span>(<span class="fu">aes</span>(<span class="at">ymin =</span> mean_social_conservatism <span class="sc">-</span> <span class="fl">1.96</span><span class="sc">*</span>se,</span>
<span id="cb28-25"><a href="#cb28-25" aria-hidden="true" tabindex="-1"></a>                  <span class="at">ymax =</span> mean_social_conservatism <span class="sc">+</span> <span class="fl">1.96</span><span class="sc">*</span>se,</span>
<span id="cb28-26"><a href="#cb28-26" aria-hidden="true" tabindex="-1"></a>                  <span class="at">fill =</span> gender),</span>
<span id="cb28-27"><a href="#cb28-27" aria-hidden="true" tabindex="-1"></a>              <span class="at">alpha =</span> <span class="fl">0.3</span>, <span class="at">linetype =</span> <span class="dv">0</span>) <span class="sc">+</span></span>
<span id="cb28-28"><a href="#cb28-28" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb28-29"><a href="#cb28-29" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Average Social Conservatism by Exact Age and Gender"</span>,</span>
<span id="cb28-30"><a href="#cb28-30" aria-hidden="true" tabindex="-1"></a>    <span class="at">subtitle =</span> <span class="st">"Survey-weighted means with 95% confidence intervals. Higher scores = more conservative"</span>,</span>
<span id="cb28-31"><a href="#cb28-31" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"Age (Years)"</span>,</span>
<span id="cb28-32"><a href="#cb28-32" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">"Mean Social Conservatism Score"</span>,</span>
<span id="cb28-33"><a href="#cb28-33" aria-hidden="true" tabindex="-1"></a>    <span class="at">color =</span> <span class="st">"Gender"</span>,</span>
<span id="cb28-34"><a href="#cb28-34" aria-hidden="true" tabindex="-1"></a>    <span class="at">fill =</span> <span class="st">"Gender"</span></span>
<span id="cb28-35"><a href="#cb28-35" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb28-36"><a href="#cb28-36" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb28-37"><a href="#cb28-37" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"male"</span> <span class="ot">=</span> <span class="st">"steelblue"</span>, <span class="st">"female"</span> <span class="ot">=</span> <span class="st">"coral"</span>)) <span class="sc">+</span></span>
<span id="cb28-38"><a href="#cb28-38" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"male"</span> <span class="ot">=</span> <span class="st">"steelblue"</span>, <span class="st">"female"</span> <span class="ot">=</span> <span class="st">"coral"</span>)) <span class="sc">+</span></span>
<span id="cb28-39"><a href="#cb28-39" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"bottom"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="initial_analysis_files/figure-html/unnamed-chunk-7-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:80.0%"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="average-economic-leftism-by-exact-age" class="level5">
<h5 class="anchored" data-anchor-id="average-economic-leftism-by-exact-age">Average economic leftism by exact age</h5>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate survey-weighted means for economic leftism by exact age and gender</span></span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a>economic_leftism_by_age <span class="ot">&lt;-</span> <span class="fu">svyby</span>(</span>
<span id="cb29-3"><a href="#cb29-3" aria-hidden="true" tabindex="-1"></a>  <span class="sc">~</span>economic_leftism,</span>
<span id="cb29-4"><a href="#cb29-4" aria-hidden="true" tabindex="-1"></a>  <span class="sc">~</span>exact_age <span class="sc">+</span> gender,</span>
<span id="cb29-5"><a href="#cb29-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">design =</span> survey_design_exact_age,</span>
<span id="cb29-6"><a href="#cb29-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">FUN =</span> svymean,</span>
<span id="cb29-7"><a href="#cb29-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">na.rm =</span> <span class="cn">TRUE</span></span>
<span id="cb29-8"><a href="#cb29-8" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb29-9"><a href="#cb29-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-10"><a href="#cb29-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Convert to data frame and clean up</span></span>
<span id="cb29-11"><a href="#cb29-11" aria-hidden="true" tabindex="-1"></a>economic_leftism_by_age <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(economic_leftism_by_age) <span class="sc">%&gt;%</span></span>
<span id="cb29-12"><a href="#cb29-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">mean_economic_leftism =</span> economic_leftism)</span>
<span id="cb29-13"><a href="#cb29-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-14"><a href="#cb29-14" aria-hidden="true" tabindex="-1"></a><span class="co"># Create line plot with confidence intervals</span></span>
<span id="cb29-15"><a href="#cb29-15" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(economic_leftism_by_age, <span class="fu">aes</span>(<span class="at">x =</span> exact_age, <span class="at">y =</span> mean_economic_leftism, <span class="at">color =</span> gender)) <span class="sc">+</span></span>
<span id="cb29-16"><a href="#cb29-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">size =</span> <span class="fl">1.2</span>) <span class="sc">+</span></span>
<span id="cb29-17"><a href="#cb29-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_ribbon</span>(<span class="fu">aes</span>(<span class="at">ymin =</span> mean_economic_leftism <span class="sc">-</span> <span class="fl">1.96</span><span class="sc">*</span>se,</span>
<span id="cb29-18"><a href="#cb29-18" aria-hidden="true" tabindex="-1"></a>                  <span class="at">ymax =</span> mean_economic_leftism <span class="sc">+</span> <span class="fl">1.96</span><span class="sc">*</span>se,</span>
<span id="cb29-19"><a href="#cb29-19" aria-hidden="true" tabindex="-1"></a>                  <span class="at">fill =</span> gender),</span>
<span id="cb29-20"><a href="#cb29-20" aria-hidden="true" tabindex="-1"></a>              <span class="at">alpha =</span> <span class="fl">0.3</span>, <span class="at">linetype =</span> <span class="dv">0</span>) <span class="sc">+</span></span>
<span id="cb29-21"><a href="#cb29-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb29-22"><a href="#cb29-22" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Average Economic Leftism by Exact Age and Gender"</span>,</span>
<span id="cb29-23"><a href="#cb29-23" aria-hidden="true" tabindex="-1"></a>    <span class="at">subtitle =</span> <span class="st">"Survey-weighted means with 95% confidence intervals. Higher scores = more left-wing"</span>,</span>
<span id="cb29-24"><a href="#cb29-24" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"Age (Years)"</span>,</span>
<span id="cb29-25"><a href="#cb29-25" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">"Mean Economic Leftism Score"</span>,</span>
<span id="cb29-26"><a href="#cb29-26" aria-hidden="true" tabindex="-1"></a>    <span class="at">color =</span> <span class="st">"Gender"</span>,</span>
<span id="cb29-27"><a href="#cb29-27" aria-hidden="true" tabindex="-1"></a>    <span class="at">fill =</span> <span class="st">"Gender"</span></span>
<span id="cb29-28"><a href="#cb29-28" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb29-29"><a href="#cb29-29" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb29-30"><a href="#cb29-30" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"male"</span> <span class="ot">=</span> <span class="st">"steelblue"</span>, <span class="st">"female"</span> <span class="ot">=</span> <span class="st">"coral"</span>)) <span class="sc">+</span></span>
<span id="cb29-31"><a href="#cb29-31" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"male"</span> <span class="ot">=</span> <span class="st">"steelblue"</span>, <span class="st">"female"</span> <span class="ot">=</span> <span class="st">"coral"</span>)) <span class="sc">+</span></span>
<span id="cb29-32"><a href="#cb29-32" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"bottom"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="initial_analysis_files/figure-html/unnamed-chunk-8-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:80.0%"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="gender-gap-summary-table" class="level5">
<h5 class="anchored" data-anchor-id="gender-gap-summary-table">Gender Gap Summary Table</h5>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Gender Gap Summary Table using Survey Package</span></span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="st">"=== GENDER GAP SUMMARY TABLE ==="</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "=== GENDER GAP SUMMARY TABLE ==="</code></pre>
</div>
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate survey-weighted means for social conservatism</span></span>
<span id="cb32-2"><a href="#cb32-2" aria-hidden="true" tabindex="-1"></a>social_means_survey <span class="ot">&lt;-</span> <span class="fu">svyby</span>(</span>
<span id="cb32-3"><a href="#cb32-3" aria-hidden="true" tabindex="-1"></a>  <span class="sc">~</span>social_conservatism,</span>
<span id="cb32-4"><a href="#cb32-4" aria-hidden="true" tabindex="-1"></a>  <span class="sc">~</span>age <span class="sc">+</span> gender,</span>
<span id="cb32-5"><a href="#cb32-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">design =</span> survey_design,</span>
<span id="cb32-6"><a href="#cb32-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">FUN =</span> svymean,</span>
<span id="cb32-7"><a href="#cb32-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">na.rm =</span> <span class="cn">TRUE</span></span>
<span id="cb32-8"><a href="#cb32-8" aria-hidden="true" tabindex="-1"></a>) <span class="sc">%&gt;%</span></span>
<span id="cb32-9"><a href="#cb32-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as.data.frame</span>() <span class="sc">%&gt;%</span></span>
<span id="cb32-10"><a href="#cb32-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(age, gender, social_conservatism) <span class="sc">%&gt;%</span></span>
<span id="cb32-11"><a href="#cb32-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_wider</span>(<span class="at">names_from =</span> gender, <span class="at">values_from =</span> social_conservatism, <span class="at">names_prefix =</span> <span class="st">"social_"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb32-12"><a href="#cb32-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">social_gap =</span> social_male <span class="sc">-</span> social_female)</span>
<span id="cb32-13"><a href="#cb32-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-14"><a href="#cb32-14" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate survey-weighted means for economic leftism  </span></span>
<span id="cb32-15"><a href="#cb32-15" aria-hidden="true" tabindex="-1"></a>economic_means_survey <span class="ot">&lt;-</span> <span class="fu">svyby</span>(</span>
<span id="cb32-16"><a href="#cb32-16" aria-hidden="true" tabindex="-1"></a>  <span class="sc">~</span>economic_leftism,</span>
<span id="cb32-17"><a href="#cb32-17" aria-hidden="true" tabindex="-1"></a>  <span class="sc">~</span>age <span class="sc">+</span> gender,</span>
<span id="cb32-18"><a href="#cb32-18" aria-hidden="true" tabindex="-1"></a>  <span class="at">design =</span> survey_design,</span>
<span id="cb32-19"><a href="#cb32-19" aria-hidden="true" tabindex="-1"></a>  <span class="at">FUN =</span> svymean,</span>
<span id="cb32-20"><a href="#cb32-20" aria-hidden="true" tabindex="-1"></a>  <span class="at">na.rm =</span> <span class="cn">TRUE</span></span>
<span id="cb32-21"><a href="#cb32-21" aria-hidden="true" tabindex="-1"></a>) <span class="sc">%&gt;%</span></span>
<span id="cb32-22"><a href="#cb32-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as.data.frame</span>() <span class="sc">%&gt;%</span></span>
<span id="cb32-23"><a href="#cb32-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(age, gender, economic_leftism) <span class="sc">%&gt;%</span></span>
<span id="cb32-24"><a href="#cb32-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_wider</span>(<span class="at">names_from =</span> gender, <span class="at">values_from =</span> economic_leftism, <span class="at">names_prefix =</span> <span class="st">"economic_"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb32-25"><a href="#cb32-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">economic_gap =</span> economic_male <span class="sc">-</span> economic_female)</span>
<span id="cb32-26"><a href="#cb32-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-27"><a href="#cb32-27" aria-hidden="true" tabindex="-1"></a><span class="co"># Statistical significance tests for each age group</span></span>
<span id="cb32-28"><a href="#cb32-28" aria-hidden="true" tabindex="-1"></a>age_groups <span class="ot">&lt;-</span> <span class="fu">unique</span>(uk_data<span class="sc">$</span>age[<span class="sc">!</span><span class="fu">is.na</span>(uk_data<span class="sc">$</span>age)])</span>
<span id="cb32-29"><a href="#cb32-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-30"><a href="#cb32-30" aria-hidden="true" tabindex="-1"></a><span class="co"># Function to perform survey-weighted t-tests</span></span>
<span id="cb32-31"><a href="#cb32-31" aria-hidden="true" tabindex="-1"></a>perform_survey_ttest <span class="ot">&lt;-</span> <span class="cf">function</span>(age_group, variable) {</span>
<span id="cb32-32"><a href="#cb32-32" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Filter data for this age group</span></span>
<span id="cb32-33"><a href="#cb32-33" aria-hidden="true" tabindex="-1"></a>  age_subset <span class="ot">&lt;-</span> uk_data <span class="sc">%&gt;%</span> </span>
<span id="cb32-34"><a href="#cb32-34" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(age <span class="sc">==</span> age_group, <span class="sc">!</span><span class="fu">is.na</span>(<span class="sc">!!</span><span class="fu">sym</span>(variable)), <span class="sc">!</span><span class="fu">is.na</span>(gender))</span>
<span id="cb32-35"><a href="#cb32-35" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb32-36"><a href="#cb32-36" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span>(<span class="fu">nrow</span>(age_subset) <span class="sc">&lt;</span> <span class="dv">10</span>) <span class="fu">return</span>(<span class="fu">list</span>(<span class="at">p_value =</span> <span class="cn">NA</span>, <span class="at">t_stat =</span> <span class="cn">NA</span>))</span>
<span id="cb32-37"><a href="#cb32-37" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb32-38"><a href="#cb32-38" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Create survey design for this subset</span></span>
<span id="cb32-39"><a href="#cb32-39" aria-hidden="true" tabindex="-1"></a>  design_subset <span class="ot">&lt;-</span> <span class="fu">svydesign</span>(</span>
<span id="cb32-40"><a href="#cb32-40" aria-hidden="true" tabindex="-1"></a>    <span class="at">ids =</span> <span class="sc">~</span><span class="dv">1</span>,</span>
<span id="cb32-41"><a href="#cb32-41" aria-hidden="true" tabindex="-1"></a>    <span class="at">weights =</span> <span class="sc">~</span>wt,</span>
<span id="cb32-42"><a href="#cb32-42" aria-hidden="true" tabindex="-1"></a>    <span class="at">data =</span> age_subset</span>
<span id="cb32-43"><a href="#cb32-43" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb32-44"><a href="#cb32-44" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb32-45"><a href="#cb32-45" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Perform t-test comparing male vs female</span></span>
<span id="cb32-46"><a href="#cb32-46" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tryCatch</span>({</span>
<span id="cb32-47"><a href="#cb32-47" aria-hidden="true" tabindex="-1"></a>    test_result <span class="ot">&lt;-</span> <span class="fu">svyttest</span>(<span class="fu">as.formula</span>(<span class="fu">paste</span>(variable, <span class="st">"~ gender"</span>)), design_subset)</span>
<span id="cb32-48"><a href="#cb32-48" aria-hidden="true" tabindex="-1"></a>    <span class="fu">list</span>(<span class="at">p_value =</span> test_result<span class="sc">$</span>p.value, <span class="at">t_stat =</span> test_result<span class="sc">$</span>statistic)</span>
<span id="cb32-49"><a href="#cb32-49" aria-hidden="true" tabindex="-1"></a>  }, <span class="at">error =</span> <span class="cf">function</span>(e) {</span>
<span id="cb32-50"><a href="#cb32-50" aria-hidden="true" tabindex="-1"></a>    <span class="fu">list</span>(<span class="at">p_value =</span> <span class="cn">NA</span>, <span class="at">t_stat =</span> <span class="cn">NA</span>)</span>
<span id="cb32-51"><a href="#cb32-51" aria-hidden="true" tabindex="-1"></a>  })</span>
<span id="cb32-52"><a href="#cb32-52" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb32-53"><a href="#cb32-53" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-54"><a href="#cb32-54" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate significance tests for all age groups</span></span>
<span id="cb32-55"><a href="#cb32-55" aria-hidden="true" tabindex="-1"></a>significance_results <span class="ot">&lt;-</span> <span class="fu">map_dfr</span>(age_groups, <span class="cf">function</span>(age_gr) {</span>
<span id="cb32-56"><a href="#cb32-56" aria-hidden="true" tabindex="-1"></a>  social_test <span class="ot">&lt;-</span> <span class="fu">perform_survey_ttest</span>(age_gr, <span class="st">"social_conservatism"</span>)</span>
<span id="cb32-57"><a href="#cb32-57" aria-hidden="true" tabindex="-1"></a>  economic_test <span class="ot">&lt;-</span> <span class="fu">perform_survey_ttest</span>(age_gr, <span class="st">"economic_leftism"</span>)</span>
<span id="cb32-58"><a href="#cb32-58" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb32-59"><a href="#cb32-59" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tibble</span>(</span>
<span id="cb32-60"><a href="#cb32-60" aria-hidden="true" tabindex="-1"></a>    <span class="at">age =</span> age_gr,</span>
<span id="cb32-61"><a href="#cb32-61" aria-hidden="true" tabindex="-1"></a>    <span class="at">social_p_value =</span> social_test<span class="sc">$</span>p_value,</span>
<span id="cb32-62"><a href="#cb32-62" aria-hidden="true" tabindex="-1"></a>    <span class="at">social_t_stat =</span> social_test<span class="sc">$</span>t_stat,</span>
<span id="cb32-63"><a href="#cb32-63" aria-hidden="true" tabindex="-1"></a>    <span class="at">economic_p_value =</span> economic_test<span class="sc">$</span>p_value,</span>
<span id="cb32-64"><a href="#cb32-64" aria-hidden="true" tabindex="-1"></a>    <span class="at">economic_t_stat =</span> economic_test<span class="sc">$</span>t_stat</span>
<span id="cb32-65"><a href="#cb32-65" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb32-66"><a href="#cb32-66" aria-hidden="true" tabindex="-1"></a>})</span>
<span id="cb32-67"><a href="#cb32-67" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-68"><a href="#cb32-68" aria-hidden="true" tabindex="-1"></a><span class="co"># Combine into final summary table with significance tests</span></span>
<span id="cb32-69"><a href="#cb32-69" aria-hidden="true" tabindex="-1"></a>gender_gap_summary <span class="ot">&lt;-</span> social_means_survey <span class="sc">%&gt;%</span></span>
<span id="cb32-70"><a href="#cb32-70" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(economic_means_survey, <span class="at">by =</span> <span class="st">"age"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb32-71"><a href="#cb32-71" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(significance_results, <span class="at">by =</span> <span class="st">"age"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb32-72"><a href="#cb32-72" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb32-73"><a href="#cb32-73" aria-hidden="true" tabindex="-1"></a>    <span class="at">social_gap =</span> <span class="fu">round</span>(social_gap, <span class="dv">3</span>),</span>
<span id="cb32-74"><a href="#cb32-74" aria-hidden="true" tabindex="-1"></a>    <span class="at">economic_gap =</span> <span class="fu">round</span>(economic_gap, <span class="dv">3</span>),</span>
<span id="cb32-75"><a href="#cb32-75" aria-hidden="true" tabindex="-1"></a>    <span class="at">social_p_value =</span> <span class="fu">round</span>(social_p_value, <span class="dv">4</span>),</span>
<span id="cb32-76"><a href="#cb32-76" aria-hidden="true" tabindex="-1"></a>    <span class="at">economic_p_value =</span> <span class="fu">round</span>(economic_p_value, <span class="dv">4</span>),</span>
<span id="cb32-77"><a href="#cb32-77" aria-hidden="true" tabindex="-1"></a>    <span class="at">social_significant =</span> <span class="fu">case_when</span>(</span>
<span id="cb32-78"><a href="#cb32-78" aria-hidden="true" tabindex="-1"></a>      <span class="fu">is.na</span>(social_p_value) <span class="sc">~</span> <span class="st">"N/A"</span>,</span>
<span id="cb32-79"><a href="#cb32-79" aria-hidden="true" tabindex="-1"></a>      social_p_value <span class="sc">&lt;</span> <span class="fl">0.001</span> <span class="sc">~</span> <span class="st">"***"</span>,</span>
<span id="cb32-80"><a href="#cb32-80" aria-hidden="true" tabindex="-1"></a>      social_p_value <span class="sc">&lt;</span> <span class="fl">0.01</span> <span class="sc">~</span> <span class="st">"**"</span>, </span>
<span id="cb32-81"><a href="#cb32-81" aria-hidden="true" tabindex="-1"></a>      social_p_value <span class="sc">&lt;</span> <span class="fl">0.05</span> <span class="sc">~</span> <span class="st">"*"</span>,</span>
<span id="cb32-82"><a href="#cb32-82" aria-hidden="true" tabindex="-1"></a>      social_p_value <span class="sc">&lt;</span> <span class="fl">0.1</span> <span class="sc">~</span> <span class="st">"."</span>,</span>
<span id="cb32-83"><a href="#cb32-83" aria-hidden="true" tabindex="-1"></a>      <span class="cn">TRUE</span> <span class="sc">~</span> <span class="st">""</span></span>
<span id="cb32-84"><a href="#cb32-84" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb32-85"><a href="#cb32-85" aria-hidden="true" tabindex="-1"></a>    <span class="at">economic_significant =</span> <span class="fu">case_when</span>(</span>
<span id="cb32-86"><a href="#cb32-86" aria-hidden="true" tabindex="-1"></a>      <span class="fu">is.na</span>(economic_p_value) <span class="sc">~</span> <span class="st">"N/A"</span>,</span>
<span id="cb32-87"><a href="#cb32-87" aria-hidden="true" tabindex="-1"></a>      economic_p_value <span class="sc">&lt;</span> <span class="fl">0.001</span> <span class="sc">~</span> <span class="st">"***"</span>,</span>
<span id="cb32-88"><a href="#cb32-88" aria-hidden="true" tabindex="-1"></a>      economic_p_value <span class="sc">&lt;</span> <span class="fl">0.01</span> <span class="sc">~</span> <span class="st">"**"</span>,</span>
<span id="cb32-89"><a href="#cb32-89" aria-hidden="true" tabindex="-1"></a>      economic_p_value <span class="sc">&lt;</span> <span class="fl">0.05</span> <span class="sc">~</span> <span class="st">"*"</span>, </span>
<span id="cb32-90"><a href="#cb32-90" aria-hidden="true" tabindex="-1"></a>      economic_p_value <span class="sc">&lt;</span> <span class="fl">0.1</span> <span class="sc">~</span> <span class="st">"."</span>,</span>
<span id="cb32-91"><a href="#cb32-91" aria-hidden="true" tabindex="-1"></a>      <span class="cn">TRUE</span> <span class="sc">~</span> <span class="st">""</span></span>
<span id="cb32-92"><a href="#cb32-92" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb32-93"><a href="#cb32-93" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb32-94"><a href="#cb32-94" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(age, social_gap, social_p_value, social_significant, </span>
<span id="cb32-95"><a href="#cb32-95" aria-hidden="true" tabindex="-1"></a>         economic_gap, economic_p_value, economic_significant) <span class="sc">%&gt;%</span></span>
<span id="cb32-96"><a href="#cb32-96" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(age)</span>
<span id="cb32-97"><a href="#cb32-97" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-98"><a href="#cb32-98" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(gender_gap_summary)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 7 × 7
  age      social_gap social_p_value social_significant economic_gap
  &lt;chr&gt;         &lt;dbl&gt;          &lt;dbl&gt; &lt;chr&gt;                     &lt;dbl&gt;
1 18_TO_24      0.059         0      "***"                    -0.068
2 25_TO_34      0.04          0.0002 "***"                    -0.029
3 35_TO_44      0.027         0.0134 "*"                       0.016
4 45_TO_54     -0.037         0.0008 "***"                     0.031
5 55_TO_64     -0.058         0      "***"                     0.039
6 65_TO_74     -0.029         0.0228 "*"                       0.051
7 75_PLUS      -0.007         0.744  ""                       -0.007
# ℹ 2 more variables: economic_p_value &lt;dbl&gt;, economic_significant &lt;chr&gt;</code></pre>
</div>
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">Significance codes: *** p&lt;0.001, ** p&lt;0.01, * p&lt;0.05, . p&lt;0.1</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Significance codes: *** p&lt;0.001, ** p&lt;0.01, * p&lt;0.05, . p&lt;0.1</code></pre>
</div>
</div>
<p>In the above, <strong>a positive gap indicates that males score higher than females on that dimension</strong>.</p>
<p>The exists gap amongst younger age groups is statistically significant. It exits for both genders. Young men are more socially conservative than young women. Young men are also more economically right wing than young women. The gap narrows with age.</p>
<p>Now we’ll drill down into more specific issue areas. These can inform PR, targeting and communication strategy for the FTSE company.</p>
</section>
<section id="specific-issue-divergence-by-gender-and-age-groups" class="level5">
<h5 class="anchored" data-anchor-id="specific-issue-divergence-by-gender-and-age-groups">Specific issue divergence by gender and age groups</h5>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Individual Question Gender Gap Analysis - Overall Rankings</span></span>
<span id="cb36-2"><a href="#cb36-2" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="st">"=== INDIVIDUAL QUESTION GENDER GAPS (OVERALL) ==="</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "=== INDIVIDUAL QUESTION GENDER GAPS (OVERALL) ==="</code></pre>
</div>
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Define all individual attitude questions with descriptions</span></span>
<span id="cb38-2"><a href="#cb38-2" aria-hidden="true" tabindex="-1"></a>attitude_questions <span class="ot">&lt;-</span> <span class="fu">list</span>(</span>
<span id="cb38-3"><a href="#cb38-3" aria-hidden="true" tabindex="-1"></a>  <span class="st">"soc_respect"</span> <span class="ot">=</span> <span class="st">"Young people don't have enough respect for traditional British values"</span>,</span>
<span id="cb38-4"><a href="#cb38-4" aria-hidden="true" tabindex="-1"></a>  <span class="st">"soc_deathpen"</span> <span class="ot">=</span> <span class="st">"Death penalty is most appropriate for some crimes"</span>, </span>
<span id="cb38-5"><a href="#cb38-5" aria-hidden="true" tabindex="-1"></a>  <span class="st">"soc_schools"</span> <span class="ot">=</span> <span class="st">"Schools should teach children to obey authority"</span>,</span>
<span id="cb38-6"><a href="#cb38-6" aria-hidden="true" tabindex="-1"></a>  <span class="st">"soc_censor"</span> <span class="ot">=</span> <span class="st">"Censorship necessary to uphold moral standards"</span>,</span>
<span id="cb38-7"><a href="#cb38-7" aria-hidden="true" tabindex="-1"></a>  <span class="st">"soc_punish"</span> <span class="ot">=</span> <span class="st">"Law breakers should get stiffer sentences"</span>,</span>
<span id="cb38-8"><a href="#cb38-8" aria-hidden="true" tabindex="-1"></a>  <span class="st">"econ_redist"</span> <span class="ot">=</span> <span class="st">"Government should redistribute from better off to less well off"</span>,</span>
<span id="cb38-9"><a href="#cb38-9" aria-hidden="true" tabindex="-1"></a>  <span class="st">"econ_bigbiz"</span> <span class="ot">=</span> <span class="st">"Big business take advantage of ordinary people"</span>,</span>
<span id="cb38-10"><a href="#cb38-10" aria-hidden="true" tabindex="-1"></a>  <span class="st">"econ_unfair"</span> <span class="ot">=</span> <span class="st">"Ordinary people do not get fair share of nation's wealth"</span>, </span>
<span id="cb38-11"><a href="#cb38-11" aria-hidden="true" tabindex="-1"></a>  <span class="st">"econ_onelaw"</span> <span class="ot">=</span> <span class="st">"One law for rich, another for poor"</span>,</span>
<span id="cb38-12"><a href="#cb38-12" aria-hidden="true" tabindex="-1"></a>  <span class="st">"econ_exploit"</span> <span class="ot">=</span> <span class="st">"Management will always try to get better of employees"</span></span>
<span id="cb38-13"><a href="#cb38-13" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb38-14"><a href="#cb38-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-15"><a href="#cb38-15" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate overall gender gaps for each individual question with significance tests</span></span>
<span id="cb38-16"><a href="#cb38-16" aria-hidden="true" tabindex="-1"></a>individual_gaps_overall <span class="ot">&lt;-</span> <span class="fu">map_dfr</span>(<span class="fu">names</span>(attitude_questions), <span class="cf">function</span>(var) {</span>
<span id="cb38-17"><a href="#cb38-17" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Filter data for this question</span></span>
<span id="cb38-18"><a href="#cb38-18" aria-hidden="true" tabindex="-1"></a>  question_data <span class="ot">&lt;-</span> uk_data <span class="sc">%&gt;%</span> <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(<span class="sc">!!</span><span class="fu">sym</span>(var)), <span class="sc">!</span><span class="fu">is.na</span>(gender))</span>
<span id="cb38-19"><a href="#cb38-19" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb38-20"><a href="#cb38-20" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Create survey design</span></span>
<span id="cb38-21"><a href="#cb38-21" aria-hidden="true" tabindex="-1"></a>  design_question <span class="ot">&lt;-</span> <span class="fu">svydesign</span>(<span class="at">ids =</span> <span class="sc">~</span><span class="dv">1</span>, <span class="at">weights =</span> <span class="sc">~</span>wt, <span class="at">data =</span> question_data)</span>
<span id="cb38-22"><a href="#cb38-22" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb38-23"><a href="#cb38-23" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Calculate survey-weighted means by gender</span></span>
<span id="cb38-24"><a href="#cb38-24" aria-hidden="true" tabindex="-1"></a>  means_by_gender <span class="ot">&lt;-</span> <span class="fu">svyby</span>(</span>
<span id="cb38-25"><a href="#cb38-25" aria-hidden="true" tabindex="-1"></a>    <span class="fu">as.formula</span>(<span class="fu">paste</span>(<span class="st">"~"</span>, var)),</span>
<span id="cb38-26"><a href="#cb38-26" aria-hidden="true" tabindex="-1"></a>    <span class="sc">~</span>gender,</span>
<span id="cb38-27"><a href="#cb38-27" aria-hidden="true" tabindex="-1"></a>    <span class="at">design =</span> design_question,</span>
<span id="cb38-28"><a href="#cb38-28" aria-hidden="true" tabindex="-1"></a>    <span class="at">FUN =</span> svymean,</span>
<span id="cb38-29"><a href="#cb38-29" aria-hidden="true" tabindex="-1"></a>    <span class="at">na.rm =</span> <span class="cn">TRUE</span></span>
<span id="cb38-30"><a href="#cb38-30" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb38-31"><a href="#cb38-31" aria-hidden="true" tabindex="-1"></a>    <span class="fu">as.data.frame</span>()</span>
<span id="cb38-32"><a href="#cb38-32" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb38-33"><a href="#cb38-33" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Perform survey-weighted t-test</span></span>
<span id="cb38-34"><a href="#cb38-34" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tryCatch</span>({</span>
<span id="cb38-35"><a href="#cb38-35" aria-hidden="true" tabindex="-1"></a>    ttest_result <span class="ot">&lt;-</span> <span class="fu">svyttest</span>(<span class="fu">as.formula</span>(<span class="fu">paste</span>(var, <span class="st">"~ gender"</span>)), design_question)</span>
<span id="cb38-36"><a href="#cb38-36" aria-hidden="true" tabindex="-1"></a>    p_value <span class="ot">&lt;-</span> ttest_result<span class="sc">$</span>p.value</span>
<span id="cb38-37"><a href="#cb38-37" aria-hidden="true" tabindex="-1"></a>    t_stat <span class="ot">&lt;-</span> ttest_result<span class="sc">$</span>statistic</span>
<span id="cb38-38"><a href="#cb38-38" aria-hidden="true" tabindex="-1"></a>  }, <span class="at">error =</span> <span class="cf">function</span>(e) {</span>
<span id="cb38-39"><a href="#cb38-39" aria-hidden="true" tabindex="-1"></a>    p_value <span class="ot">&lt;-</span> <span class="cn">NA</span></span>
<span id="cb38-40"><a href="#cb38-40" aria-hidden="true" tabindex="-1"></a>    t_stat <span class="ot">&lt;-</span> <span class="cn">NA</span></span>
<span id="cb38-41"><a href="#cb38-41" aria-hidden="true" tabindex="-1"></a>  })</span>
<span id="cb38-42"><a href="#cb38-42" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb38-43"><a href="#cb38-43" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Extract male and female means</span></span>
<span id="cb38-44"><a href="#cb38-44" aria-hidden="true" tabindex="-1"></a>  male_mean <span class="ot">&lt;-</span> means_by_gender[means_by_gender<span class="sc">$</span>gender <span class="sc">==</span> <span class="st">"male"</span>, var]</span>
<span id="cb38-45"><a href="#cb38-45" aria-hidden="true" tabindex="-1"></a>  female_mean <span class="ot">&lt;-</span> means_by_gender[means_by_gender<span class="sc">$</span>gender <span class="sc">==</span> <span class="st">"female"</span>, var]</span>
<span id="cb38-46"><a href="#cb38-46" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb38-47"><a href="#cb38-47" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Calculate gap and significance</span></span>
<span id="cb38-48"><a href="#cb38-48" aria-hidden="true" tabindex="-1"></a>  gender_gap <span class="ot">&lt;-</span> male_mean <span class="sc">-</span> female_mean</span>
<span id="cb38-49"><a href="#cb38-49" aria-hidden="true" tabindex="-1"></a>  significance <span class="ot">&lt;-</span> <span class="fu">case_when</span>(</span>
<span id="cb38-50"><a href="#cb38-50" aria-hidden="true" tabindex="-1"></a>    <span class="fu">is.na</span>(p_value) <span class="sc">~</span> <span class="st">"N/A"</span>,</span>
<span id="cb38-51"><a href="#cb38-51" aria-hidden="true" tabindex="-1"></a>    p_value <span class="sc">&lt;</span> <span class="fl">0.001</span> <span class="sc">~</span> <span class="st">"***"</span>,</span>
<span id="cb38-52"><a href="#cb38-52" aria-hidden="true" tabindex="-1"></a>    p_value <span class="sc">&lt;</span> <span class="fl">0.01</span> <span class="sc">~</span> <span class="st">"**"</span>,</span>
<span id="cb38-53"><a href="#cb38-53" aria-hidden="true" tabindex="-1"></a>    p_value <span class="sc">&lt;</span> <span class="fl">0.05</span> <span class="sc">~</span> <span class="st">"*"</span>,</span>
<span id="cb38-54"><a href="#cb38-54" aria-hidden="true" tabindex="-1"></a>    p_value <span class="sc">&lt;</span> <span class="fl">0.1</span> <span class="sc">~</span> <span class="st">"."</span>,</span>
<span id="cb38-55"><a href="#cb38-55" aria-hidden="true" tabindex="-1"></a>    <span class="cn">TRUE</span> <span class="sc">~</span> <span class="st">""</span></span>
<span id="cb38-56"><a href="#cb38-56" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb38-57"><a href="#cb38-57" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb38-58"><a href="#cb38-58" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Create result</span></span>
<span id="cb38-59"><a href="#cb38-59" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tibble</span>(</span>
<span id="cb38-60"><a href="#cb38-60" aria-hidden="true" tabindex="-1"></a>    <span class="at">question =</span> var,</span>
<span id="cb38-61"><a href="#cb38-61" aria-hidden="true" tabindex="-1"></a>    <span class="at">description =</span> attitude_questions[[var]],</span>
<span id="cb38-62"><a href="#cb38-62" aria-hidden="true" tabindex="-1"></a>    <span class="at">male_mean =</span> <span class="fu">round</span>(male_mean, <span class="dv">3</span>),</span>
<span id="cb38-63"><a href="#cb38-63" aria-hidden="true" tabindex="-1"></a>    <span class="at">female_mean =</span> <span class="fu">round</span>(female_mean, <span class="dv">3</span>),</span>
<span id="cb38-64"><a href="#cb38-64" aria-hidden="true" tabindex="-1"></a>    <span class="at">gender_gap =</span> <span class="fu">round</span>(gender_gap, <span class="dv">3</span>),</span>
<span id="cb38-65"><a href="#cb38-65" aria-hidden="true" tabindex="-1"></a>    <span class="at">p_value =</span> <span class="fu">round</span>(p_value, <span class="dv">4</span>),</span>
<span id="cb38-66"><a href="#cb38-66" aria-hidden="true" tabindex="-1"></a>    <span class="at">significance =</span> significance,</span>
<span id="cb38-67"><a href="#cb38-67" aria-hidden="true" tabindex="-1"></a>    <span class="at">gap_magnitude =</span> <span class="fu">abs</span>(gender_gap)</span>
<span id="cb38-68"><a href="#cb38-68" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb38-69"><a href="#cb38-69" aria-hidden="true" tabindex="-1"></a>}) <span class="sc">%&gt;%</span></span>
<span id="cb38-70"><a href="#cb38-70" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(gap_magnitude))</span>
<span id="cb38-71"><a href="#cb38-71" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-72"><a href="#cb38-72" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(individual_gaps_overall)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 10 × 8
   question    description male_mean female_mean gender_gap p_value significance
   &lt;chr&gt;       &lt;chr&gt;           &lt;dbl&gt;       &lt;dbl&gt;      &lt;dbl&gt;   &lt;dbl&gt; &lt;chr&gt;       
 1 soc_censor  Censorship…     0.139       0.266     -0.127  0      ***         
 2 soc_deathp… Death pena…     0.248       0.179      0.069  0      ***         
 3 soc_schools Schools sh…     0.424       0.364      0.06   0      ***         
 4 soc_respect Young peop…     0.41        0.354      0.056  0      ***         
 5 econ_onelaw One law fo…     0.43        0.471     -0.041  0      ***         
 6 econ_explo… Management…     0.396       0.358      0.038  0      ***         
 7 econ_unfair Ordinary p…     0.414       0.45      -0.035  0      ***         
 8 soc_punish  Law breake…     0.47        0.482     -0.013  0.0279 *           
 9 econ_redist Government…     0.284       0.271      0.013  0.0793 .           
10 econ_bigbiz Big busine…     0.456       0.444      0.013  0.0375 *           
# ℹ 1 more variable: gap_magnitude &lt;dbl&gt;</code></pre>
</div>
<div class="sourceCode cell-code" id="cb40"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">Significance codes: *** p&lt;0.001, ** p&lt;0.01, * p&lt;0.05, . p&lt;0.1</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Significance codes: *** p&lt;0.001, ** p&lt;0.01, * p&lt;0.05, . p&lt;0.1</code></pre>
</div>
</div>
<p>If we examine gender gaps across all ages, some notable trends emerge.</p>
<p>Censorship observed as the strongest point of disagreement, with women being 0.127 points higher on the agreement scale on average. Followed by the death penalty, where men are 0.069 points higher on the agreement scale.</p>
<p>Areas of issue agreement skew towards economic issues, such as government redistribution and predatory big business perceptions. Notably, stances on stiffer punishment sentences are fairly similar across genders.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb42"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Age-Stratified Individual Question Analysis</span></span>
<span id="cb42-2"><a href="#cb42-2" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="st">"=== INDIVIDUAL QUESTION GENDER GAPS BY AGE GROUP ==="</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "=== INDIVIDUAL QUESTION GENDER GAPS BY AGE GROUP ==="</code></pre>
</div>
<div class="sourceCode cell-code" id="cb44"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate gender gaps for each question within each age group with significance tests</span></span>
<span id="cb44-2"><a href="#cb44-2" aria-hidden="true" tabindex="-1"></a>individual_gaps_by_age <span class="ot">&lt;-</span> <span class="fu">map_dfr</span>(<span class="fu">names</span>(attitude_questions), <span class="cf">function</span>(var) {</span>
<span id="cb44-3"><a href="#cb44-3" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Get unique age groups</span></span>
<span id="cb44-4"><a href="#cb44-4" aria-hidden="true" tabindex="-1"></a>  age_groups <span class="ot">&lt;-</span> <span class="fu">unique</span>(uk_data<span class="sc">$</span>age[<span class="sc">!</span><span class="fu">is.na</span>(uk_data<span class="sc">$</span>age)])</span>
<span id="cb44-5"><a href="#cb44-5" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb44-6"><a href="#cb44-6" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Calculate for each age group</span></span>
<span id="cb44-7"><a href="#cb44-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">map_dfr</span>(age_groups, <span class="cf">function</span>(age_gr) {</span>
<span id="cb44-8"><a href="#cb44-8" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Filter data for this age group and question</span></span>
<span id="cb44-9"><a href="#cb44-9" aria-hidden="true" tabindex="-1"></a>    age_data <span class="ot">&lt;-</span> uk_data <span class="sc">%&gt;%</span> </span>
<span id="cb44-10"><a href="#cb44-10" aria-hidden="true" tabindex="-1"></a>      <span class="fu">filter</span>(age <span class="sc">==</span> age_gr, <span class="sc">!</span><span class="fu">is.na</span>(<span class="sc">!!</span><span class="fu">sym</span>(var)), <span class="sc">!</span><span class="fu">is.na</span>(gender))</span>
<span id="cb44-11"><a href="#cb44-11" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb44-12"><a href="#cb44-12" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span>(<span class="fu">nrow</span>(age_data) <span class="sc">&lt;</span> <span class="dv">20</span>) {</span>
<span id="cb44-13"><a href="#cb44-13" aria-hidden="true" tabindex="-1"></a>      <span class="fu">return</span>(<span class="fu">tibble</span>(</span>
<span id="cb44-14"><a href="#cb44-14" aria-hidden="true" tabindex="-1"></a>        <span class="at">question =</span> var,</span>
<span id="cb44-15"><a href="#cb44-15" aria-hidden="true" tabindex="-1"></a>        <span class="at">age =</span> age_gr, </span>
<span id="cb44-16"><a href="#cb44-16" aria-hidden="true" tabindex="-1"></a>        <span class="at">male_mean =</span> <span class="cn">NA</span>,</span>
<span id="cb44-17"><a href="#cb44-17" aria-hidden="true" tabindex="-1"></a>        <span class="at">female_mean =</span> <span class="cn">NA</span>,</span>
<span id="cb44-18"><a href="#cb44-18" aria-hidden="true" tabindex="-1"></a>        <span class="at">gender_gap =</span> <span class="cn">NA</span>,</span>
<span id="cb44-19"><a href="#cb44-19" aria-hidden="true" tabindex="-1"></a>        <span class="at">p_value =</span> <span class="cn">NA</span>,</span>
<span id="cb44-20"><a href="#cb44-20" aria-hidden="true" tabindex="-1"></a>        <span class="at">significance =</span> <span class="st">"N/A"</span></span>
<span id="cb44-21"><a href="#cb44-21" aria-hidden="true" tabindex="-1"></a>      ))</span>
<span id="cb44-22"><a href="#cb44-22" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb44-23"><a href="#cb44-23" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb44-24"><a href="#cb44-24" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Create survey design for this subset</span></span>
<span id="cb44-25"><a href="#cb44-25" aria-hidden="true" tabindex="-1"></a>    design_subset <span class="ot">&lt;-</span> <span class="fu">svydesign</span>(<span class="at">ids =</span> <span class="sc">~</span><span class="dv">1</span>, <span class="at">weights =</span> <span class="sc">~</span>wt, <span class="at">data =</span> age_data)</span>
<span id="cb44-26"><a href="#cb44-26" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb44-27"><a href="#cb44-27" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Calculate means by gender</span></span>
<span id="cb44-28"><a href="#cb44-28" aria-hidden="true" tabindex="-1"></a>    means_by_gender <span class="ot">&lt;-</span> <span class="fu">svyby</span>(</span>
<span id="cb44-29"><a href="#cb44-29" aria-hidden="true" tabindex="-1"></a>      <span class="fu">as.formula</span>(<span class="fu">paste</span>(<span class="st">"~"</span>, var)),</span>
<span id="cb44-30"><a href="#cb44-30" aria-hidden="true" tabindex="-1"></a>      <span class="sc">~</span>gender,</span>
<span id="cb44-31"><a href="#cb44-31" aria-hidden="true" tabindex="-1"></a>      <span class="at">design =</span> design_subset,</span>
<span id="cb44-32"><a href="#cb44-32" aria-hidden="true" tabindex="-1"></a>      <span class="at">FUN =</span> svymean,</span>
<span id="cb44-33"><a href="#cb44-33" aria-hidden="true" tabindex="-1"></a>      <span class="at">na.rm =</span> <span class="cn">TRUE</span></span>
<span id="cb44-34"><a href="#cb44-34" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">%&gt;%</span></span>
<span id="cb44-35"><a href="#cb44-35" aria-hidden="true" tabindex="-1"></a>      <span class="fu">as.data.frame</span>()</span>
<span id="cb44-36"><a href="#cb44-36" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb44-37"><a href="#cb44-37" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Perform survey-weighted t-test</span></span>
<span id="cb44-38"><a href="#cb44-38" aria-hidden="true" tabindex="-1"></a>    <span class="fu">tryCatch</span>({</span>
<span id="cb44-39"><a href="#cb44-39" aria-hidden="true" tabindex="-1"></a>      ttest_result <span class="ot">&lt;-</span> <span class="fu">svyttest</span>(<span class="fu">as.formula</span>(<span class="fu">paste</span>(var, <span class="st">"~ gender"</span>)), design_subset)</span>
<span id="cb44-40"><a href="#cb44-40" aria-hidden="true" tabindex="-1"></a>      p_value <span class="ot">&lt;-</span> ttest_result<span class="sc">$</span>p.value</span>
<span id="cb44-41"><a href="#cb44-41" aria-hidden="true" tabindex="-1"></a>    }, <span class="at">error =</span> <span class="cf">function</span>(e) {</span>
<span id="cb44-42"><a href="#cb44-42" aria-hidden="true" tabindex="-1"></a>      p_value <span class="ot">&lt;-</span> <span class="cn">NA</span></span>
<span id="cb44-43"><a href="#cb44-43" aria-hidden="true" tabindex="-1"></a>    })</span>
<span id="cb44-44"><a href="#cb44-44" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb44-45"><a href="#cb44-45" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Extract means and calculate gap</span></span>
<span id="cb44-46"><a href="#cb44-46" aria-hidden="true" tabindex="-1"></a>    male_mean <span class="ot">&lt;-</span> means_by_gender[means_by_gender<span class="sc">$</span>gender <span class="sc">==</span> <span class="st">"male"</span>, var]</span>
<span id="cb44-47"><a href="#cb44-47" aria-hidden="true" tabindex="-1"></a>    female_mean <span class="ot">&lt;-</span> means_by_gender[means_by_gender<span class="sc">$</span>gender <span class="sc">==</span> <span class="st">"female"</span>, var]</span>
<span id="cb44-48"><a href="#cb44-48" aria-hidden="true" tabindex="-1"></a>    gender_gap <span class="ot">&lt;-</span> male_mean <span class="sc">-</span> female_mean</span>
<span id="cb44-49"><a href="#cb44-49" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb44-50"><a href="#cb44-50" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Calculate significance</span></span>
<span id="cb44-51"><a href="#cb44-51" aria-hidden="true" tabindex="-1"></a>    significance <span class="ot">&lt;-</span> <span class="fu">case_when</span>(</span>
<span id="cb44-52"><a href="#cb44-52" aria-hidden="true" tabindex="-1"></a>      <span class="fu">is.na</span>(p_value) <span class="sc">~</span> <span class="st">"N/A"</span>,</span>
<span id="cb44-53"><a href="#cb44-53" aria-hidden="true" tabindex="-1"></a>      p_value <span class="sc">&lt;</span> <span class="fl">0.001</span> <span class="sc">~</span> <span class="st">"***"</span>,</span>
<span id="cb44-54"><a href="#cb44-54" aria-hidden="true" tabindex="-1"></a>      p_value <span class="sc">&lt;</span> <span class="fl">0.01</span> <span class="sc">~</span> <span class="st">"**"</span>,</span>
<span id="cb44-55"><a href="#cb44-55" aria-hidden="true" tabindex="-1"></a>      p_value <span class="sc">&lt;</span> <span class="fl">0.05</span> <span class="sc">~</span> <span class="st">"*"</span>,</span>
<span id="cb44-56"><a href="#cb44-56" aria-hidden="true" tabindex="-1"></a>      p_value <span class="sc">&lt;</span> <span class="fl">0.1</span> <span class="sc">~</span> <span class="st">"."</span>,</span>
<span id="cb44-57"><a href="#cb44-57" aria-hidden="true" tabindex="-1"></a>      <span class="cn">TRUE</span> <span class="sc">~</span> <span class="st">""</span></span>
<span id="cb44-58"><a href="#cb44-58" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb44-59"><a href="#cb44-59" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb44-60"><a href="#cb44-60" aria-hidden="true" tabindex="-1"></a>    <span class="fu">tibble</span>(</span>
<span id="cb44-61"><a href="#cb44-61" aria-hidden="true" tabindex="-1"></a>      <span class="at">question =</span> var,</span>
<span id="cb44-62"><a href="#cb44-62" aria-hidden="true" tabindex="-1"></a>      <span class="at">age =</span> age_gr,</span>
<span id="cb44-63"><a href="#cb44-63" aria-hidden="true" tabindex="-1"></a>      <span class="at">male_mean =</span> <span class="fu">round</span>(male_mean, <span class="dv">3</span>),</span>
<span id="cb44-64"><a href="#cb44-64" aria-hidden="true" tabindex="-1"></a>      <span class="at">female_mean =</span> <span class="fu">round</span>(female_mean, <span class="dv">3</span>), </span>
<span id="cb44-65"><a href="#cb44-65" aria-hidden="true" tabindex="-1"></a>      <span class="at">gender_gap =</span> <span class="fu">round</span>(gender_gap, <span class="dv">3</span>),</span>
<span id="cb44-66"><a href="#cb44-66" aria-hidden="true" tabindex="-1"></a>      <span class="at">p_value =</span> <span class="fu">round</span>(p_value, <span class="dv">4</span>),</span>
<span id="cb44-67"><a href="#cb44-67" aria-hidden="true" tabindex="-1"></a>      <span class="at">significance =</span> significance</span>
<span id="cb44-68"><a href="#cb44-68" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb44-69"><a href="#cb44-69" aria-hidden="true" tabindex="-1"></a>  })</span>
<span id="cb44-70"><a href="#cb44-70" aria-hidden="true" tabindex="-1"></a>})</span>
<span id="cb44-71"><a href="#cb44-71" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-72"><a href="#cb44-72" aria-hidden="true" tabindex="-1"></a><span class="co"># Create wide format tables with significance information</span></span>
<span id="cb44-73"><a href="#cb44-73" aria-hidden="true" tabindex="-1"></a>gaps_wide <span class="ot">&lt;-</span> individual_gaps_by_age <span class="sc">%&gt;%</span></span>
<span id="cb44-74"><a href="#cb44-74" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(</span>
<span id="cb44-75"><a href="#cb44-75" aria-hidden="true" tabindex="-1"></a>    <span class="fu">tibble</span>(<span class="at">question =</span> <span class="fu">names</span>(attitude_questions), </span>
<span id="cb44-76"><a href="#cb44-76" aria-hidden="true" tabindex="-1"></a>           <span class="at">description =</span> <span class="fu">unlist</span>(attitude_questions)), </span>
<span id="cb44-77"><a href="#cb44-77" aria-hidden="true" tabindex="-1"></a>    <span class="at">by =</span> <span class="st">"question"</span></span>
<span id="cb44-78"><a href="#cb44-78" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb44-79"><a href="#cb44-79" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(question, description, age, gender_gap, significance) <span class="sc">%&gt;%</span></span>
<span id="cb44-80"><a href="#cb44-80" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">gap_with_sig =</span> <span class="fu">paste0</span>(<span class="fu">round</span>(gender_gap, <span class="dv">3</span>), significance)) <span class="sc">%&gt;%</span></span>
<span id="cb44-81"><a href="#cb44-81" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span>gender_gap, <span class="sc">-</span>significance) <span class="sc">%&gt;%</span></span>
<span id="cb44-82"><a href="#cb44-82" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_wider</span>(<span class="at">names_from =</span> age, <span class="at">values_from =</span> gap_with_sig, <span class="at">names_prefix =</span> <span class="st">"gap_"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb44-83"><a href="#cb44-83" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(question)</span>
<span id="cb44-84"><a href="#cb44-84" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-85"><a href="#cb44-85" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(gaps_wide)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 10 × 9
   question     description  gap_25_TO_34 gap_18_TO_24 gap_55_TO_64 gap_35_TO_44
   &lt;chr&gt;        &lt;chr&gt;        &lt;chr&gt;        &lt;chr&gt;        &lt;chr&gt;        &lt;chr&gt;       
 1 econ_bigbiz  Big busines… -0.018       -0.069***    0.062***     0.037**     
 2 econ_exploit Management … 0.015        -0.033.      0.081***     0.066***    
 3 econ_onelaw  One law for… -0.103***    -0.117***    -0.006       -0.028.     
 4 econ_redist  Government … 0.026.       -0.026       0.043*       0.037**     
 5 econ_unfair  Ordinary pe… -0.061***    -0.111***    0.011        -0.028*     
 6 soc_censor   Censorship … 0.004        0.016        -0.255***    -0.043**    
 7 soc_deathpen Death penal… 0.065***     0.076**      0.006        0.066***    
 8 soc_punish   Law breaker… -0.009       0.023        -0.046***    -0.029*     
 9 soc_respect  Young peopl… 0.085***     0.14***      -0.01        0.047**     
10 soc_schools  Schools sho… 0.062***     0.05*        0.019        0.092***    
# ℹ 3 more variables: gap_65_TO_74 &lt;chr&gt;, gap_75_PLUS &lt;chr&gt;, gap_45_TO_54 &lt;chr&gt;</code></pre>
</div>
<div class="sourceCode cell-code" id="cb46"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb46-1"><a href="#cb46-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Show detailed results with significance for largest gaps by age group</span></span>
<span id="cb46-2"><a href="#cb46-2" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">=== LARGEST GENDER GAPS BY AGE GROUP (with significance) ==="</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "\n=== LARGEST GENDER GAPS BY AGE GROUP (with significance) ==="</code></pre>
</div>
<div class="sourceCode cell-code" id="cb48"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb48-1"><a href="#cb48-1" aria-hidden="true" tabindex="-1"></a>largest_gaps_by_age <span class="ot">&lt;-</span> individual_gaps_by_age <span class="sc">%&gt;%</span></span>
<span id="cb48-2"><a href="#cb48-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(gender_gap)) <span class="sc">%&gt;%</span></span>
<span id="cb48-3"><a href="#cb48-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(age) <span class="sc">%&gt;%</span></span>
<span id="cb48-4"><a href="#cb48-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">slice_max</span>(<span class="fu">abs</span>(gender_gap), <span class="at">n =</span> <span class="dv">4</span>) <span class="sc">%&gt;%</span></span>
<span id="cb48-5"><a href="#cb48-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(</span>
<span id="cb48-6"><a href="#cb48-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">tibble</span>(<span class="at">question =</span> <span class="fu">names</span>(attitude_questions), </span>
<span id="cb48-7"><a href="#cb48-7" aria-hidden="true" tabindex="-1"></a>           <span class="at">description =</span> <span class="fu">unlist</span>(attitude_questions)), </span>
<span id="cb48-8"><a href="#cb48-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">by =</span> <span class="st">"question"</span></span>
<span id="cb48-9"><a href="#cb48-9" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb48-10"><a href="#cb48-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(age, question, description, gender_gap, p_value, significance) <span class="sc">%&gt;%</span></span>
<span id="cb48-11"><a href="#cb48-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(age, <span class="fu">desc</span>(<span class="fu">abs</span>(gender_gap)))</span>
<span id="cb48-12"><a href="#cb48-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-13"><a href="#cb48-13" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(largest_gaps_by_age)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 28 × 6
# Groups:   age [7]
   age      question     description             gender_gap p_value significance
   &lt;chr&gt;    &lt;chr&gt;        &lt;chr&gt;                        &lt;dbl&gt;   &lt;dbl&gt; &lt;chr&gt;       
 1 18_TO_24 soc_respect  Young people don't hav…      0.14   0      ***         
 2 18_TO_24 econ_onelaw  One law for rich, anot…     -0.117  0      ***         
 3 18_TO_24 econ_unfair  Ordinary people do not…     -0.111  0      ***         
 4 18_TO_24 soc_deathpen Death penalty is most …      0.076  0.0011 **          
 5 25_TO_34 econ_onelaw  One law for rich, anot…     -0.103  0      ***         
 6 25_TO_34 soc_respect  Young people don't hav…      0.085  0      ***         
 7 25_TO_34 soc_deathpen Death penalty is most …      0.065  0.0002 ***         
 8 25_TO_34 soc_schools  Schools should teach c…      0.062  0      ***         
 9 35_TO_44 soc_schools  Schools should teach c…      0.092  0      ***         
10 35_TO_44 soc_deathpen Death penalty is most …      0.066  0.0003 ***         
# ℹ 18 more rows</code></pre>
</div>
<div class="sourceCode cell-code" id="cb50"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb50-1"><a href="#cb50-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Summary of significant gaps by age group</span></span>
<span id="cb50-2"><a href="#cb50-2" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">=== SIGNIFICANT GAPS SUMMARY BY AGE GROUP ==="</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "\n=== SIGNIFICANT GAPS SUMMARY BY AGE GROUP ==="</code></pre>
</div>
<div class="sourceCode cell-code" id="cb52"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb52-1"><a href="#cb52-1" aria-hidden="true" tabindex="-1"></a>significant_gaps_summary <span class="ot">&lt;-</span> individual_gaps_by_age <span class="sc">%&gt;%</span></span>
<span id="cb52-2"><a href="#cb52-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(p_value), p_value <span class="sc">&lt;</span> <span class="fl">0.05</span>) <span class="sc">%&gt;%</span></span>
<span id="cb52-3"><a href="#cb52-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(age) <span class="sc">%&gt;%</span></span>
<span id="cb52-4"><a href="#cb52-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(</span>
<span id="cb52-5"><a href="#cb52-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">n_significant =</span> <span class="fu">n</span>(),</span>
<span id="cb52-6"><a href="#cb52-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">avg_significant_gap =</span> <span class="fu">round</span>(<span class="fu">mean</span>(<span class="fu">abs</span>(gender_gap)), <span class="dv">3</span>),</span>
<span id="cb52-7"><a href="#cb52-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">largest_gap =</span> <span class="fu">round</span>(<span class="fu">max</span>(<span class="fu">abs</span>(gender_gap)), <span class="dv">3</span>),</span>
<span id="cb52-8"><a href="#cb52-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">.groups =</span> <span class="st">"drop"</span></span>
<span id="cb52-9"><a href="#cb52-9" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb52-10"><a href="#cb52-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(n_significant))</span>
<span id="cb52-11"><a href="#cb52-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-12"><a href="#cb52-12" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(significant_gaps_summary)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 7 × 4
  age      n_significant avg_significant_gap largest_gap
  &lt;chr&gt;            &lt;int&gt;               &lt;dbl&gt;       &lt;dbl&gt;
1 35_TO_44             9               0.049       0.092
2 18_TO_24             6               0.094       0.14 
3 45_TO_54             6               0.076       0.206
4 25_TO_34             5               0.075       0.103
5 55_TO_64             5               0.097       0.255
6 65_TO_74             5               0.126       0.277
7 75_PLUS              3               0.145       0.246</code></pre>
</div>
<div class="sourceCode cell-code" id="cb54"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb54-1"><a href="#cb54-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">Significance codes: *** p&lt;0.001, ** p&lt;0.01, * p&lt;0.05, . p&lt;0.1</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Significance codes: *** p&lt;0.001, ** p&lt;0.01, * p&lt;0.05, . p&lt;0.1</code></pre>
</div>
</div>
<p>After segmenting by age and accounting for statistical significance, young people diverge in terms of specific issues.</p>
<p>We also see that the average gap between genders declines with age, with the specific issue gaps shrinking towards middle age, and then increasing in old age.</p>
<p>Add visualizations for specific issue areas down the line. Good to know these differences.</p>
</section>
</section>
<section id="modelling-stage---how-does-age-gender-other-demographics-predict-ideology" class="level4">
<h4 class="anchored" data-anchor-id="modelling-stage---how-does-age-gender-other-demographics-predict-ideology">4) Modelling stage - how does age, gender, other demographics predict ideology?</h4>
<p><strong>Is the gender-age interaction the primary driver of ideological differences, or do other demographics matter more?</strong> Informs whether the CEO should focus messaging strategies on generational gender gaps vs.&nbsp;other demographic segments.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb56"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb56-1"><a href="#cb56-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Create survey design object</span></span>
<span id="cb56-2"><a href="#cb56-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-3"><a href="#cb56-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Note that we could add stratification to this stage, such as though religion or age. We don't know the stratification scheme. </span></span>
<span id="cb56-4"><a href="#cb56-4" aria-hidden="true" tabindex="-1"></a>survey_design_full <span class="ot">&lt;-</span> <span class="fu">svydesign</span>(</span>
<span id="cb56-5"><a href="#cb56-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">ids =</span> <span class="sc">~</span><span class="dv">1</span>,  <span class="co"># No clustering in this dataset, assumes simple random sampling</span></span>
<span id="cb56-6"><a href="#cb56-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">weights =</span> <span class="sc">~</span>wt,</span>
<span id="cb56-7"><a href="#cb56-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> uk_data</span>
<span id="cb56-8"><a href="#cb56-8" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<section id="m1-social-conservatism-predictors" class="level5">
<h5 class="anchored" data-anchor-id="m1-social-conservatism-predictors">M1: Social Conservatism Predictors</h5>
<p>What demographic factors best predict social conservatism? Is the gender-age interaction significant even after controlling for education, region, etc.?</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb57"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb57-1"><a href="#cb57-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Model social conservatism with full demographic controls</span></span>
<span id="cb57-2"><a href="#cb57-2" aria-hidden="true" tabindex="-1"></a>model_social <span class="ot">&lt;-</span> <span class="fu">svyglm</span>(</span>
<span id="cb57-3"><a href="#cb57-3" aria-hidden="true" tabindex="-1"></a>  social_conservatism <span class="sc">~</span> gender <span class="sc">*</span> age <span class="sc">+</span> education <span class="sc">+</span> ethnicity <span class="sc">+</span> region <span class="sc">+</span> </span>
<span id="cb57-4"><a href="#cb57-4" aria-hidden="true" tabindex="-1"></a>                       household <span class="sc">+</span> socgrad <span class="sc">+</span> marital <span class="sc">+</span> religion,</span>
<span id="cb57-5"><a href="#cb57-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">design =</span> survey_design_full,</span>
<span id="cb57-6"><a href="#cb57-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">family =</span> <span class="fu">gaussian</span>()</span>
<span id="cb57-7"><a href="#cb57-7" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb57-8"><a href="#cb57-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb57-9"><a href="#cb57-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Display model summary</span></span>
<span id="cb57-10"><a href="#cb57-10" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(model_social)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
svyglm(formula = social_conservatism ~ gender * age + education + 
    ethnicity + region + household + socgrad + marital + religion, 
    design = survey_design_full, family = gaussian())

Survey design:
svydesign(ids = ~1, weights = ~wt, data = uk_data)

Coefficients:
                                       Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)                            0.263848   0.017252  15.294  &lt; 2e-16 ***
gendermale                             0.040208   0.013776   2.919 0.003516 ** 
age25_TO_34                            0.119214   0.011123  10.718  &lt; 2e-16 ***
age35_TO_44                            0.144062   0.011369  12.672  &lt; 2e-16 ***
age45_TO_54                            0.162838   0.011390  14.297  &lt; 2e-16 ***
age55_TO_64                            0.174683   0.012147  14.381  &lt; 2e-16 ***
age65_TO_74                            0.176968   0.013333  13.273  &lt; 2e-16 ***
age75_PLUS                             0.198732   0.017314  11.478  &lt; 2e-16 ***
educationlow                           0.141060   0.005432  25.968  &lt; 2e-16 ***
ethnicityblack                         0.027575   0.014242   1.936 0.052855 .  
ethnicitymixed                        -0.118357   0.018539  -6.384 1.74e-10 ***
ethnicityother                        -0.103849   0.025734  -4.035 5.46e-05 ***
ethnicitywhite                        -0.065560   0.011295  -5.804 6.52e-09 ***
regionEast of England                 -0.004785   0.010622  -0.450 0.652374    
regionGreater London                  -0.030090   0.010219  -2.945 0.003236 ** 
regionNorth East England               0.004871   0.013112   0.371 0.710300    
regionNorth West England              -0.019252   0.010204  -1.887 0.059209 .  
regionScotland                        -0.073807   0.011623  -6.350 2.18e-10 ***
regionSouth East England              -0.034924   0.009895  -3.529 0.000417 ***
regionSouth West England              -0.039148   0.010961  -3.572 0.000355 ***
regionWales                           -0.002760   0.012896  -0.214 0.830548    
regionWest Midlands                   -0.003023   0.010756  -0.281 0.778687    
regionYorkshire and the Humber         0.001178   0.010861   0.108 0.913618    
householdowns_with_mortgage_or_shared -0.022032   0.006393  -3.446 0.000569 ***
householdprivate_rented_or_rent_free  -0.037035   0.007190  -5.151 2.61e-07 ***
householdsocial_rented                 0.026447   0.007588   3.485 0.000492 ***
socgradC1                              0.014093   0.006254   2.253 0.024243 *  
socgradC2                              0.082585   0.007143  11.562  &lt; 2e-16 ***
socgradDE                              0.064242   0.007000   9.177  &lt; 2e-16 ***
maritalrelationship_living            -0.034233   0.007285  -4.699 2.63e-06 ***
maritalrelationship_notliving         -0.074900   0.010869  -6.891 5.65e-12 ***
maritalseparated_divorced             -0.051549   0.009394  -5.487 4.11e-08 ***
maritalsingle                         -0.088960   0.006525 -13.635  &lt; 2e-16 ***
maritalwidowed                        -0.035600   0.014306  -2.488 0.012836 *  
religionhindu                          0.055703   0.019629   2.838 0.004545 ** 
religionmuslim                         0.020222   0.012644   1.599 0.109767    
religionnone                          -0.156703   0.005194 -30.168  &lt; 2e-16 ***
religionother                         -0.118324   0.013844  -8.547  &lt; 2e-16 ***
gendermale:age25_TO_34                -0.015688   0.017268  -0.909 0.363601    
gendermale:age35_TO_44                -0.020890   0.017231  -1.212 0.225397    
gendermale:age45_TO_54                -0.066733   0.017251  -3.868 0.000110 ***
gendermale:age55_TO_64                -0.087237   0.017811  -4.898 9.73e-07 ***
gendermale:age65_TO_74                -0.050328   0.018223  -2.762 0.005752 ** 
gendermale:age75_PLUS                 -0.036600   0.023518  -1.556 0.119653    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

(Dispersion parameter for gaussian family taken to be 0.1480392)

Number of Fisher Scoring iterations: 2</code></pre>
</div>
<div class="sourceCode cell-code" id="cb59"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb59-1"><a href="#cb59-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Extract key coefficients for interpretation</span></span>
<span id="cb59-2"><a href="#cb59-2" aria-hidden="true" tabindex="-1"></a>social_coefs <span class="ot">&lt;-</span> <span class="fu">summary</span>(model_social)<span class="sc">$</span>coefficients</span>
<span id="cb59-3"><a href="#cb59-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-4"><a href="#cb59-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Model fit statistics</span></span>
<span id="cb59-5"><a href="#cb59-5" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">Model Fit Statistics:</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Model Fit Statistics:</code></pre>
</div>
<div class="sourceCode cell-code" id="cb61"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb61-1"><a href="#cb61-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Degrees of Freedom:"</span>, model_social<span class="sc">$</span>df.residual, <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Degrees of Freedom: 31855 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb63"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb63-1"><a href="#cb63-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Deviance:"</span>, <span class="fu">round</span>(model_social<span class="sc">$</span>deviance, <span class="dv">3</span>), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Deviance: 4722.153 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb65"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb65-1"><a href="#cb65-1" aria-hidden="true" tabindex="-1"></a><span class="do">##  Check further diagnostics if wanted</span></span>
<span id="cb65-2"><a href="#cb65-2" aria-hidden="true" tabindex="-1"></a><span class="co">#plot(model_social)</span></span>
<span id="cb65-3"><a href="#cb65-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-4"><a href="#cb65-4" aria-hidden="true" tabindex="-1"></a><span class="do">##  VIF Multicollinearity</span></span>
<span id="cb65-5"><a href="#cb65-5" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(car)</span>
<span id="cb65-6"><a href="#cb65-6" aria-hidden="true" tabindex="-1"></a>car<span class="sc">::</span><span class="fu">vif</span>(model_social, <span class="at">type =</span> <span class="st">'terms'</span>)  <span class="co"># Check for multicollinearity</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                 GVIF Df GVIF^(1/(2*Df))
gender       9.717746  1        3.117330
age         51.152048  6        1.388050
education    1.348867  1        1.161408
ethnicity    2.602377  4        1.126993
region       1.260255 10        1.011633
household    1.797995  3        1.102719
socgrad      1.473286  3        1.066714
marital      1.965599  5        1.069916
religion     2.493338  4        1.120979
gender:age 177.681906  6        1.539821</code></pre>
</div>
<div class="sourceCode cell-code" id="cb67"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb67-1"><a href="#cb67-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Number of observations</span></span>
<span id="cb67-2"><a href="#cb67-2" aria-hidden="true" tabindex="-1"></a><span class="fu">nobs</span>(model_social)  <span class="co"># Number of observations</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 31899</code></pre>
</div>
</div>
<p>Above shows similar trends to what we’ve been seeing and hypothesizing.</p>
<p>The main effect shows males are more conservative (+0.040), but the interactions reveal this gender gap narrows with age. In middle age (45-64), the male effect is actually reduced by about 0.067-0.088, suggesting older women catch up in conservatism.</p>
<p>Education: Lower education strongly predicts higher conservatism (+0.141) - one of the largest effects. Religion: No religion has a massive negative effect (-0.157) - the strongest predictor. Hindus are more conservative (+0.054). Geography: Scotland (-0.075), London (-0.031), and South regions are less conservative. Housing: Social renters more conservative (+0.026), private renters less conservative (-0.037).</p>
<p>Note the reference categories in interpreting the above.</p>
</section>
<section id="m2-economic-leftism-predictors" class="level5">
<h5 class="anchored" data-anchor-id="m2-economic-leftism-predictors">M2: Economic Leftism Predictors</h5>
<p>Are the drivers of economic vs social attitudes different? This matters for corporate positioning on economic vs social issues.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb69"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb69-1"><a href="#cb69-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Model economic leftism with same demographic controls</span></span>
<span id="cb69-2"><a href="#cb69-2" aria-hidden="true" tabindex="-1"></a>model_economic <span class="ot">&lt;-</span> <span class="fu">svyglm</span>(</span>
<span id="cb69-3"><a href="#cb69-3" aria-hidden="true" tabindex="-1"></a>  economic_leftism <span class="sc">~</span> gender <span class="sc">*</span> age <span class="sc">+</span> education <span class="sc">+</span> ethnicity <span class="sc">+</span> region <span class="sc">+</span> </span>
<span id="cb69-4"><a href="#cb69-4" aria-hidden="true" tabindex="-1"></a>                    household <span class="sc">+</span> socgrad <span class="sc">+</span> marital <span class="sc">+</span> religion,</span>
<span id="cb69-5"><a href="#cb69-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">design =</span> survey_design_full,</span>
<span id="cb69-6"><a href="#cb69-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">family =</span> <span class="fu">gaussian</span>()</span>
<span id="cb69-7"><a href="#cb69-7" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb69-8"><a href="#cb69-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-9"><a href="#cb69-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Display model summary</span></span>
<span id="cb69-10"><a href="#cb69-10" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(model_economic)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
svyglm(formula = economic_leftism ~ gender * age + education + 
    ethnicity + region + household + socgrad + marital + religion, 
    design = survey_design_full, family = gaussian())

Survey design:
svydesign(ids = ~1, weights = ~wt, data = uk_data)

Coefficients:
                                        Estimate Std. Error t value Pr(&gt;|t|)
(Intercept)                            0.2463233  0.0177117  13.907  &lt; 2e-16
gendermale                            -0.0607960  0.0130386  -4.663 3.13e-06
age25_TO_34                            0.0029225  0.0102275   0.286 0.775075
age35_TO_44                           -0.0045257  0.0105687  -0.428 0.668496
age45_TO_54                           -0.0246637  0.0109471  -2.253 0.024267
age55_TO_64                           -0.0357851  0.0120620  -2.967 0.003012
age65_TO_74                           -0.0889206  0.0138277  -6.431 1.29e-10
age75_PLUS                            -0.1751175  0.0197848  -8.851  &lt; 2e-16
educationlow                           0.0019046  0.0056097   0.340 0.734215
ethnicityblack                        -0.0065347  0.0149261  -0.438 0.661533
ethnicitymixed                         0.0581455  0.0181577   3.202 0.001365
ethnicityother                        -0.0081805  0.0272518  -0.300 0.764041
ethnicitywhite                         0.0281636  0.0113553   2.480 0.013136
regionEast of England                 -0.0037222  0.0117056  -0.318 0.750500
regionGreater London                   0.0048767  0.0112089   0.435 0.663511
regionNorth East England               0.0303654  0.0141930   2.139 0.032406
regionNorth West England               0.0558963  0.0109714   5.095 3.51e-07
regionScotland                         0.0476080  0.0123628   3.851 0.000118
regionSouth East England              -0.0253519  0.0109720  -2.311 0.020861
regionSouth West England              -0.0055167  0.0118901  -0.464 0.642666
regionWales                            0.0359415  0.0144146   2.493 0.012657
regionWest Midlands                    0.0064107  0.0117336   0.546 0.584828
regionYorkshire and the Humber         0.0317817  0.0119079   2.669 0.007613
householdowns_with_mortgage_or_shared  0.0531819  0.0068449   7.770 8.11e-15
householdprivate_rented_or_rent_free   0.0829973  0.0073889  11.233  &lt; 2e-16
householdsocial_rented                 0.1207294  0.0080555  14.987  &lt; 2e-16
socgradC1                              0.0614864  0.0066477   9.249  &lt; 2e-16
socgradC2                              0.0845373  0.0076508  11.049  &lt; 2e-16
socgradDE                              0.1028401  0.0074641  13.778  &lt; 2e-16
maritalrelationship_living             0.0193820  0.0073457   2.639 0.008330
maritalrelationship_notliving          0.0413095  0.0107708   3.835 0.000126
maritalseparated_divorced             -0.0003969  0.0104908  -0.038 0.969822
maritalsingle                          0.0226641  0.0066433   3.412 0.000647
maritalwidowed                        -0.0033191  0.0166337  -0.200 0.841841
religionhindu                          0.0327363  0.0212629   1.540 0.123669
religionmuslim                         0.0469716  0.0131611   3.569 0.000359
religionnone                           0.0554818  0.0055102  10.069  &lt; 2e-16
religionother                          0.0703502  0.0144223   4.878 1.08e-06
gendermale:age25_TO_34                 0.0512152  0.0162600   3.150 0.001636
gendermale:age35_TO_44                 0.0992933  0.0163646   6.068 1.31e-09
gendermale:age45_TO_54                 0.0983186  0.0166525   5.904 3.58e-09
gendermale:age55_TO_64                 0.1026168  0.0177927   5.767 8.13e-09
gendermale:age65_TO_74                 0.1112159  0.0191398   5.811 6.28e-09
gendermale:age75_PLUS                  0.0610380  0.0271902   2.245 0.024784
                                         
(Intercept)                           ***
gendermale                            ***
age25_TO_34                              
age35_TO_44                              
age45_TO_54                           *  
age55_TO_64                           ** 
age65_TO_74                           ***
age75_PLUS                            ***
educationlow                             
ethnicityblack                           
ethnicitymixed                        ** 
ethnicityother                           
ethnicitywhite                        *  
regionEast of England                    
regionGreater London                     
regionNorth East England              *  
regionNorth West England              ***
regionScotland                        ***
regionSouth East England              *  
regionSouth West England                 
regionWales                           *  
regionWest Midlands                      
regionYorkshire and the Humber        ** 
householdowns_with_mortgage_or_shared ***
householdprivate_rented_or_rent_free  ***
householdsocial_rented                ***
socgradC1                             ***
socgradC2                             ***
socgradDE                             ***
maritalrelationship_living            ** 
maritalrelationship_notliving         ***
maritalseparated_divorced                
maritalsingle                         ***
maritalwidowed                           
religionhindu                            
religionmuslim                        ***
religionnone                          ***
religionother                         ***
gendermale:age25_TO_34                ** 
gendermale:age35_TO_44                ***
gendermale:age45_TO_54                ***
gendermale:age55_TO_64                ***
gendermale:age65_TO_74                ***
gendermale:age75_PLUS                 *  
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

(Dispersion parameter for gaussian family taken to be 0.1570175)

Number of Fisher Scoring iterations: 2</code></pre>
</div>
<div class="sourceCode cell-code" id="cb71"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb71-1"><a href="#cb71-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Extract key coefficients for interpretation</span></span>
<span id="cb71-2"><a href="#cb71-2" aria-hidden="true" tabindex="-1"></a>economic_coefs <span class="ot">&lt;-</span> <span class="fu">summary</span>(model_economic)<span class="sc">$</span>coefficients</span>
<span id="cb71-3"><a href="#cb71-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb71-4"><a href="#cb71-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Model fit statistics</span></span>
<span id="cb71-5"><a href="#cb71-5" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">Model Fit Statistics:</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Model Fit Statistics:</code></pre>
</div>
<div class="sourceCode cell-code" id="cb73"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb73-1"><a href="#cb73-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Degrees of Freedom:"</span>, model_economic<span class="sc">$</span>df.residual, <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Degrees of Freedom: 31825 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb75"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb75-1"><a href="#cb75-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Deviance:"</span>, <span class="fu">round</span>(model_economic<span class="sc">$</span>deviance, <span class="dv">3</span>), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Deviance: 5003.835 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb77"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb77-1"><a href="#cb77-1" aria-hidden="true" tabindex="-1"></a><span class="do">##  Check further diagnostics if wanted</span></span>
<span id="cb77-2"><a href="#cb77-2" aria-hidden="true" tabindex="-1"></a><span class="co">#plot(model_economic)</span></span>
<span id="cb77-3"><a href="#cb77-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb77-4"><a href="#cb77-4" aria-hidden="true" tabindex="-1"></a><span class="do">##  VIF Multicollinearity</span></span>
<span id="cb77-5"><a href="#cb77-5" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(car)</span>
<span id="cb77-6"><a href="#cb77-6" aria-hidden="true" tabindex="-1"></a>car<span class="sc">::</span><span class="fu">vif</span>(model_economic, <span class="at">type =</span> <span class="st">'terms'</span>)  <span class="co"># Check for multicollinearity</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                 GVIF Df GVIF^(1/(2*Df))
gender       8.549294  1        2.923918
age         47.459140  6        1.379410
education    1.337270  1        1.156404
ethnicity    2.431647  4        1.117474
region       1.294027 10        1.012971
household    1.763941  3        1.099210
socgrad      1.472152  3        1.066577
marital      2.112874  5        1.077674
religion     2.479926  4        1.120224
gender:age 147.144274  6        1.515812</code></pre>
</div>
<div class="sourceCode cell-code" id="cb79"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb79-1"><a href="#cb79-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Number of observations</span></span>
<span id="cb79-2"><a href="#cb79-2" aria-hidden="true" tabindex="-1"></a><span class="fu">nobs</span>(model_economic)  <span class="co"># Number of observations</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 31869</code></pre>
</div>
</div>
<p>Again, similar trends as seen from our prior visuals and analysis.</p>
<p>Interpeting the economic leftism model:</p>
<p>Older men become much more economically right-wing than older women.</p>
<p>Social renters most left-wing (+0.12) - much stronger than in social conservatism</p>
<p>Lower social grades more left-wing (DE: +0.10, C2: +0.08)</p>
<p>Education has no effect (unlike strong effect in social conservatism)</p>
<p>North West, Scotland, Wales, Yorkshire more left-wing</p>
<p>South East less left-wing (-0.03)</p>
<p>No religion associated with more economic leftism (+0.06)</p>
<p>Overall, housing is a more important driver in economic leftism than social conservatism.</p>
<p>Some classic political archetypes evidence in the data.</p>
</section>
<section id="m3-vote-choice-prediction" class="level5">
<h5 class="anchored" data-anchor-id="m3-vote-choice-prediction">M3: Vote Choice Prediction</h5>
<p>Do ideological attitudes predict vote better than demographics alone? This tests whether corporate positioning should focus on values vs identity.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb81"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb81-1"><a href="#cb81-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Conservative vote model</span></span>
<span id="cb81-2"><a href="#cb81-2" aria-hidden="true" tabindex="-1"></a>model_vote_con <span class="ot">&lt;-</span> <span class="fu">svyglm</span>(</span>
<span id="cb81-3"><a href="#cb81-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">I</span>(pv_2024 <span class="sc">==</span> <span class="st">"con"</span>) <span class="sc">~</span> gender <span class="sc">*</span> age <span class="sc">+</span> education <span class="sc">+</span> ethnicity <span class="sc">+</span> region,</span>
<span id="cb81-4"><a href="#cb81-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">design =</span> survey_design_full,</span>
<span id="cb81-5"><a href="#cb81-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">family =</span> <span class="fu">binomial</span>(<span class="at">link =</span> <span class="st">"logit"</span>)</span>
<span id="cb81-6"><a href="#cb81-6" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb81-7"><a href="#cb81-7" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(model_vote_con)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
svyglm(formula = I(pv_2024 == "con") ~ gender * age + education + 
    ethnicity + region, design = survey_design_full, family = binomial(link = "logit"))

Survey design:
svydesign(ids = ~1, weights = ~wt, data = uk_data)

Coefficients:
                               Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)                    -2.26052    0.11139 -20.293  &lt; 2e-16 ***
gendermale                      0.52581    0.11691   4.498 6.90e-06 ***
age25_TO_34                     0.49704    0.09935   5.003 5.67e-07 ***
age35_TO_44                     0.74231    0.09776   7.593 3.20e-14 ***
age45_TO_54                     0.88766    0.09851   9.011  &lt; 2e-16 ***
age55_TO_64                     1.27420    0.09732  13.092  &lt; 2e-16 ***
age65_TO_74                     1.83339    0.09819  18.673  &lt; 2e-16 ***
age75_PLUS                      2.26953    0.11583  19.593  &lt; 2e-16 ***
educationlow                   -0.11227    0.03318  -3.384 0.000716 ***
ethnicityblack                  0.05472    0.08648   0.633 0.526876    
ethnicitymixed                 -0.50797    0.13888  -3.657 0.000255 ***
ethnicityother                 -0.35509    0.20193  -1.758 0.078682 .  
ethnicitywhite                 -0.14202    0.05979  -2.375 0.017549 *  
regionEast of England           0.01796    0.07378   0.243 0.807708    
regionGreater London            0.12584    0.06987   1.801 0.071704 .  
regionNorth East England       -0.27680    0.09568  -2.893 0.003818 ** 
regionNorth West England       -0.26219    0.07339  -3.573 0.000354 ***
regionScotland                 -0.75249    0.08889  -8.465  &lt; 2e-16 ***
regionSouth East England        0.04368    0.06899   0.633 0.526617    
regionSouth West England       -0.14748    0.07775  -1.897 0.057870 .  
regionWales                    -0.24443    0.09133  -2.676 0.007448 ** 
regionWest Midlands            -0.01596    0.07603  -0.210 0.833740    
regionYorkshire and the Humber -0.16503    0.07756  -2.128 0.033374 *  
gendermale:age25_TO_34         -0.11612    0.13889  -0.836 0.403127    
gendermale:age35_TO_44         -0.32237    0.13735  -2.347 0.018932 *  
gendermale:age45_TO_54         -0.37354    0.13741  -2.718 0.006564 ** 
gendermale:age55_TO_64         -0.55967    0.13658  -4.098 4.18e-05 ***
gendermale:age65_TO_74         -0.56208    0.13601  -4.133 3.59e-05 ***
gendermale:age75_PLUS          -0.63382    0.16023  -3.956 7.64e-05 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

(Dispersion parameter for binomial family taken to be 1.00038)

Number of Fisher Scoring iterations: 5</code></pre>
</div>
<div class="sourceCode cell-code" id="cb83"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb83-1"><a href="#cb83-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Labour vote model</span></span>
<span id="cb83-2"><a href="#cb83-2" aria-hidden="true" tabindex="-1"></a>model_vote_lab <span class="ot">&lt;-</span> <span class="fu">svyglm</span>(</span>
<span id="cb83-3"><a href="#cb83-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">I</span>(pv_2024 <span class="sc">==</span> <span class="st">"lab"</span>) <span class="sc">~</span> gender <span class="sc">*</span> age <span class="sc">+</span> education <span class="sc">+</span> ethnicity <span class="sc">+</span> region,</span>
<span id="cb83-4"><a href="#cb83-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">design =</span> survey_design_full,</span>
<span id="cb83-5"><a href="#cb83-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">family =</span> <span class="fu">binomial</span>(<span class="at">link =</span> <span class="st">"logit"</span>)</span>
<span id="cb83-6"><a href="#cb83-6" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb83-7"><a href="#cb83-7" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(model_vote_lab)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
svyglm(formula = I(pv_2024 == "lab") ~ gender * age + education + 
    ethnicity + region, design = survey_design_full, family = binomial(link = "logit"))

Survey design:
svydesign(ids = ~1, weights = ~wt, data = uk_data)

Coefficients:
                                Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)                     0.258145   0.071791   3.596 0.000324 ***
gendermale                     -0.270354   0.070850  -3.816 0.000136 ***
age25_TO_34                    -0.070992   0.055600  -1.277 0.201667    
age35_TO_44                    -0.245670   0.056308  -4.363 1.29e-05 ***
age45_TO_54                    -0.360381   0.056919  -6.331 2.46e-10 ***
age55_TO_64                    -0.521564   0.059326  -8.791  &lt; 2e-16 ***
age65_TO_74                    -0.862408   0.066021 -13.063  &lt; 2e-16 ***
age75_PLUS                     -1.318051   0.106539 -12.372  &lt; 2e-16 ***
educationlow                   -0.208140   0.025439  -8.182 2.89e-16 ***
ethnicityblack                  0.491127   0.067458   7.280 3.40e-13 ***
ethnicitymixed                  0.325531   0.090669   3.590 0.000331 ***
ethnicityother                 -0.018102   0.141281  -0.128 0.898046    
ethnicitywhite                 -0.107871   0.045101  -2.392 0.016773 *  
regionEast of England          -0.161983   0.058290  -2.779 0.005457 ** 
regionGreater London           -0.001474   0.054522  -0.027 0.978432    
regionNorth East England        0.337337   0.071230   4.736 2.19e-06 ***
regionNorth West England        0.359530   0.055052   6.531 6.64e-11 ***
regionScotland                 -0.250088   0.064955  -3.850 0.000118 ***
regionSouth East England       -0.256928   0.054940  -4.677 2.93e-06 ***
regionSouth West England       -0.359465   0.060275  -5.964 2.49e-09 ***
regionWales                    -0.032659   0.068639  -0.476 0.634212    
regionWest Midlands             0.024062   0.058374   0.412 0.680185    
regionYorkshire and the Humber  0.100606   0.059756   1.684 0.092265 .  
gendermale:age25_TO_34          0.268505   0.088677   3.028 0.002465 ** 
gendermale:age35_TO_44          0.338572   0.088742   3.815 0.000136 ***
gendermale:age45_TO_54          0.241803   0.089534   2.701 0.006924 ** 
gendermale:age55_TO_64          0.171014   0.092431   1.850 0.064295 .  
gendermale:age65_TO_74          0.218115   0.100369   2.173 0.029777 *  
gendermale:age75_PLUS           0.251013   0.151993   1.651 0.098650 .  
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

(Dispersion parameter for binomial family taken to be 1.000825)

Number of Fisher Scoring iterations: 5</code></pre>
</div>
<div class="sourceCode cell-code" id="cb85"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb85-1"><a href="#cb85-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Reform vote model</span></span>
<span id="cb85-2"><a href="#cb85-2" aria-hidden="true" tabindex="-1"></a>model_vote_rfm <span class="ot">&lt;-</span> <span class="fu">svyglm</span>(</span>
<span id="cb85-3"><a href="#cb85-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">I</span>(pv_2024 <span class="sc">==</span> <span class="st">"rfm"</span>) <span class="sc">~</span> gender <span class="sc">*</span> age <span class="sc">+</span> education <span class="sc">+</span> ethnicity <span class="sc">+</span> region,</span>
<span id="cb85-4"><a href="#cb85-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">design =</span> survey_design_full,</span>
<span id="cb85-5"><a href="#cb85-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">family =</span> <span class="fu">binomial</span>(<span class="at">link =</span> <span class="st">"logit"</span>)</span>
<span id="cb85-6"><a href="#cb85-6" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb85-7"><a href="#cb85-7" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(model_vote_rfm)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
svyglm(formula = I(pv_2024 == "rfm") ~ gender * age + education + 
    ethnicity + region, design = survey_design_full, family = binomial(link = "logit"))

Survey design:
svydesign(ids = ~1, weights = ~wt, data = uk_data)

Coefficients:
                               Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)                    -3.17315    0.12974 -24.458  &lt; 2e-16 ***
gendermale                      0.42804    0.11214   3.817 0.000135 ***
age25_TO_34                    -0.09477    0.09839  -0.963 0.335481    
age35_TO_44                     0.12200    0.09502   1.284 0.199169    
age45_TO_54                     0.31652    0.09269   3.415 0.000639 ***
age55_TO_64                     0.45756    0.09204   4.971 6.68e-07 ***
age65_TO_74                     0.46054    0.09703   4.747 2.08e-06 ***
age75_PLUS                      0.31939    0.13175   2.424 0.015348 *  
educationlow                    0.48959    0.03999  12.242  &lt; 2e-16 ***
ethnicityblack                 -0.37287    0.16433  -2.269 0.023270 *  
ethnicitymixed                  0.17688    0.17809   0.993 0.320616    
ethnicityother                 -0.03324    0.30426  -0.109 0.913018    
ethnicitywhite                  0.87291    0.09375   9.311  &lt; 2e-16 ***
regionEast of England           0.04414    0.07882   0.560 0.575474    
regionGreater London           -0.31576    0.08235  -3.835 0.000126 ***
regionNorth East England        0.05175    0.09518   0.544 0.586638    
regionNorth West England       -0.22694    0.07784  -2.915 0.003556 ** 
regionScotland                 -1.08738    0.10575 -10.282  &lt; 2e-16 ***
regionSouth East England       -0.10900    0.07539  -1.446 0.148222    
regionSouth West England       -0.04123    0.08150  -0.506 0.612901    
regionWales                    -0.28669    0.09948  -2.882 0.003956 ** 
regionWest Midlands            -0.08016    0.08208  -0.977 0.328777    
regionYorkshire and the Humber -0.08786    0.08081  -1.087 0.276938    
gendermale:age25_TO_34         -0.09208    0.14484  -0.636 0.524959    
gendermale:age35_TO_44         -0.13438    0.13918  -0.966 0.334282    
gendermale:age45_TO_54         -0.19670    0.13625  -1.444 0.148836    
gendermale:age55_TO_64         -0.13553    0.13468  -1.006 0.314302    
gendermale:age65_TO_74         -0.23070    0.14034  -1.644 0.100213    
gendermale:age75_PLUS          -0.19997    0.18429  -1.085 0.277895    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

(Dispersion parameter for binomial family taken to be 1.006061)

Number of Fisher Scoring iterations: 6</code></pre>
</div>
<div class="sourceCode cell-code" id="cb87"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb87-1"><a href="#cb87-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Green vote model</span></span>
<span id="cb87-2"><a href="#cb87-2" aria-hidden="true" tabindex="-1"></a>model_vote_grn <span class="ot">&lt;-</span> <span class="fu">svyglm</span>(</span>
<span id="cb87-3"><a href="#cb87-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">I</span>(pv_2024 <span class="sc">==</span> <span class="st">"grn"</span>) <span class="sc">~</span> gender <span class="sc">*</span> age <span class="sc">+</span> education <span class="sc">+</span> ethnicity <span class="sc">+</span> region,</span>
<span id="cb87-4"><a href="#cb87-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">design =</span> survey_design_full,</span>
<span id="cb87-5"><a href="#cb87-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">family =</span> <span class="fu">binomial</span>(<span class="at">link =</span> <span class="st">"logit"</span>)</span>
<span id="cb87-6"><a href="#cb87-6" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb87-7"><a href="#cb87-7" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(model_vote_grn)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
svyglm(formula = I(pv_2024 == "grn") ~ gender * age + education + 
    ethnicity + region, design = survey_design_full, family = binomial(link = "logit"))

Survey design:
svydesign(ids = ~1, weights = ~wt, data = uk_data)

Coefficients:
                               Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)                    -1.65837    0.12759 -12.998  &lt; 2e-16 ***
gendermale                     -0.40438    0.11897  -3.399 0.000677 ***
age25_TO_34                    -0.65779    0.09330  -7.051 1.82e-12 ***
age35_TO_44                    -0.70169    0.09538  -7.357 1.93e-13 ***
age45_TO_54                    -0.87229    0.09957  -8.761  &lt; 2e-16 ***
age55_TO_64                    -1.04100    0.11045  -9.425  &lt; 2e-16 ***
age65_TO_74                    -1.37013    0.13418 -10.211  &lt; 2e-16 ***
age75_PLUS                     -1.19106    0.19880  -5.991 2.11e-09 ***
educationlow                   -0.18953    0.05326  -3.559 0.000373 ***
ethnicityblack                 -0.77736    0.14831  -5.241 1.60e-07 ***
ethnicitymixed                 -0.14590    0.16243  -0.898 0.369055    
ethnicityother                 -0.11134    0.25587  -0.435 0.663441    
ethnicitywhite                 -0.17893    0.08270  -2.164 0.030501 *  
regionEast of England           0.26966    0.11813   2.283 0.022448 *  
regionGreater London           -0.01430    0.11314  -0.126 0.899396    
regionNorth East England       -0.38453    0.16358  -2.351 0.018743 *  
regionNorth West England       -0.04096    0.11765  -0.348 0.727741    
regionScotland                 -0.39616    0.14289  -2.772 0.005568 ** 
regionSouth East England        0.11607    0.11209   1.036 0.300413    
regionSouth West England        0.20818    0.11848   1.757 0.078912 .  
regionWales                    -0.29540    0.16242  -1.819 0.068957 .  
regionWest Midlands             0.10512    0.11871   0.886 0.375870    
regionYorkshire and the Humber  0.08522    0.12333   0.691 0.489587    
gendermale:age25_TO_34         -0.00250    0.16651  -0.015 0.988021    
gendermale:age35_TO_44          0.04233    0.16617   0.255 0.798946    
gendermale:age45_TO_54          0.23361    0.16850   1.386 0.165641    
gendermale:age55_TO_64          0.34577    0.17741   1.949 0.051301 .  
gendermale:age65_TO_74          0.20322    0.21626   0.940 0.347379    
gendermale:age75_PLUS          -1.02252    0.42121  -2.428 0.015205 *  
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

(Dispersion parameter for binomial family taken to be 0.9978306)

Number of Fisher Scoring iterations: 6</code></pre>
</div>
<div class="sourceCode cell-code" id="cb89"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb89-1"><a href="#cb89-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Liberal Democrat vote model</span></span>
<span id="cb89-2"><a href="#cb89-2" aria-hidden="true" tabindex="-1"></a>model_vote_ldm <span class="ot">&lt;-</span> <span class="fu">svyglm</span>(</span>
<span id="cb89-3"><a href="#cb89-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">I</span>(pv_2024 <span class="sc">==</span> <span class="st">"ldm"</span>) <span class="sc">~</span> gender <span class="sc">*</span> age <span class="sc">+</span> education <span class="sc">+</span> ethnicity <span class="sc">+</span> region,</span>
<span id="cb89-4"><a href="#cb89-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">design =</span> survey_design_full,</span>
<span id="cb89-5"><a href="#cb89-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">family =</span> <span class="fu">binomial</span>(<span class="at">link =</span> <span class="st">"logit"</span>)</span>
<span id="cb89-6"><a href="#cb89-6" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb89-7"><a href="#cb89-7" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(model_vote_ldm)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
svyglm(formula = I(pv_2024 == "ldm") ~ gender * age + education + 
    ethnicity + region, design = survey_design_full, family = binomial(link = "logit"))

Survey design:
svydesign(ids = ~1, weights = ~wt, data = uk_data)

Coefficients:
                               Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)                    -3.20046    0.15796 -20.261  &lt; 2e-16 ***
gendermale                      0.18697    0.15998   1.169  0.24253    
age25_TO_34                     0.37157    0.11817   3.144  0.00167 ** 
age35_TO_44                     0.52831    0.11632   4.542 5.59e-06 ***
age45_TO_54                     0.61310    0.11649   5.263 1.43e-07 ***
age55_TO_64                     0.63695    0.11936   5.336 9.55e-08 ***
age65_TO_74                     0.72343    0.12562   5.759 8.54e-09 ***
age75_PLUS                      0.82336    0.15933   5.168 2.38e-07 ***
educationlow                   -0.44821    0.04625  -9.691  &lt; 2e-16 ***
ethnicityblack                 -0.66901    0.15153  -4.415 1.01e-05 ***
ethnicitymixed                  0.11206    0.16618   0.674  0.50009    
ethnicityother                  0.15274    0.25653   0.595  0.55157    
ethnicitywhite                  0.15958    0.08824   1.808  0.07056 .  
regionEast of England           0.36587    0.12027   3.042  0.00235 ** 
regionGreater London            0.51363    0.11349   4.526 6.04e-06 ***
regionNorth East England       -0.49687    0.17747  -2.800  0.00512 ** 
regionNorth West England       -0.03657    0.12227  -0.299  0.76485    
regionScotland                 -0.09353    0.13916  -0.672  0.50152    
regionSouth East England        0.88354    0.10635   8.308  &lt; 2e-16 ***
regionSouth West England        1.10380    0.11006  10.029  &lt; 2e-16 ***
regionWales                     0.05077    0.15476   0.328  0.74285    
regionWest Midlands             0.23199    0.12497   1.856  0.06341 .  
regionYorkshire and the Humber  0.14048    0.12730   1.104  0.26980    
gendermale:age25_TO_34         -0.30036    0.19011  -1.580  0.11413    
gendermale:age35_TO_44         -0.31039    0.18652  -1.664  0.09610 .  
gendermale:age45_TO_54         -0.31053    0.18678  -1.663  0.09642 .  
gendermale:age55_TO_64         -0.21254    0.18849  -1.128  0.25948    
gendermale:age65_TO_74         -0.25408    0.19477  -1.305  0.19206    
gendermale:age75_PLUS           0.22343    0.22867   0.977  0.32852    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

(Dispersion parameter for binomial family taken to be 1.002978)

Number of Fisher Scoring iterations: 6</code></pre>
</div>
</div>
</section>
</section>
<section id="segmented-modelling---young-vs-older-age-bands" class="level4">
<h4 class="anchored" data-anchor-id="segmented-modelling---young-vs-older-age-bands">5) Segmented Modelling - Young vs Older Age Bands</h4>
<p><strong>Are young people truly different, or just experiencing new intersection age + gender effects? How do our other predictors work differently for this cohort of respondents?</strong></p>
<p>NOTE: I don’t know the methodology for creating the weights, so when we run our stratified models on specific age groups, our weights are no longer appropriate since we’re no longer estimating on the full nationall representative sample, just our specific age groups.</p>
<p>We will proceed with unweighted models with just lm(), and just acknowledge this limitation. Not useful to do the whole stratification again, just for this.</p>
<section id="young-people-models-18-34" class="level5">
<h5 class="anchored" data-anchor-id="young-people-models-18-34">Young People Models (18-34)</h5>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb91"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb91-1"><a href="#cb91-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Create young people subset</span></span>
<span id="cb91-2"><a href="#cb91-2" aria-hidden="true" tabindex="-1"></a>modeling_data_young <span class="ot">&lt;-</span> uk_data <span class="sc">%&gt;%</span></span>
<span id="cb91-3"><a href="#cb91-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(age <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"18_TO_24"</span>, <span class="st">"25_TO_34"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb91-4"><a href="#cb91-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(social_conservatism) <span class="sc">&amp;</span> <span class="sc">!</span><span class="fu">is.na</span>(economic_leftism) <span class="sc">&amp;</span></span>
<span id="cb91-5"><a href="#cb91-5" aria-hidden="true" tabindex="-1"></a>         <span class="sc">!</span><span class="fu">is.na</span>(gender) <span class="sc">&amp;</span> <span class="sc">!</span><span class="fu">is.na</span>(education) <span class="sc">&amp;</span> <span class="sc">!</span><span class="fu">is.na</span>(ethnicity) <span class="sc">&amp;</span> <span class="sc">!</span><span class="fu">is.na</span>(region))</span>
<span id="cb91-6"><a href="#cb91-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb91-7"><a href="#cb91-7" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">paste</span>(<span class="st">"Young people sample size:"</span>, <span class="fu">nrow</span>(modeling_data_young)))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Young people sample size: 9929"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb93"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb93-1"><a href="#cb93-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Social conservatism model - young people only (unweighted)</span></span>
<span id="cb93-2"><a href="#cb93-2" aria-hidden="true" tabindex="-1"></a>model_social_young <span class="ot">&lt;-</span> <span class="fu">lm</span>(</span>
<span id="cb93-3"><a href="#cb93-3" aria-hidden="true" tabindex="-1"></a>  social_conservatism <span class="sc">~</span> gender <span class="sc">+</span> education <span class="sc">+</span> ethnicity <span class="sc">+</span> region <span class="sc">+</span> </span>
<span id="cb93-4"><a href="#cb93-4" aria-hidden="true" tabindex="-1"></a>                       household <span class="sc">+</span> socgrad <span class="sc">+</span> marital <span class="sc">+</span> religion,</span>
<span id="cb93-5"><a href="#cb93-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> modeling_data_young</span>
<span id="cb93-6"><a href="#cb93-6" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb93-7"><a href="#cb93-7" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(model_social_young)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = social_conservatism ~ gender + education + ethnicity + 
    region + household + socgrad + marital + religion, data = modeling_data_young)

Residuals:
     Min       1Q   Median       3Q      Max 
-1.48480 -0.24674  0.02515  0.27163  0.98677 

Coefficients:
                                        Estimate Std. Error t value Pr(&gt;|t|)
(Intercept)                            4.771e-01  2.488e-02  19.179  &lt; 2e-16
gendermale                             3.612e-02  8.227e-03   4.390 1.15e-05
educationlow                           3.414e-02  8.711e-03   3.919 8.94e-05
ethnicityblack                         1.133e-02  1.966e-02   0.576 0.564464
ethnicitymixed                        -9.024e-02  2.479e-02  -3.640 0.000274
ethnicityother                        -9.578e-02  3.827e-02  -2.503 0.012331
ethnicitywhite                        -3.748e-02  1.604e-02  -2.337 0.019458
regionEast of England                 -3.903e-02  2.014e-02  -1.938 0.052694
regionGreater London                  -4.595e-02  1.766e-02  -2.603 0.009267
regionNorth East England              -1.825e-02  2.409e-02  -0.757 0.448805
regionNorth West England              -6.232e-02  1.867e-02  -3.339 0.000845
regionScotland                        -6.230e-02  2.203e-02  -2.828 0.004697
regionSouth East England              -5.494e-02  1.874e-02  -2.932 0.003377
regionSouth West England              -7.432e-02  2.034e-02  -3.653 0.000260
regionWales                            4.883e-04  2.492e-02   0.020 0.984367
regionWest Midlands                   -2.069e-02  1.953e-02  -1.059 0.289557
regionYorkshire and the Humber        -7.807e-05  1.999e-02  -0.004 0.996884
householdowns_with_mortgage_or_shared -5.998e-02  1.230e-02  -4.875 1.11e-06
householdprivate_rented_or_rent_free  -7.281e-02  1.210e-02  -6.019 1.81e-09
householdsocial_rented                 1.541e-02  1.448e-02   1.065 0.287107
socgradC1                             -2.613e-02  1.067e-02  -2.449 0.014347
socgradC2                              4.633e-02  1.229e-02   3.771 0.000164
socgradDE                              1.421e-02  1.191e-02   1.194 0.232660
maritalrelationship_living            -8.411e-02  1.263e-02  -6.658 2.92e-11
maritalrelationship_notliving         -1.352e-01  1.399e-02  -9.667  &lt; 2e-16
maritalseparated_divorced             -9.447e-02  4.094e-02  -2.307 0.021056
maritalsingle                         -1.363e-01  1.036e-02 -13.149  &lt; 2e-16
maritalwidowed                        -4.238e-01  1.231e-01  -3.442 0.000581
religionhindu                          1.611e-02  2.801e-02   0.575 0.565077
religionmuslim                         6.202e-03  1.712e-02   0.362 0.717110
religionnone                          -1.417e-01  9.834e-03 -14.410  &lt; 2e-16
religionother                         -1.097e-01  2.237e-02  -4.905 9.47e-07
                                         
(Intercept)                           ***
gendermale                            ***
educationlow                          ***
ethnicityblack                           
ethnicitymixed                        ***
ethnicityother                        *  
ethnicitywhite                        *  
regionEast of England                 .  
regionGreater London                  ** 
regionNorth East England                 
regionNorth West England              ***
regionScotland                        ** 
regionSouth East England              ** 
regionSouth West England              ***
regionWales                              
regionWest Midlands                      
regionYorkshire and the Humber           
householdowns_with_mortgage_or_shared ***
householdprivate_rented_or_rent_free  ***
householdsocial_rented                   
socgradC1                             *  
socgradC2                             ***
socgradDE                                
maritalrelationship_living            ***
maritalrelationship_notliving         ***
maritalseparated_divorced             *  
maritalsingle                         ***
maritalwidowed                        ***
religionhindu                            
religionmuslim                           
religionnone                          ***
religionother                         ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 0.3874 on 9656 degrees of freedom
  (241 observations deleted due to missingness)
Multiple R-squared:  0.08945,   Adjusted R-squared:  0.08653 
F-statistic:  30.6 on 31 and 9656 DF,  p-value: &lt; 2.2e-16</code></pre>
</div>
<div class="sourceCode cell-code" id="cb95"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb95-1"><a href="#cb95-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Economic leftism model - young people only (unweighted)</span></span>
<span id="cb95-2"><a href="#cb95-2" aria-hidden="true" tabindex="-1"></a>model_economic_young <span class="ot">&lt;-</span> <span class="fu">lm</span>(</span>
<span id="cb95-3"><a href="#cb95-3" aria-hidden="true" tabindex="-1"></a>  economic_leftism <span class="sc">~</span> gender <span class="sc">+</span> education <span class="sc">+</span> ethnicity <span class="sc">+</span> region <span class="sc">+</span> </span>
<span id="cb95-4"><a href="#cb95-4" aria-hidden="true" tabindex="-1"></a>                    household <span class="sc">+</span> socgrad <span class="sc">+</span> marital <span class="sc">+</span> religion,</span>
<span id="cb95-5"><a href="#cb95-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> modeling_data_young</span>
<span id="cb95-6"><a href="#cb95-6" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb95-7"><a href="#cb95-7" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(model_economic_young)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = economic_leftism ~ gender + education + ethnicity + 
    region + household + socgrad + marital + religion, data = modeling_data_young)

Residuals:
     Min       1Q   Median       3Q      Max 
-1.55027 -0.22134  0.02827  0.26419  0.74072 

Coefficients:
                                        Estimate Std. Error t value Pr(&gt;|t|)
(Intercept)                            2.924e-01  2.298e-02  12.725  &lt; 2e-16
gendermale                            -3.076e-02  7.599e-03  -4.048 5.21e-05
educationlow                          -4.125e-03  8.046e-03  -0.513 0.608188
ethnicityblack                        -2.358e-03  1.816e-02  -0.130 0.896669
ethnicitymixed                         4.639e-02  2.290e-02   2.026 0.042824
ethnicityother                        -1.577e-02  3.535e-02  -0.446 0.655516
ethnicitywhite                         5.411e-02  1.481e-02   3.652 0.000261
regionEast of England                  2.930e-02  1.861e-02   1.575 0.115301
regionGreater London                   1.802e-05  1.631e-02   0.001 0.999118
regionNorth East England               2.957e-02  2.225e-02   1.329 0.184015
regionNorth West England               4.289e-02  1.724e-02   2.488 0.012881
regionScotland                         4.612e-02  2.035e-02   2.266 0.023463
regionSouth East England              -2.223e-02  1.731e-02  -1.284 0.199052
regionSouth West England              -5.571e-03  1.879e-02  -0.296 0.766880
regionWales                            1.370e-02  2.302e-02   0.595 0.551665
regionWest Midlands                    2.022e-03  1.804e-02   0.112 0.910786
regionYorkshire and the Humber         2.072e-02  1.846e-02   1.122 0.261930
householdowns_with_mortgage_or_shared  2.687e-02  1.137e-02   2.364 0.018087
householdprivate_rented_or_rent_free   5.220e-02  1.117e-02   4.672 3.02e-06
householdsocial_rented                 5.738e-02  1.337e-02   4.291 1.80e-05
socgradC1                              3.545e-02  9.855e-03   3.597 0.000323
socgradC2                              2.404e-02  1.135e-02   2.118 0.034196
socgradDE                              1.737e-02  1.100e-02   1.579 0.114308
maritalrelationship_living             3.800e-02  1.167e-02   3.257 0.001129
maritalrelationship_notliving          3.778e-02  1.292e-02   2.924 0.003467
maritalseparated_divorced             -8.505e-02  3.782e-02  -2.249 0.024555
maritalsingle                          4.127e-02  9.572e-03   4.311 1.64e-05
maritalwidowed                        -5.104e-02  1.137e-01  -0.449 0.653659
religionhindu                         -3.592e-03  2.587e-02  -0.139 0.889568
religionmuslim                         3.598e-02  1.581e-02   2.276 0.022880
religionnone                           5.418e-02  9.083e-03   5.965 2.54e-09
religionother                          7.698e-02  2.066e-02   3.726 0.000196
                                         
(Intercept)                           ***
gendermale                            ***
educationlow                             
ethnicityblack                           
ethnicitymixed                        *  
ethnicityother                           
ethnicitywhite                        ***
regionEast of England                    
regionGreater London                     
regionNorth East England                 
regionNorth West England              *  
regionScotland                        *  
regionSouth East England                 
regionSouth West England                 
regionWales                              
regionWest Midlands                      
regionYorkshire and the Humber           
householdowns_with_mortgage_or_shared *  
householdprivate_rented_or_rent_free  ***
householdsocial_rented                ***
socgradC1                             ***
socgradC2                             *  
socgradDE                                
maritalrelationship_living            ** 
maritalrelationship_notliving         ** 
maritalseparated_divorced             *  
maritalsingle                         ***
maritalwidowed                           
religionhindu                            
religionmuslim                        *  
religionnone                          ***
religionother                         ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 0.3578 on 9656 degrees of freedom
  (241 observations deleted due to missingness)
Multiple R-squared:  0.03396,   Adjusted R-squared:  0.03086 
F-statistic: 10.95 on 31 and 9656 DF,  p-value: &lt; 2.2e-16</code></pre>
</div>
</div>
</section>
<section id="older-people-models-35" class="level5">
<h5 class="anchored" data-anchor-id="older-people-models-35">Older People Models (35+)</h5>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb97"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb97-1"><a href="#cb97-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Create older people subset</span></span>
<span id="cb97-2"><a href="#cb97-2" aria-hidden="true" tabindex="-1"></a>modeling_data_older <span class="ot">&lt;-</span> uk_data <span class="sc">%&gt;%</span></span>
<span id="cb97-3"><a href="#cb97-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(age <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"35_TO_44"</span>, <span class="st">"45_TO_54"</span>, <span class="st">"55_TO_64"</span>, <span class="st">"65_TO_74"</span>,<span class="st">"75_PLUS"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb97-4"><a href="#cb97-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(social_conservatism) <span class="sc">&amp;</span> <span class="sc">!</span><span class="fu">is.na</span>(economic_leftism) <span class="sc">&amp;</span></span>
<span id="cb97-5"><a href="#cb97-5" aria-hidden="true" tabindex="-1"></a>         <span class="sc">!</span><span class="fu">is.na</span>(gender) <span class="sc">&amp;</span> <span class="sc">!</span><span class="fu">is.na</span>(education) <span class="sc">&amp;</span> <span class="sc">!</span><span class="fu">is.na</span>(ethnicity) <span class="sc">&amp;</span> <span class="sc">!</span><span class="fu">is.na</span>(region))</span>
<span id="cb97-6"><a href="#cb97-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb97-7"><a href="#cb97-7" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">paste</span>(<span class="st">"Older people sample size:"</span>, <span class="fu">nrow</span>(modeling_data_older)))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Older people sample size: 22519"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb99"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb99-1"><a href="#cb99-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Social conservatism model - older people only (unweighted)</span></span>
<span id="cb99-2"><a href="#cb99-2" aria-hidden="true" tabindex="-1"></a>model_social_older <span class="ot">&lt;-</span> <span class="fu">lm</span>(</span>
<span id="cb99-3"><a href="#cb99-3" aria-hidden="true" tabindex="-1"></a>  social_conservatism <span class="sc">~</span> gender <span class="sc">+</span> education <span class="sc">+</span> ethnicity <span class="sc">+</span> region <span class="sc">+</span> </span>
<span id="cb99-4"><a href="#cb99-4" aria-hidden="true" tabindex="-1"></a>                       household <span class="sc">+</span> socgrad <span class="sc">+</span> marital <span class="sc">+</span> religion,</span>
<span id="cb99-5"><a href="#cb99-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> modeling_data_older</span>
<span id="cb99-6"><a href="#cb99-6" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb99-7"><a href="#cb99-7" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(model_social_older)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = social_conservatism ~ gender + education + ethnicity + 
    region + household + socgrad + marital + religion, data = modeling_data_older)

Residuals:
     Min       1Q   Median       3Q      Max 
-1.58980 -0.24463  0.03223  0.28359  0.98720 

Coefficients:
                                       Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)                            0.410421   0.019197  21.380  &lt; 2e-16 ***
gendermale                            -0.007847   0.005272  -1.488 0.136686    
educationlow                           0.173912   0.006020  28.887  &lt; 2e-16 ***
ethnicityblack                         0.017259   0.021932   0.787 0.431342    
ethnicitymixed                        -0.153991   0.027005  -5.702 1.20e-08 ***
ethnicityother                        -0.089354   0.040124  -2.227 0.025960 *  
ethnicitywhite                        -0.088139   0.016052  -5.491 4.05e-08 ***
regionEast of England                  0.014802   0.012226   1.211 0.226013    
regionGreater London                  -0.030547   0.012289  -2.486 0.012938 *  
regionNorth East England               0.022591   0.015131   1.493 0.135436    
regionNorth West England              -0.002459   0.011907  -0.206 0.836402    
regionScotland                        -0.067368   0.013050  -5.162 2.46e-07 ***
regionSouth East England              -0.024697   0.011551  -2.138 0.032525 *  
regionSouth West England              -0.027386   0.012633  -2.168 0.030182 *  
regionWales                           -0.011378   0.014553  -0.782 0.434313    
regionWest Midlands                    0.006332   0.012713   0.498 0.618432    
regionYorkshire and the Humber         0.003789   0.012720   0.298 0.765792    
householdowns_with_mortgage_or_shared -0.021969   0.006548  -3.355 0.000795 ***
householdprivate_rented_or_rent_free  -0.025885   0.007874  -3.287 0.001013 ** 
householdsocial_rented                 0.018691   0.008346   2.239 0.025139 *  
socgradC1                              0.023971   0.007007   3.421 0.000625 ***
socgradC2                              0.087787   0.008596  10.212  &lt; 2e-16 ***
socgradDE                              0.077371   0.007927   9.760  &lt; 2e-16 ***
maritalrelationship_living            -0.024946   0.008531  -2.924 0.003458 ** 
maritalrelationship_notliving         -0.066804   0.015090  -4.427 9.60e-06 ***
maritalseparated_divorced             -0.048128   0.008939  -5.384 7.37e-08 ***
maritalsingle                         -0.087661   0.007471 -11.733  &lt; 2e-16 ***
maritalwidowed                        -0.010018   0.013595  -0.737 0.461217    
religionhindu                          0.071621   0.029626   2.418 0.015635 *  
religionmuslim                         0.018298   0.019467   0.940 0.347265    
religionnone                          -0.165292   0.005539 -29.844  &lt; 2e-16 ***
religionother                         -0.122353   0.015924  -7.683 1.61e-14 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 0.3854 on 22129 degrees of freedom
  (358 observations deleted due to missingness)
Multiple R-squared:  0.1213,    Adjusted R-squared:  0.1201 
F-statistic: 98.58 on 31 and 22129 DF,  p-value: &lt; 2.2e-16</code></pre>
</div>
<div class="sourceCode cell-code" id="cb101"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb101-1"><a href="#cb101-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Economic leftism model - older people only (unweighted)</span></span>
<span id="cb101-2"><a href="#cb101-2" aria-hidden="true" tabindex="-1"></a>model_economic_older <span class="ot">&lt;-</span> <span class="fu">lm</span>(</span>
<span id="cb101-3"><a href="#cb101-3" aria-hidden="true" tabindex="-1"></a>  economic_leftism <span class="sc">~</span> gender <span class="sc">+</span> education <span class="sc">+</span> ethnicity <span class="sc">+</span> region <span class="sc">+</span> </span>
<span id="cb101-4"><a href="#cb101-4" aria-hidden="true" tabindex="-1"></a>                    household <span class="sc">+</span> socgrad <span class="sc">+</span> marital <span class="sc">+</span> religion,</span>
<span id="cb101-5"><a href="#cb101-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> modeling_data_older</span>
<span id="cb101-6"><a href="#cb101-6" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb101-7"><a href="#cb101-7" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(model_economic_older)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = economic_leftism ~ gender + education + ethnicity + 
    region + household + socgrad + marital + religion, data = modeling_data_older)

Residuals:
     Min       1Q   Median       3Q      Max 
-1.62885 -0.25097  0.04122  0.30099  0.88257 

Coefficients:
                                        Estimate Std. Error t value Pr(&gt;|t|)
(Intercept)                            1.947e-01  2.015e-02   9.665  &lt; 2e-16
gendermale                             3.478e-02  5.534e-03   6.284 3.35e-10
educationlow                          -1.003e-02  6.319e-03  -1.587  0.11244
ethnicityblack                         1.376e-03  2.302e-02   0.060  0.95235
ethnicitymixed                         7.669e-02  2.834e-02   2.706  0.00682
ethnicityother                        -2.596e-03  4.211e-02  -0.062  0.95085
ethnicitywhite                         8.432e-03  1.685e-02   0.500  0.61673
regionEast of England                 -3.241e-02  1.283e-02  -2.526  0.01156
regionGreater London                   1.326e-03  1.290e-02   0.103  0.91812
regionNorth East England               1.175e-02  1.588e-02   0.740  0.45953
regionNorth West England               5.329e-02  1.250e-02   4.264 2.01e-05
regionScotland                         3.451e-02  1.370e-02   2.519  0.01177
regionSouth East England              -3.942e-02  1.212e-02  -3.251  0.00115
regionSouth West England              -1.181e-02  1.326e-02  -0.890  0.37326
regionWales                            3.701e-02  1.527e-02   2.423  0.01540
regionWest Midlands                   -8.994e-05  1.334e-02  -0.007  0.99462
regionYorkshire and the Humber         2.344e-02  1.335e-02   1.756  0.07912
householdowns_with_mortgage_or_shared  8.853e-02  6.873e-03  12.881  &lt; 2e-16
householdprivate_rented_or_rent_free   1.153e-01  8.264e-03  13.948  &lt; 2e-16
householdsocial_rented                 1.628e-01  8.760e-03  18.579  &lt; 2e-16
socgradC1                              7.122e-02  7.354e-03   9.685  &lt; 2e-16
socgradC2                              1.101e-01  9.022e-03  12.204  &lt; 2e-16
socgradDE                              1.284e-01  8.320e-03  15.433  &lt; 2e-16
maritalrelationship_living             2.587e-02  8.954e-03   2.889  0.00386
maritalrelationship_notliving          7.308e-02  1.584e-02   4.614 3.97e-06
maritalseparated_divorced             -6.660e-03  9.383e-03  -0.710  0.47784
maritalsingle                          3.275e-02  7.842e-03   4.176 2.97e-05
maritalwidowed                        -4.632e-02  1.427e-02  -3.246  0.00117
religionhindu                          9.520e-02  3.109e-02   3.062  0.00220
religionmuslim                         1.011e-01  2.043e-02   4.947 7.59e-07
religionnone                           7.121e-02  5.813e-03  12.250  &lt; 2e-16
religionother                          8.772e-02  1.671e-02   5.249 1.55e-07
                                         
(Intercept)                           ***
gendermale                            ***
educationlow                             
ethnicityblack                           
ethnicitymixed                        ** 
ethnicityother                           
ethnicitywhite                           
regionEast of England                 *  
regionGreater London                     
regionNorth East England                 
regionNorth West England              ***
regionScotland                        *  
regionSouth East England              ** 
regionSouth West England                 
regionWales                           *  
regionWest Midlands                      
regionYorkshire and the Humber        .  
householdowns_with_mortgage_or_shared ***
householdprivate_rented_or_rent_free  ***
householdsocial_rented                ***
socgradC1                             ***
socgradC2                             ***
socgradDE                             ***
maritalrelationship_living            ** 
maritalrelationship_notliving         ***
maritalseparated_divorced                
maritalsingle                         ***
maritalwidowed                        ** 
religionhindu                         ** 
religionmuslim                        ***
religionnone                          ***
religionother                         ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 0.4045 on 22129 degrees of freedom
  (358 observations deleted due to missingness)
Multiple R-squared:  0.06738,   Adjusted R-squared:  0.06608 
F-statistic: 51.58 on 31 and 22129 DF,  p-value: &lt; 2.2e-16</code></pre>
</div>
</div>
</section>
<section id="compare-young-vs-older-coefficients" class="level5">
<h5 class="anchored" data-anchor-id="compare-young-vs-older-coefficients">Compare Young vs Older Coefficients</h5>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb103"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb103-1"><a href="#cb103-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Extract gender coefficients for comparison</span></span>
<span id="cb103-2"><a href="#cb103-2" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="st">"=== GENDER EFFECTS COMPARISON: YOUNG VS OLDER ==="</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "=== GENDER EFFECTS COMPARISON: YOUNG VS OLDER ==="</code></pre>
</div>
<div class="sourceCode cell-code" id="cb105"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb105-1"><a href="#cb105-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Social conservatism gender effects</span></span>
<span id="cb105-2"><a href="#cb105-2" aria-hidden="true" tabindex="-1"></a>social_young_gender <span class="ot">&lt;-</span> <span class="fu">summary</span>(model_social_young)<span class="sc">$</span>coefficients[<span class="st">"gendermale"</span>, <span class="fu">c</span>(<span class="st">"Estimate"</span>, <span class="st">"Pr(&gt;|t|)"</span>)]</span>
<span id="cb105-3"><a href="#cb105-3" aria-hidden="true" tabindex="-1"></a>social_older_gender <span class="ot">&lt;-</span> <span class="fu">summary</span>(model_social_older)<span class="sc">$</span>coefficients[<span class="st">"gendermale"</span>, <span class="fu">c</span>(<span class="st">"Estimate"</span>, <span class="st">"Pr(&gt;|t|)"</span>)]</span>
<span id="cb105-4"><a href="#cb105-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb105-5"><a href="#cb105-5" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Social Conservatism - Male Effect:</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Social Conservatism - Male Effect:</code></pre>
</div>
<div class="sourceCode cell-code" id="cb107"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb107-1"><a href="#cb107-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Young (18-34):"</span>, <span class="fu">round</span>(social_young_gender[<span class="dv">1</span>], <span class="dv">3</span>), <span class="st">"p ="</span>, <span class="fu">round</span>(social_young_gender[<span class="dv">2</span>], <span class="dv">3</span>), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Young (18-34): 0.036 p = 0 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb109"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb109-1"><a href="#cb109-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Older (35+):"</span>, <span class="fu">round</span>(social_older_gender[<span class="dv">1</span>], <span class="dv">3</span>), <span class="st">"p ="</span>, <span class="fu">round</span>(social_older_gender[<span class="dv">2</span>], <span class="dv">3</span>), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Older (35+): -0.008 p = 0.137 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb111"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb111-1"><a href="#cb111-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Economic leftism gender effects  </span></span>
<span id="cb111-2"><a href="#cb111-2" aria-hidden="true" tabindex="-1"></a>economic_young_gender <span class="ot">&lt;-</span> <span class="fu">summary</span>(model_economic_young)<span class="sc">$</span>coefficients[<span class="st">"gendermale"</span>, <span class="fu">c</span>(<span class="st">"Estimate"</span>, <span class="st">"Pr(&gt;|t|)"</span>)]</span>
<span id="cb111-3"><a href="#cb111-3" aria-hidden="true" tabindex="-1"></a>economic_older_gender <span class="ot">&lt;-</span> <span class="fu">summary</span>(model_economic_older)<span class="sc">$</span>coefficients[<span class="st">"gendermale"</span>, <span class="fu">c</span>(<span class="st">"Estimate"</span>, <span class="st">"Pr(&gt;|t|)"</span>)]</span>
<span id="cb111-4"><a href="#cb111-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb111-5"><a href="#cb111-5" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">Economic Leftism - Male Effect:</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Economic Leftism - Male Effect:</code></pre>
</div>
<div class="sourceCode cell-code" id="cb113"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb113-1"><a href="#cb113-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Young (18-34):"</span>, <span class="fu">round</span>(economic_young_gender[<span class="dv">1</span>], <span class="dv">3</span>), <span class="st">"p ="</span>, <span class="fu">round</span>(economic_young_gender[<span class="dv">2</span>], <span class="dv">3</span>), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Young (18-34): -0.031 p = 0 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb115"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb115-1"><a href="#cb115-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Older (35+):"</span>, <span class="fu">round</span>(economic_older_gender[<span class="dv">1</span>], <span class="dv">3</span>), <span class="st">"p ="</span>, <span class="fu">round</span>(economic_older_gender[<span class="dv">2</span>], <span class="dv">3</span>), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Older (35+): 0.035 p = 0 </code></pre>
</div>
</div>
</section>
</section>
<section id="presentation-generation-visuals-etc." class="level4">
<h4 class="anchored" data-anchor-id="presentation-generation-visuals-etc.">6) Presentation generation, visuals etc.</h4>
<p>Come back to this at a later stage. Enough results for now to move onto the function generation.</p>
</section>
<section id="extended-segment-analysis---intersectionality" class="level4">
<h4 class="anchored" data-anchor-id="extended-segment-analysis---intersectionality">7) Extended Segment Analysis - Intersectionality</h4>
<p><strong>What specifically is driving the change to the right-wing amongst younger men? Is the ongoing shift about women moving more left, or is it also about men moving more right</strong></p>
<p><strong>Can we find evidence for the claims posited in the article read by the CEO on this issue?</strong></p>
<section id="vote-switching-analysis-left-to-right-shifters-2019-2024" class="level5">
<h5 class="anchored" data-anchor-id="vote-switching-analysis-left-to-right-shifters-2019-2024">Vote Switching Analysis: Left-to-Right Shifters 2019-2024</h5>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb117"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb117-1"><a href="#cb117-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Identify vote switchers from left-wing to right-wing parties</span></span>
<span id="cb117-2"><a href="#cb117-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Define party classifications</span></span>
<span id="cb117-3"><a href="#cb117-3" aria-hidden="true" tabindex="-1"></a>left_parties <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"lab"</span>, <span class="st">"grn"</span>, <span class="st">"ldm"</span>)  <span class="co"># Labour, Green, Lib Dem</span></span>
<span id="cb117-4"><a href="#cb117-4" aria-hidden="true" tabindex="-1"></a>right_parties <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"con"</span>, <span class="st">"rfm"</span>)        <span class="co"># Conservative, Reform</span></span>
<span id="cb117-5"><a href="#cb117-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb117-6"><a href="#cb117-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Create switching analysis dataset</span></span>
<span id="cb117-7"><a href="#cb117-7" aria-hidden="true" tabindex="-1"></a>vote_switchers <span class="ot">&lt;-</span> uk_data <span class="sc">%&gt;%</span></span>
<span id="cb117-8"><a href="#cb117-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(pv_2019) <span class="sc">&amp;</span> <span class="sc">!</span><span class="fu">is.na</span>(pv_2024)) <span class="sc">%&gt;%</span></span>
<span id="cb117-9"><a href="#cb117-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb117-10"><a href="#cb117-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">voted_left_2019 =</span> pv_2019 <span class="sc">%in%</span> left_parties,</span>
<span id="cb117-11"><a href="#cb117-11" aria-hidden="true" tabindex="-1"></a>    <span class="at">voted_right_2024 =</span> pv_2024 <span class="sc">%in%</span> right_parties,</span>
<span id="cb117-12"><a href="#cb117-12" aria-hidden="true" tabindex="-1"></a>    <span class="at">left_to_right_switch =</span> voted_left_2019 <span class="sc">&amp;</span> voted_right_2024</span>
<span id="cb117-13"><a href="#cb117-13" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb117-14"><a href="#cb117-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb117-15"><a href="#cb117-15" aria-hidden="true" tabindex="-1"></a><span class="co"># Summary of switching patterns</span></span>
<span id="cb117-16"><a href="#cb117-16" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"=== VOTE SWITCHING SUMMARY ===</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>=== VOTE SWITCHING SUMMARY ===</code></pre>
</div>
<div class="sourceCode cell-code" id="cb119"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb119-1"><a href="#cb119-1" aria-hidden="true" tabindex="-1"></a>switching_summary <span class="ot">&lt;-</span> vote_switchers <span class="sc">%&gt;%</span></span>
<span id="cb119-2"><a href="#cb119-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(voted_left_2019, voted_right_2024) <span class="sc">%&gt;%</span></span>
<span id="cb119-3"><a href="#cb119-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(</span>
<span id="cb119-4"><a href="#cb119-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">count =</span> <span class="fu">n</span>(),</span>
<span id="cb119-5"><a href="#cb119-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">weighted_count =</span> <span class="fu">sum</span>(wt, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb119-6"><a href="#cb119-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">.groups =</span> <span class="st">"drop"</span></span>
<span id="cb119-7"><a href="#cb119-7" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb119-8"><a href="#cb119-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">percentage =</span> <span class="fu">round</span>(weighted_count <span class="sc">/</span> <span class="fu">sum</span>(weighted_count) <span class="sc">*</span> <span class="dv">100</span>, <span class="dv">1</span>))</span>
<span id="cb119-9"><a href="#cb119-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb119-10"><a href="#cb119-10" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(switching_summary)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 4 × 5
  voted_left_2019 voted_right_2024 count weighted_count percentage
  &lt;lgl&gt;           &lt;lgl&gt;            &lt;int&gt;          &lt;dbl&gt;      &lt;dbl&gt;
1 FALSE           FALSE            10807         10614.       32.6
2 FALSE           TRUE              9398         10175.       31.2
3 TRUE            FALSE            11471         10912.       33.5
4 TRUE            TRUE               945           902.        2.8</code></pre>
</div>
<div class="sourceCode cell-code" id="cb121"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb121-1"><a href="#cb121-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Focus on left-to-right switchers</span></span>
<span id="cb121-2"><a href="#cb121-2" aria-hidden="true" tabindex="-1"></a>left_to_right_switchers <span class="ot">&lt;-</span> vote_switchers <span class="sc">%&gt;%</span></span>
<span id="cb121-3"><a href="#cb121-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(left_to_right_switch <span class="sc">==</span> <span class="cn">TRUE</span>)</span>
<span id="cb121-4"><a href="#cb121-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb121-5"><a href="#cb121-5" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">Total left-to-right switchers:"</span>, <span class="fu">nrow</span>(left_to_right_switchers))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Total left-to-right switchers: 945</code></pre>
</div>
<div class="sourceCode cell-code" id="cb123"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb123-1"><a href="#cb123-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">Weighted count:"</span>, <span class="fu">round</span>(<span class="fu">sum</span>(left_to_right_switchers<span class="sc">$</span>wt, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Weighted count: 902</code></pre>
</div>
<div class="sourceCode cell-code" id="cb125"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb125-1"><a href="#cb125-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Demographics of left-to-right switchers vs non-switchers</span></span>
<span id="cb125-2"><a href="#cb125-2" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">=== DEMOGRAPHICS OF LEFT-TO-RIGHT SWITCHERS ===</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
=== DEMOGRAPHICS OF LEFT-TO-RIGHT SWITCHERS ===</code></pre>
</div>
<div class="sourceCode cell-code" id="cb127"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb127-1"><a href="#cb127-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Gender breakdown</span></span>
<span id="cb127-2"><a href="#cb127-2" aria-hidden="true" tabindex="-1"></a>gender_switching <span class="ot">&lt;-</span> vote_switchers <span class="sc">%&gt;%</span></span>
<span id="cb127-3"><a href="#cb127-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(gender, left_to_right_switch) <span class="sc">%&gt;%</span></span>
<span id="cb127-4"><a href="#cb127-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(</span>
<span id="cb127-5"><a href="#cb127-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">weighted_count =</span> <span class="fu">sum</span>(wt, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb127-6"><a href="#cb127-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">.groups =</span> <span class="st">"keep"</span></span>
<span id="cb127-7"><a href="#cb127-7" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb127-8"><a href="#cb127-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(gender) <span class="sc">%&gt;%</span></span>
<span id="cb127-9"><a href="#cb127-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb127-10"><a href="#cb127-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">total =</span> <span class="fu">sum</span>(weighted_count),</span>
<span id="cb127-11"><a href="#cb127-11" aria-hidden="true" tabindex="-1"></a>    <span class="at">switch_rate =</span> <span class="fu">round</span>(weighted_count[left_to_right_switch <span class="sc">==</span> <span class="cn">TRUE</span>] <span class="sc">/</span> total <span class="sc">*</span> <span class="dv">100</span>, <span class="dv">1</span>)</span>
<span id="cb127-12"><a href="#cb127-12" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb127-13"><a href="#cb127-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(left_to_right_switch <span class="sc">==</span> <span class="cn">TRUE</span>) <span class="sc">%&gt;%</span></span>
<span id="cb127-14"><a href="#cb127-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(gender, switch_rate)</span>
<span id="cb127-15"><a href="#cb127-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb127-16"><a href="#cb127-16" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="st">"Left-to-right switching rates by gender:"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Left-to-right switching rates by gender:"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb129"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb129-1"><a href="#cb129-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(gender_switching)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 2 × 2
# Groups:   gender [2]
  gender switch_rate
  &lt;chr&gt;        &lt;dbl&gt;
1 female         3  
2 male           2.6</code></pre>
</div>
<div class="sourceCode cell-code" id="cb131"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb131-1"><a href="#cb131-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Age breakdown</span></span>
<span id="cb131-2"><a href="#cb131-2" aria-hidden="true" tabindex="-1"></a>age_switching <span class="ot">&lt;-</span> vote_switchers <span class="sc">%&gt;%</span></span>
<span id="cb131-3"><a href="#cb131-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(age, left_to_right_switch) <span class="sc">%&gt;%</span></span>
<span id="cb131-4"><a href="#cb131-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(</span>
<span id="cb131-5"><a href="#cb131-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">weighted_count =</span> <span class="fu">sum</span>(wt, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb131-6"><a href="#cb131-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">.groups =</span> <span class="st">"keep"</span></span>
<span id="cb131-7"><a href="#cb131-7" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb131-8"><a href="#cb131-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(age) <span class="sc">%&gt;%</span></span>
<span id="cb131-9"><a href="#cb131-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb131-10"><a href="#cb131-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">total =</span> <span class="fu">sum</span>(weighted_count),</span>
<span id="cb131-11"><a href="#cb131-11" aria-hidden="true" tabindex="-1"></a>    <span class="at">switch_rate =</span> <span class="fu">round</span>(weighted_count[left_to_right_switch <span class="sc">==</span> <span class="cn">TRUE</span>] <span class="sc">/</span> total <span class="sc">*</span> <span class="dv">100</span>, <span class="dv">1</span>)</span>
<span id="cb131-12"><a href="#cb131-12" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb131-13"><a href="#cb131-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(left_to_right_switch <span class="sc">==</span> <span class="cn">TRUE</span>) <span class="sc">%&gt;%</span></span>
<span id="cb131-14"><a href="#cb131-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(age, switch_rate) <span class="sc">%&gt;%</span></span>
<span id="cb131-15"><a href="#cb131-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(switch_rate))</span>
<span id="cb131-16"><a href="#cb131-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb131-17"><a href="#cb131-17" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">Left-to-right switching rates by age:"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "\nLeft-to-right switching rates by age:"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb133"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb133-1"><a href="#cb133-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(age_switching)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 7 × 2
# Groups:   age [7]
  age      switch_rate
  &lt;chr&gt;          &lt;dbl&gt;
1 25_TO_34         3.9
2 35_TO_44         3.4
3 45_TO_54         2.7
4 55_TO_64         2.6
5 18_TO_24         2.3
6 65_TO_74         1.9
7 75_PLUS          1.9</code></pre>
</div>
<div class="sourceCode cell-code" id="cb135"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb135-1"><a href="#cb135-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Education breakdown</span></span>
<span id="cb135-2"><a href="#cb135-2" aria-hidden="true" tabindex="-1"></a>education_switching <span class="ot">&lt;-</span> vote_switchers <span class="sc">%&gt;%</span></span>
<span id="cb135-3"><a href="#cb135-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(education)) <span class="sc">%&gt;%</span></span>
<span id="cb135-4"><a href="#cb135-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(education, left_to_right_switch) <span class="sc">%&gt;%</span></span>
<span id="cb135-5"><a href="#cb135-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(</span>
<span id="cb135-6"><a href="#cb135-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">weighted_count =</span> <span class="fu">sum</span>(wt, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb135-7"><a href="#cb135-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">.groups =</span> <span class="st">"keep"</span></span>
<span id="cb135-8"><a href="#cb135-8" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb135-9"><a href="#cb135-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(education) <span class="sc">%&gt;%</span></span>
<span id="cb135-10"><a href="#cb135-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb135-11"><a href="#cb135-11" aria-hidden="true" tabindex="-1"></a>    <span class="at">total =</span> <span class="fu">sum</span>(weighted_count),</span>
<span id="cb135-12"><a href="#cb135-12" aria-hidden="true" tabindex="-1"></a>    <span class="at">switch_rate =</span> <span class="fu">round</span>(weighted_count[left_to_right_switch <span class="sc">==</span> <span class="cn">TRUE</span>] <span class="sc">/</span> total <span class="sc">*</span> <span class="dv">100</span>, <span class="dv">1</span>)</span>
<span id="cb135-13"><a href="#cb135-13" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb135-14"><a href="#cb135-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(left_to_right_switch <span class="sc">==</span> <span class="cn">TRUE</span>) <span class="sc">%&gt;%</span></span>
<span id="cb135-15"><a href="#cb135-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(education, switch_rate)</span>
<span id="cb135-16"><a href="#cb135-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-17"><a href="#cb135-17" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">Left-to-right switching rates by education:"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "\nLeft-to-right switching rates by education:"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb137"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb137-1"><a href="#cb137-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(education_switching)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 2 × 2
# Groups:   education [2]
  education switch_rate
  &lt;chr&gt;           &lt;dbl&gt;
1 high              2.9
2 low               2.7</code></pre>
</div>
<div class="sourceCode cell-code" id="cb139"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb139-1"><a href="#cb139-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Predictive model for left-to-right switching</span></span>
<span id="cb139-2"><a href="#cb139-2" aria-hidden="true" tabindex="-1"></a>switching_model <span class="ot">&lt;-</span> vote_switchers <span class="sc">%&gt;%</span></span>
<span id="cb139-3"><a href="#cb139-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(gender) <span class="sc">&amp;</span> <span class="sc">!</span><span class="fu">is.na</span>(age) <span class="sc">&amp;</span> <span class="sc">!</span><span class="fu">is.na</span>(education) <span class="sc">&amp;</span> <span class="sc">!</span><span class="fu">is.na</span>(ethnicity))</span>
<span id="cb139-4"><a href="#cb139-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-5"><a href="#cb139-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Create survey design for switching analysis</span></span>
<span id="cb139-6"><a href="#cb139-6" aria-hidden="true" tabindex="-1"></a>survey_design_switching <span class="ot">&lt;-</span> <span class="fu">svydesign</span>(</span>
<span id="cb139-7"><a href="#cb139-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">ids =</span> <span class="sc">~</span><span class="dv">1</span>,</span>
<span id="cb139-8"><a href="#cb139-8" aria-hidden="true" tabindex="-1"></a>  <span class="at">weights =</span> <span class="sc">~</span>wt,</span>
<span id="cb139-9"><a href="#cb139-9" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> switching_model</span>
<span id="cb139-10"><a href="#cb139-10" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb139-11"><a href="#cb139-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-12"><a href="#cb139-12" aria-hidden="true" tabindex="-1"></a><span class="co"># Logistic regression predicting left-to-right switching</span></span>
<span id="cb139-13"><a href="#cb139-13" aria-hidden="true" tabindex="-1"></a>switch_prediction_model <span class="ot">&lt;-</span> <span class="fu">svyglm</span>(</span>
<span id="cb139-14"><a href="#cb139-14" aria-hidden="true" tabindex="-1"></a>  left_to_right_switch <span class="sc">~</span> gender <span class="sc">+</span> age <span class="sc">+</span> education <span class="sc">+</span> ethnicity <span class="sc">+</span> region <span class="sc">+</span> religion,</span>
<span id="cb139-15"><a href="#cb139-15" aria-hidden="true" tabindex="-1"></a>  <span class="at">design =</span> survey_design_switching,</span>
<span id="cb139-16"><a href="#cb139-16" aria-hidden="true" tabindex="-1"></a>  <span class="at">family =</span> <span class="fu">binomial</span>(<span class="at">link =</span> <span class="st">"logit"</span>)</span>
<span id="cb139-17"><a href="#cb139-17" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb139-18"><a href="#cb139-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-19"><a href="#cb139-19" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(switch_prediction_model)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
svyglm(formula = left_to_right_switch ~ gender + age + education + 
    ethnicity + region + religion, design = survey_design_switching, 
    family = binomial(link = "logit"))

Survey design:
svydesign(ids = ~1, weights = ~wt, data = switching_model)

Coefficients:
                                 Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)                    -3.6808392  0.2296763 -16.026  &lt; 2e-16 ***
gendermale                     -0.1276868  0.0714782  -1.786  0.07405 .  
age25_TO_34                     0.5663337  0.1358391   4.169 3.07e-05 ***
age35_TO_44                     0.3980190  0.1388837   2.866  0.00416 ** 
age45_TO_54                     0.1529911  0.1430547   1.069  0.28487    
age55_TO_64                     0.0912612  0.1514574   0.603  0.54681    
age65_TO_74                    -0.2588301  0.1683407  -1.538  0.12417    
age75_PLUS                     -0.2424838  0.2270502  -1.068  0.28554    
educationlow                    0.0428525  0.0766598   0.559  0.57617    
ethnicityblack                  0.1025913  0.2076960   0.494  0.62135    
ethnicitymixed                 -0.0445268  0.2848664  -0.156  0.87579    
ethnicityother                 -0.1853341  0.4768358  -0.389  0.69752    
ethnicitywhite                  0.2330354  0.1675976   1.390  0.16440    
regionEast of England          -0.2284415  0.1716611  -1.331  0.18327    
regionGreater London           -0.0683850  0.1610602  -0.425  0.67114    
regionNorth East England        0.2646894  0.1876501   1.411  0.15839    
regionNorth West England        0.0382158  0.1575229   0.243  0.80831    
regionScotland                 -0.9757820  0.2293813  -4.254 2.11e-05 ***
regionSouth East England       -0.0694364  0.1589390  -0.437  0.66221    
regionSouth West England       -0.1886468  0.1789568  -1.054  0.29182    
regionWales                    -0.0004441  0.2028733  -0.002  0.99825    
regionWest Midlands            -0.1027675  0.1745336  -0.589  0.55599    
regionYorkshire and the Humber  0.0198487  0.1671502   0.119  0.90548    
religionhindu                   0.3108000  0.2682325   1.159  0.24659    
religionmuslim                  0.1235188  0.1819502   0.679  0.49723    
religionnone                   -0.3371932  0.0792689  -4.254 2.11e-05 ***
religionother                  -0.1527443  0.1914068  -0.798  0.42487    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

(Dispersion parameter for binomial family taken to be 0.9978669)

Number of Fisher Scoring iterations: 7</code></pre>
</div>
<div class="sourceCode cell-code" id="cb141"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb141-1"><a href="#cb141-1" aria-hidden="true" tabindex="-1"></a><span class="fu">nobs</span>(switch_prediction_model)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 32133</code></pre>
</div>
</div>
<p>Being aged 25 to 34 is positively associated with switching from left to right in terms of party vote.</p>
<p><strong>Further steps</strong></p>
<p>Need to narrow down an effective methodology for examining segmented trends within the survey model approach.</p>
<ul>
<li><p>Religious intersectionality: gender gaps within Christian/Muslim/secular young people</p></li>
<li><p>Ethnic polarization matrix: white vs minority young men/women patterns<br>
</p></li>
<li><p>Education-class intersections: degree vs non-degree effects on gender gaps</p></li>
<li><p>Geographic mapping: urban/rural and constituency-level polarization hotspots</p></li>
<li><p>Polarization intensity metrics: identify most extreme vs moderate young segments</p></li>
<li><p>Attitude clustering: natural groupings and messaging archetypes for corporate strategy</p></li>
<li><p>“Movement” analysis: who is shifting away from older generational patterns most</p></li>
<li><p>Issue-specific drivers: which attitudes (social vs economic) drive overall polarization</p></li>
<li><p>Specifically, who is becoming more right-wing? Are there any predictors of actual shifts</p></li>
</ul>
<p>Currently thinking to create a polarization index, which measures how far someone is from the mean on both social and economic dimensions. Then we can see who is most polarized, and what predicts this.</p>
</section>
</section>
</section>

</main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->




</body></html>